import{k as v,$ as k,r as A,I as B,j as s,u as F}from"./index-D3NpIeTA.js";import{L as q}from"./Logo-DaobmfTV.js";import{u as T,A as L,a as R}from"./useTimeOutMessage-7x03d_f1.js";import{z as m,u as _,F as E,a as f,C as g,I as x,t as M}from"./index-BWvbDxgc.js";import{B as z}from"./StatusIcon-BgZfNZIn.js";import"./proxy-DcPOjHDb.js";import"./isNil-7fhU1Q44.js";const O=m.object({email:m.string({required_error:"Please enter your email"}),password:m.string({required_error:"Password Required"}),confirmPassword:m.string({required_error:"Confirm Password Required"})}).refine(a=>a.password===a.confirmPassword,{message:"Password not match",path:["confirmPassword"]}),W=a=>{var w,S,b;const{disableSubmit:l=!1,className:i,setMessage:r}=a,d=v(e=>e.setUser),c=v(e=>e.setSessionSignedIn),{token:D,setToken:U}=k(),[h,j]=A.useState(!1),{signUp:C,signIn:N}=B(),{handleSubmit:y,formState:{errors:o},control:u}=_({resolver:M(O)}),I=async e=>{const{userName:G,password:P,email:t}=e;if(!l){j(!0);const n=await C({username:t,password:P,email:""});if((n==null?void 0:n.status)==="failed")r==null||r(n.message);else{c(!1),U("");const p=await N({username:t,password:P});(p==null?void 0:p.status)==="failed"?r==null||r(n.message):d({email:t,userName:t.split("@")[0]})}j(!1)}};return s.jsx("div",{className:i,children:s.jsxs(E,{onSubmit:y(I),children:[s.jsx(f,{label:"Username",invalid:!!o.email,errorMessage:(w=o.email)==null?void 0:w.message,children:s.jsx(g,{name:"email",control:u,render:({field:e})=>s.jsx(x,{type:"text",placeholder:"Username",autoComplete:"off",...e})})}),s.jsx(f,{label:"Password",invalid:!!o.password,errorMessage:(S=o.password)==null?void 0:S.message,children:s.jsx(g,{name:"password",control:u,render:({field:e})=>s.jsx(x,{type:"password",autoComplete:"off",placeholder:"Password",...e})})}),s.jsx(f,{label:"Confirm Password",invalid:!!o.confirmPassword,errorMessage:(b=o.confirmPassword)==null?void 0:b.message,children:s.jsx(g,{name:"confirmPassword",control:u,render:({field:e})=>s.jsx(x,{type:"password",autoComplete:"off",placeholder:"Confirm Password",...e})})}),s.jsx(z,{block:!0,loading:h,variant:"solid",type:"submit",children:h?"Creating Account...":"Sign Up"})]})})},$=({signInUrl:a="/sign-in",disableSubmit:l})=>{const[i,r]=T(),d=F(c=>c.mode);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-8",children:s.jsx(q,{type:"streamline",mode:d,imgClass:"mx-auto",logoWidth:60})}),s.jsx("div",{className:"mb-8",children:s.jsx("h3",{className:"mb-1",children:"Sign Up"})}),i&&s.jsx(L,{showIcon:!0,className:"mb-4",type:"danger",children:s.jsx("span",{className:"break-all",children:i})}),s.jsx(W,{disableSubmit:l,setMessage:r}),s.jsx("div",{children:s.jsxs("div",{className:"mt-6 text-center",children:[s.jsx("span",{children:"Already have an account? "}),s.jsx(R,{to:a,className:"heading-text font-bold",themeColor:!1,children:"Sign in"})]})})]})},Z=()=>s.jsx($,{});export{$ as SignUpBase,Z as default};
