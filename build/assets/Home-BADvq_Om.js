import{r as l,j as c,A as x}from"./index-DBN3QcKN.js";import{M as y}from"./index.esm-BC1tgKme.js";import"./TextField-Uom1mB9H.js";import"./DefaultPropsProvider-BYvBoFms.js";import"./FormControlLabel-DV6vepEj.js";import"./Autocomplete-ByMvhzgZ.js";import"./Divider-DOT3Eu3x.js";import"./index-BBzbkzwZ.js";const T=(g,d="",s={},i=[])=>{for(const[h,a]of Object.entries(g||{})){const D=d?`${d}.${h}`:h;i.some(m=>D.startsWith(m))||a&&typeof a=="object"&&!Array.isArray(a)||(s[D]=a??"N/A")}return s},I=g=>g.map(d=>{const s=T(d);return Object.keys(s).forEach(i=>{(s[i]===void 0||s[i]===null)&&(s[i]="N/A")}),s}),k=()=>{const[g,d]=l.useState([]),[s,i]=l.useState([]),[h,a]=l.useState([]),[D,m]=l.useState(0),[f,L]=l.useState(null),[b,R]=l.useState({});console.log(f);const O=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],j={APPLICANT:"Applicant",LSO:"LSO",LSM:"LSM",DO:"DO",LSM2:"LSM",TL:"TL",DEO:"DEO","Download License":"Download License"},A=(t,p,n)=>{const C=["first_name","last_name","cnic","mobile_no","application_status","tracking_number","assigned_group","registration_for"],u=I(t),S=u[0],o=[...Object.keys(S).filter(e=>C.includes(e)).map(e=>({accessorKey:e,header:e.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()),size:200,Cell:({cell:r,row:_})=>c.jsx("span",{style:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>{const w=_.original.id;console.log(`Clicked ${e}:`,r.getValue()),console.log(`Navigating with ID: ${w}`),window.location.href=p?`/spuid-review/${w}?group=${n}`:`/spuid-signup/${w}`},children:r.getValue()||"-"})}))];return{flattenedData:u,columns:o}};return l.useEffect(()=>{(async()=>{try{let n=[];try{n=(await x.get("/pmc/user-groups/",{headers:{"Content-Type":"application/json"}})).data||[],a(n.map(e=>e.name))}catch(o){console.error("Error fetching user groups:",o),a([])}console.log("groupsResponse",n);const u=(await x.get("/pmc/applicant-detail/",{headers:{"Content-Type":"multipart/form-data"}})).data;if(Array.isArray(u)&&u.length>0){const o=A(u,n.length>0,n.map(r=>r.name)[0]);d(o.flattenedData),i(o.columns),console.log("Flattened Data:",o.flattenedData);const e=o.flattenedData[o.flattenedData.length-1];if(console.log("Last Row:",e),e&&e.id){L(e.id),console.log("Last Row ID:",e.id);const r=O.indexOf(e.assigned_group);r!==-1&&m(r)}}const S=await x.get("/pmc/fetch-statistics-view-groups/",{headers:{"Content-Type":"multipart/form-data"}});R(S.data)}catch(n){console.error("Error fetching data:",n)}})(),L(25);const p=O.indexOf("LSO");p!==-1&&m(p)},[]),console.log("selectedRowId:",f),console.log(f),c.jsxs("div",{children:[c.jsx("div",{className:"tiles-container",children:Object.entries(b).map(([t,p])=>c.jsxs("div",{className:"tile",children:[c.jsx("h3",{children:j[t]||t})," ",c.jsx("p",{children:p})]},t))}),c.jsx(y,{columns:[...s],data:g.map(t=>({...t,assigned_group_title:j[t.assigned_group]||t.assigned_group})),getRowId:t=>t.id,initialState:{showColumnFilters:!1},defaultColumn:{maxSize:420,minSize:1,size:100},enableColumnResizing:!0,columnResizeMode:"onChange",enableTopToolbar:!1,enablePagination:!1},f)]})};export{k as default};
