import{l as U,a0 as F,r as q,J as E,Y as L,a1 as R,j as e,u as T}from"./index-CNftHr0m.js";import{L as _}from"./Logo-Bf3gzZVI.js";import{u as $,A as z,a as J}from"./useTimeOutMessage-Da-ncY2y.js";import{z as m,u as O,F as W,a as f,C as h,I as g,t as Y}from"./index-DMEbKR8s.js";import{B as G}from"./StatusIcon-BEVP_ynY.js";import"./proxy-B5Lr0KnW.js";import"./isNil-DzdXYp1G.js";const H=m.object({email:m.string({required_error:"Please enter your email"}),password:m.string({required_error:"Password Required"}),confirmPassword:m.string({required_error:"Confirm Password Required"})}).refine(n=>n.password===n.confirmPassword,{message:"Password not match",path:["confirmPassword"]}),K=n=>{var j,S,b;const{disableSubmit:c=!1,className:t,setMessage:s}=n,d=U(a=>a.setUser),u=U(a=>a.setSessionSignedIn),{token:V,setToken:v}=F(),[x,w]=q.useState(!1),{signUp:y,signIn:C}=E(),{handleSubmit:N,formState:{errors:i},control:p}=O({resolver:Y(H)}),k=L(),A=R(),I=new URLSearchParams(A.search).get("redirectUrl")||"/",B=async a=>{const{username:Z,password:P,email:l}=a;if(!c){w(!0);try{const o=await y({username:l,password:P,email:""});if((o==null?void 0:o.status)==="failed")throw new Error(o.message);{u(!1),v("");const r=await C({username:l,password:P});if((r==null?void 0:r.status)==="failed")throw new Error(r.message);d({email:l,userName:l.split("@")[0]}),k(I)}}catch(o){if(console.log("its in error",o.response),s==null||s("test"),o.response){const r=o.response.data;console.log(r),r!=null&&r.username?s==null||s(`Username: ${r.username[0]}`):r!=null&&r.email?s==null||s(`Email: ${r.email[0]}`):s==null||s("An unknown error occurred.")}else s==null||s(o.message||"An unknown error occurred.")}finally{w(!1)}}};return e.jsx("div",{className:t,children:e.jsxs(W,{onSubmit:N(B),children:[e.jsx(f,{label:"Username",invalid:!!i.email,errorMessage:(j=i.email)==null?void 0:j.message,children:e.jsx(h,{name:"email",control:p,render:({field:a})=>e.jsx(g,{type:"text",placeholder:"Username",autoComplete:"off",...a})})}),e.jsx(f,{label:"Password",invalid:!!i.password,errorMessage:(S=i.password)==null?void 0:S.message,children:e.jsx(h,{name:"password",control:p,render:({field:a})=>e.jsx(g,{type:"password",autoComplete:"off",placeholder:"Password",...a})})}),e.jsx(f,{label:"Confirm Password",invalid:!!i.confirmPassword,errorMessage:(b=i.confirmPassword)==null?void 0:b.message,children:e.jsx(h,{name:"confirmPassword",control:p,render:({field:a})=>e.jsx(g,{type:"password",autoComplete:"off",placeholder:"Confirm Password",...a})})}),e.jsx(G,{block:!0,loading:x,variant:"solid",type:"submit",children:x?"Creating Account...":"Sign Up"})]})})},Q=({signInUrl:n="/sign-in",disableSubmit:c})=>{const[t,s]=$(),d=T(u=>u.mode);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-8",children:e.jsx(_,{type:"streamline",mode:d,imgClass:"mx-auto",logoWidth:60})}),e.jsx("div",{className:"mb-8",children:e.jsx("h3",{className:"mb-1",children:"Sign Up"})}),t&&e.jsx(z,{showIcon:!0,className:"mb-4",type:"danger",children:e.jsx("span",{className:"break-all",children:t})}),e.jsx(K,{disableSubmit:c,setMessage:s}),e.jsx("div",{children:e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("span",{children:"Already have an account? "}),e.jsx(J,{to:n,className:"heading-text font-bold",themeColor:!1,children:"Sign in"})]})})]})},ne=()=>e.jsx(Q,{});export{Q as SignUpBase,ne as default};
