import{j as e,Z as p,d as w,r,A as j}from"./index-M3U5v6x4.js";import{M as V,V as A,T as G,O as R,a as y,b as g,S as I,e as B,F as N,c as C}from"./OSM-Bx5l-N5p.js";import{D as O}from"./Divider-CWaVbmxL.js";import{G as $}from"./GeoJSON-BAwyf57_.js";import{M as H}from"./index.esm-C3vdWKEO.js";import{m as v,h as K,n as Z,o as q,p as J}from"./index-CtXy-Mvh.js";import"./DefaultPropsProvider-BjxZ8lZb.js";import"./TextField-Cbv3hlmy.js";import"./Autocomplete-Bb7Yk1lF.js";import"./FormControlLabel-BmgWZEN5.js";import"./index-CrKJxecL.js";const U=({headerText:i=e.jsx(e.Fragment,{}),children:o})=>e.jsxs("div",{className:"banner-container22 grid",children:[e.jsxs("header",{className:"banner-header",children:[e.jsx(w,{to:"/pub",className:"transition-all duration-300 ease-in-out transform hover:scale-105",children:e.jsxs("div",{className:"logo-section",children:[e.jsx("img",{src:"/img/logo/epa_logo-removebg-preview.png",alt:"GOP Logo",className:"header-logo"}),e.jsx("img",{src:"/img/logo/epccd.png",alt:"EPCCD Logo",className:"header-logo"}),e.jsx("img",{src:"/img/logo/gop.png",alt:"GOP Logo",className:"header-logo"}),e.jsx("span",{className:"header-text",children:"PMIS"})]})}),i,e.jsx("nav",{className:"banner-nav",children:e.jsx(w,{to:"/sign-in",className:"nav-link transition-all duration-300 ease-in-out transform hover:scale-105",style:{paddingLeft:300},children:"Login"})})]}),p.Children.map(o,d=>p.isValidElement(d)?p.cloneElement(d):d),e.jsx(O,{textAlign:"left"}),e.jsx("footer",{className:"footer-container",children:e.jsxs("span",{className:"footer-text",children:["Copyright © ",new Date().getFullYear()," ",e.jsx("span",{className:"font-semibold",children:"PMIS"})," All rights reserved.",e.jsx("br",{}),"Plastic Management Cell, Strategic Planning & Implementation Unit, Environmental Protection Agency, and Environment Protection & Climate Change Department, Government of the Punjab."]})})]}),W=()=>{const i=r.useRef(null),[o,d]=r.useState(null),[n,S]=r.useState(null),[Y,k]=r.useState(null),[u,L]=r.useState([]),[l,m]=r.useState(null),[M,x]=r.useState(!1),[h,D]=r.useState([]),[P,E]=r.useState(!0);r.useEffect(()=>{const t=new V({target:i.current,layers:[new G({source:new R})],view:new A({zoom:7,center:[8127130,3658593]})}),s=new y({source:new g}),a=new y({source:new g});return t.addLayer(s),t.addLayer(a),S(s),k(a),d(t),()=>t.setTarget(null)},[]),r.useEffect(()=>{if(!n||!o)return;(async()=>{x(!0);try{const s=await j.get("/pmc/idm_districts-club-counts/");D(s.data.features);const a=new g({features:new $().readFeatures(s.data,{featureProjection:"EPSG:3857"})});n.setSource(a),o.getView().fit(a.getExtent(),{padding:[50,50,50,50],duration:500})}catch(s){console.error("Error fetching districts:",s)}finally{x(!1)}})()},[n,o]),r.useEffect(()=>{n&&n.setStyle(t=>{const s=t.get("id")===l;if(t.get("club_count")!==0)return new I({stroke:new C({color:s?"red":"blue",width:s?3:2}),fill:new N({color:s?"rgba(255,0,0,0.1)":"rgba(0,0,255,0.1)"}),text:new B({text:`${t.get("name")} (${t.get("club_count")})`,font:"bold 10px sans-serif",fill:new N({color:"#000"}),stroke:new C({color:"#fff",width:3}),overflow:!0})})})},[n,l]),r.useEffect(()=>{(async()=>{const s=await j.get("/pmc/idm_clubs_geojson_all/");L(s.data.features)})()},[]),r.useEffect(()=>{if(!o||!n)return;const t=s=>{const a=o.getFeaturesAtPixel(s.pixel);if(a.length>0){const b=a[0].get("id");l===b?(m(null),o.getView().setCenter([8127130,3658593])):m(b)}else m(null),o.getView().setCenter([8127130,3658593])};return o.on("click",t),()=>o.un("click",t)},[o,n,l]);const T=r.useMemo(()=>l?u.filter(t=>t.properties.district_id===l):u,[l,u]),_=r.useMemo(()=>[{accessorKey:"properties.district",header:"District",size:150},{accessorKey:"properties.name",header:"School Name",size:225},{accessorKey:"properties.address",header:"Address",size:225},{accessorKey:"properties.head_name",header:"Head Name",size:200},{header:"Map",size:50,Cell:({row:t})=>{const{name:s,district:a}=t.original.properties,c=z(s,a);return e.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",title:"Open in Google Maps",className:"text-blue-500 hover:text-blue-700",children:e.jsx(v,{size:20})})}}],[]),F=r.useMemo(()=>{const t=[...h].sort((s,a)=>a.properties.club_count-s.properties.club_count).slice(0,4);return[{properties:{name:"Total Clubs",club_count:u.length,id:null}},...t]},[h,u]),f=[{bgColor:"bg-gray-500",icon:e.jsx(K,{className:"text-white text-3xl"})},{bgColor:"bg-orange-500",icon:e.jsx(Z,{className:"text-white text-3xl"})},{bgColor:"bg-blue-500",icon:e.jsx(q,{className:"text-white text-3xl"})},{bgColor:"bg-yellow-500",icon:e.jsx(v,{className:"text-white text-3xl"})},{bgColor:"bg-green-500",icon:e.jsx(J,{className:"text-white text-3xl"})}],z=(t,s)=>{const a=c=>(c==null?void 0:c.replace(/\d+/g,"").replace(/\s+/g,"+"))||"";return`https://www.google.com/maps/search/?api=1&query=${a(t)}+${a(s)}`};return e.jsxs("div",{className:"flex flex-col p-4 gap-4",children:[P&&e.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded relative",children:[e.jsx("p",{className:"font-medium",children:"To access Head Contact Number and Club Notification, please sign in with an authenticated account."}),e.jsx("button",{className:"absolute top-2 right-2 text-yellow-700 hover:text-yellow-900",onClick:()=>E(!1),children:"×"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:F.map((t,s)=>e.jsx("div",{className:`shadow-md rounded p-6 w-full cursor-pointer transition 
                ${l===null||l===t.properties.id?"opacity-100":"opacity-50"}
                ${f[s].bgColor}
                `,onClick:()=>m(t.properties.id),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[f[s].icon,e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.properties.name}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.properties.club_count})]})},s))}),e.jsxs("div",{className:"flex flex-col p-4 gap-4 md:flex-row",children:[e.jsxs("div",{className:"relative",children:[M&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-10",children:e.jsx("div",{className:"animate-spin h-10 w-10 border-4 border-blue-500 border-t-transparent rounded-full"})}),e.jsx("div",{ref:i,style:{height:"850px",width:"500px"}})]}),e.jsx("div",{style:{flex:1},children:e.jsx(H,{columns:_,data:T,initialState:{pagination:{pageSize:15}},enableZebraStripes:!0,enableColumnResizing:!0,muiTableBodyRowProps:({row:t})=>({onClick:()=>handleRowClick(t),style:{cursor:"pointer"},sx:{"&:nth-of-type(even)":{backgroundColor:"#f9f9f9"},"&:hover":{backgroundColor:"#e0f7fa"}}}),muiTableProps:{sx:{border:"1px solid #ddd"}},muiTableHeadCellProps:{sx:{backgroundColor:"#f5f5f5",fontWeight:"bold",borderBottom:"2px solid #ccc",textAlign:"center"}},muiTableBodyCellProps:{sx:{borderRight:"1px solid #ddd",padding:"10px"}}})})]})]})},ce=()=>{const i=e.jsxs("h6",{className:"header-text",children:[e.jsx("span",{className:"font-bold",children:"Management Information System"}),e.jsx("span",{className:"text-sm ml-2",children:"Educational Environmental Club Directory"})]});return e.jsx(U,{headerText:i,children:e.jsx(W,{})})};export{ce as default};
