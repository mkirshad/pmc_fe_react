import{r as v,j as e,ao as je,am as ye,W as ve,A as ae,a0 as Ce}from"./index-DR9ZUpVB.js";import{B as te}from"./StatusIcon-DECuBhVG.js";import{E as De,G as we,D as Se,N as Be}from"./toast-a8EISOFJ.js";import{u as pe,a as Ne,C as le}from"./index-Bc6yVsbX.js";import{u as ke,a as m,C as f,I as g}from"./index.esm-DvQLX336.js";import{T as $,F as de,C as ce}from"./FormControlLabel-DCb-qpT5.js";import{n as me,k as fe,o as ge,u as _e,c as he,j as xe}from"./DefaultPropsProvider-CAgRmbKs.js";import{P as Pe,Q as ue,U as Re}from"./TextField-BKM20GYp.js";import"./proxy-Cy4nSXvO.js";import"./index-NfHDDStc.js";function Me(r){return fe("MuiCard",r)}me("MuiCard",["root"]);const qe=r=>{const{classes:o}=r;return xe({root:["root"]},Me,o)},Ie=ge(Pe,{name:"MuiCard",slot:"Root",overridesResolver:(r,o)=>o.root})({overflow:"hidden"}),M=v.forwardRef(function(o,j){const n=_e({props:o,name:"MuiCard"}),{className:D,raised:h=!1,...d}=n,x={...n,raised:h},w=qe(x);return e.jsx(Ie,{className:he(w.root,D),elevation:h?8:void 0,ref:j,ownerState:x,...d})});function Te(r){return fe("MuiCardContent",r)}me("MuiCardContent",["root"]);const Ae=r=>{const{classes:o}=r;return xe({root:["root"]},Te,o)},Ee=ge("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(r,o)=>o.root})({padding:16,"&:last-child":{paddingBottom:24}}),q=v.forwardRef(function(o,j){const n=_e({props:o,name:"MuiCardContent"}),{className:D,component:h="div",...d}=n,x={...n,component:h},w=Ae(x);return e.jsx(Ee,{as:h,className:he(w.root,D),ownerState:x,ref:j,...d})}),Ge=({groupList:r,children:o})=>{var F,O,X;const[j,n]=v.useState(r!==void 0&&r.length>1?r[1].value:""),[D,h]=v.useState({previousStage:!1,nextStage:!1}),{applicantDetail:d,businessDetailIndividual:x,businessEntity:w,licenseDetail:S,licenseDetailProducer:G,licenseDetailConsumer:Y,licenseDetailCollector:J,licenseDetailRecycler:Q,updateApplicantDetail:A,completedSections:I}=pe(),{control:c,handleSubmit:re,formState:{errors:t}}=ke({defaultValues:{firstName:""}}),[V]=je(),u=V.get("group")!=="DO";v.useEffect(()=>{n(r!==void 0&&r.length>1?r[1].value:"")},[r]);const L=_=>{var N,k,P,R;const{name:s,checked:p}=_.target;if(h({previousStage:s==="previousStage"?p:!1,nextStage:s==="nextStage"?p:!1}),s==="previousStage"&&p){n((N=r[0])==null?void 0:N.value);const B={assignedGroup2:(k=r[0])==null?void 0:k.value};A(B)}else if(s==="nextStage"&&p){const B={assignedGroup2:(P=r[2])==null?void 0:P.value};A(B),n((R=r[2])==null?void 0:R.value)}},K=_=>{const s={remarks:_.target.value};A(s)},C=(_,s)=>e.jsx(M,{sx:{marginBottom:"20px"},children:e.jsxs(q,{children:[e.jsx($,{variant:"h6",sx:{fontWeight:"bold",marginBottom:"10px"},children:_}),Object.entries(s||{}).map(([p,y])=>y!==""&&p!=="applicationassignment"&&p!=="applicationdocument"?e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[e.jsxs("div",{style:{flex:"1",marginRight:"10px"},children:[e.jsxs("strong",{children:[p,":"]})," ",typeof y=="object"&&y!==null?JSON.stringify(y,null,2):y]}),e.jsxs("div",{style:{marginRight:"10px"},children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:`response-${p}`,value:"Yes",style:{marginRight:"5px"},disabled:u}),"Yes"]}),e.jsxs("label",{style:{marginLeft:"10px"},children:[e.jsx("input",{type:"radio",name:`response-${p}`,value:"No",style:{marginRight:"5px"},disabled:u}),"No"]})]}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Add comment",style:{width:"200px",padding:"5px",border:"1px solid #ccc",borderRadius:"4px"},readOnly:u})})]},p):null)]})}),z=_=>e.jsx(M,{sx:{marginBottom:"20px"},children:e.jsxs(q,{children:[e.jsx($,{variant:"h6",sx:{fontWeight:"bold",marginBottom:"10px"},children:"Documents"}),e.jsx("ul",{children:_.map(s=>e.jsx("li",{children:e.jsx("a",{href:s.document,target:"_blank",rel:"noopener noreferrer",children:s.document_description})},s.id))})]})}),H={backgroundColor:"#f0f8ff",border:"1px solid #007bff",padding:"10px",borderRadius:"4px",marginBottom:"15px"},se=()=>{var _,s,p,y,N,k,P,R,B,W,U,Z,ee;return e.jsx(M,{sx:H,children:e.jsxs(q,{children:[e.jsx($,{variant:"h6",sx:{color:"#007bff",marginBottom:"10px"},children:"Manual Fields"}),e.jsx(m,{label:"Latidue",invalid:!!t.annualProcurement,errorMessage:(_=t.annualProcurement)==null?void 0:_.message,children:e.jsx(f,{name:"annualProcurement",control:c,render:({field:i})=>e.jsx(g,{type:"text",placeholder:"Enter procurement",...i})})}),e.jsx(m,{label:"Longitude",invalid:!!t.annualProcurement,errorMessage:(s=t.annualProcurement)==null?void 0:s.message,children:e.jsx(f,{name:"annualProcurement",control:c,render:({field:i})=>e.jsx(g,{type:"text",placeholder:"Enter procurement",...i})})}),e.jsx(m,{label:"Annual Procurement (Kg per day)",invalid:!!t.annualProcurement,errorMessage:(p=t.annualProcurement)==null?void 0:p.message,children:e.jsx(f,{name:"annualProcurement",control:c,render:({field:i})=>e.jsx(g,{type:"text",placeholder:"Enter procurement",...i})})}),e.jsx(m,{label:"Whether there is availability of Segregation at Source",invalid:!!t.firstName,errorMessage:(y=t.firstName)==null?void 0:y.message,children:e.jsx(f,{name:"firstName",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"Whether there is availability of Segregation at Source",...i})})}),e.jsx(m,{label:"Flow Diagram",invalid:!!t.flowDiagram,errorMessage:(N=t.flowDiagram)==null?void 0:N.message,children:e.jsx(f,{name:"flowDiagram",control:c,render:({field:i})=>e.jsx(g,{type:"file",accept:".pdf,.png,.jpg",...i})})}),e.jsx(m,{label:"List of Products",invalid:!!t.flow_diagram,errorMessage:(k=t.flow_diagram)==null?void 0:k.message,children:e.jsx(f,{name:"flow_diagram",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"List of Products",...i})})}),e.jsx(m,{label:"List of By Products",invalid:!!t.flow_diagram,errorMessage:(P=t.flow_diagram)==null?void 0:P.message,children:e.jsx(f,{name:"flow_diagram",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"List of By Products",...i})})}),e.jsx(m,{label:"List and Quanity of Raw Material Imported",invalid:!!t.flow_diagram,errorMessage:(R=t.flow_diagram)==null?void 0:R.message,children:e.jsx(f,{name:"flow_diagram",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"List and Quanity of Raw Material Imported",...i})})}),e.jsx(m,{label:"Name of seller/Importer",invalid:!!t.flow_diagram,errorMessage:(B=t.flow_diagram)==null?void 0:B.message,children:e.jsx(f,{name:"flow_diagram",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"Name of seller/Importer",...i})})}),e.jsx(m,{label:"No. of workers (including  contract labour)",invalid:!!t.firstName,errorMessage:(W=t.firstName)==null?void 0:W.message,children:e.jsx(f,{name:"firstName",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"No. of workers (including  contract labour)",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...i})})}),e.jsx(m,{label:"Whether registerd with Labor Dept.? If Yes, provide details",invalid:!!t.firstName,errorMessage:(U=t.firstName)==null?void 0:U.message,children:e.jsx(f,{name:"firstName",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"Whether registerd with Labor Dept.? If Yes, provide details",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...i})})}),e.jsx(m,{label:`Occupational safety and health \r
aspects \r
(Please provide details of \r
facilities)`,invalid:!!t.firstName,errorMessage:(Z=t.firstName)==null?void 0:Z.message,children:e.jsx(f,{name:"firstName",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:"Occupational safety and health aspects (Please provide details of facilities)",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...i})})}),e.jsx(m,{label:`Whether conditions exist or are \r
likely to exist of the material \r
being handled or processed \r
 \r
posing adverse immediate or \r
delayed \r
impacts \r
on \r
the \r
environment. `,invalid:!!t.firstName,errorMessage:(ee=t.firstName)==null?void 0:ee.message,children:e.jsx(f,{name:"firstName",control:c,render:({field:i})=>e.jsx(g,{type:"text",autoComplete:"off",placeholder:`Whether conditions exist or are \r
likely to exist of the material \r
being handled or processed \r
 \r
posing adverse immediate or \r
delayed \r
impacts \r
on \r
the \r
environment. `,style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...i})})})]})})};return e.jsxs("div",{className:"p-4",style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx($,{variant:"h4",sx:{fontWeight:"bold",marginBottom:"20px"},children:"Review Information"}),I.includes("applicantDetail")&&C("Applicant Details",d),I.includes("businessEntity")&&C("Business Entity",w),I.includes("businessDetailIndividual")&&C("Business Details",x),I.includes("licenseDetail")&&C("License Details",S),S.licenseType==="Producer"&&C("Producer Details",G),S.licenseType==="Consumer"&&C("Consumer Details",Y),S.licenseType==="Collector"&&C("Collector Details",J),S.licenseType==="Recycler"&&C("Recycler Details",Q),((F=d==null?void 0:d.applicationdocument)==null?void 0:F.length)>0&&z(d.applicationdocument),se(),e.jsx(M,{sx:{marginBottom:"20px"},children:e.jsx(q,{children:e.jsx(ue,{fullWidth:!0,children:e.jsx(Re,{id:"Remarks",label:"Remarks",variant:"outlined",onChange:K})})})}),e.jsx(M,{children:e.jsx(q,{children:e.jsxs(ue,{children:[e.jsx(de,{control:e.jsx(ce,{name:"nextStage",checked:D.nextStage,onChange:L}),label:`Yes - Proceed to next stage (${(O=r[2])==null?void 0:O.label})`}),e.jsx(de,{control:e.jsx(ce,{name:"previousStage",checked:D.previousStage,onChange:L}),label:`No - Proceed to previous stage (${(X=r[0])==null?void 0:X.label})`})]})})})]}),e.jsx("div",{children:e.jsx(M,{children:e.jsx(q,{children:e.jsx("div",{children:d!=null&&d.applicationassignment?e.jsx("div",{children:e.jsx("div",{children:d.applicationassignment},"abc123")},"abc123"):null})})})}),e.jsx(M,{children:e.jsx(q,{children:o})}),e.jsx("div",{})]})},Ke=()=>{const{id:r}=ye(),o=ve(),[j,n]=v.useState(0),[D,h]=v.useState(!1),[d,x]=v.useState(!1),[w,S]=v.useState(!1),G=l=>{if(l===3){n(6);return}if(l===5){n(2);return}l<0?n(0):l>6?n(6):n(l)},Y=()=>G(j+1),J=()=>G(j-1);v.useEffect(()=>{console.log("its here1"),r?A(r):(K(),H(),O(),s())},[r]);const Q=l=>e.jsxs("div",{children:[e.jsx("h5",{children:"Application Assignments"}),l.map(a=>e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Assigned Group:"})," ",a.assigned_group]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Remarks:"})," ",a.remarks||"No remarks"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Updated Date/Time:"})," ",new Date(a.created_at).toLocaleString()]})]},a.id))]}),A=l=>{ae.get(`/pmc/applicant-detail/${l}/`,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{var E,ne;console.log("Data:",a.data);const T={firstName:a.data.first_name,lastName:a.data.last_name,applicantDesignation:a.data.applicant_designation,gender:a.data.gender,cnic:a.data.cnic,email:a.data.email,phoneNumber:a.data.mobile_no,id:a.data.id,has_identity_document:a.data.has_identity_document,has_fee_challan:a.data.has_fee_challan,applicationStatus:a.data.application_status,assignedGroup:a.data.assigned_group,applicationassignment:Q(a.data.applicationassignment),applicationdocument:a.data.applicationdocument};if(L(T),a.data.businessprofile){if(a.data.businessprofile.entity_type==="Company"){const b={applicant:a.data.id,businessName:a.data.businessprofile.business_name,district:a.data.businessprofile.district,tehsil:a.data.businessprofile.tehsil,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};z(b)}{const b={applicant:a.data.id,name:a.data.businessprofile.name,district:a.data.businessprofile.district,tehsil:a.data.businessprofile.tehsil,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};F(b)}_({businessEntityType:"Individual"})}if(P({licenseType:a.data.registration_for}),a.data.producer&&a.data.registration_for==="Producer"){const b={tracking_number:a.data.producer.tracking_number||"",registration_required_for:a.data.producer.registration_required_for||[],registration_required_for_other:a.data.producer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.producer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.producer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.producer.packaging_items||[],number_of_machines:a.data.producer.number_of_machines||"",total_capacity_value:((E=a.data.producer.total_capacity_value)==null?void 0:E.toString())||"",date_of_setting_up:a.data.producer.date_of_setting_up||"",total_waste_generated_value:((ne=a.data.producer.total_waste_generated_value)==null?void 0:ne.toString())||"",has_waste_storage_capacity:a.data.producer.has_waste_storage_capacity||"",waste_disposal_provision:a.data.producer.waste_disposal_provision||"",applicant:a.data.producer.applicant||""};W(b)}if(a.data.consumer&&a.data.registration_for==="Consumer"){const b={registration_required_for:a.data.consumer.registration_required_for||[],registration_required_for_other:a.data.consumer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.consumer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.consumer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.consumer.packaging_items||[],consumption:a.data.consumer.consumption||"",provision_waste_disposal_bins:a.data.consumer.provision_waste_disposal_bins||"No",no_of_waste_disposible_bins:a.data.consumer.no_of_waste_disposable_bins||"",segregated_plastics_handed_over_to_registered_recyclers:a.data.consumer.segregated_plastics_handed_over_to_registered_recyclers||"No",applicant:a.data.consumer.applicant||""};B(b)}if(a.data.recycler&&a.data.registration_for==="Recycler"){const b={selectedCategories:a.data.recycler.selected_categories||[],plastic_waste_acquired_through:a.data.recycler.plastic_waste_acquired_through||[],has_adequate_pollution_control_systems:a.data.recycler.has_adequate_pollution_control_systems||"No",pollution_control_details:a.data.recycler.pollution_control_details||"",applicant:a.data.recycler.applicant||"",registration_required_for_other_other_text:a.data.recycler.registration_required_for_other_other_text||""};U(b)}if(a.data.collector&&a.data.registration_for==="Collector"){const b={registration_required_for:a.data.collector.registration_required_for||[],registration_required_for_other:a.data.collector.registration_required_for_other||[],registration_required_for_other_other_text:a.data.collector.registration_required_for_other_other_text||"",selectedCategoriesCollector:a.data.collector.selected_categories||[],total_capacity_value_collector:a.data.collector.total_capacity_value||"",number_of_vehicles:a.data.collector.number_of_vehicles||"",number_of_persons:a.data.collector.number_of_persons||"",applicant:a.data.collector.applicant||""};R(b)}a.data.application_status==="Fee Challan"&&n(4)}).catch(a=>{console.error("Error:",a)})},I=()=>{h(!1),Se.push(e.jsx(Be,{type:"success",children:"Customer discard!"}),{placement:"top-center"}),o("/concepts/customers/customer-list")},c=()=>{h(!0)},re=()=>{x(!0)},t=()=>{h(!1),x(!1)},V=()=>{x(!1),J()},ie=async()=>{if(u.assignedGroup2!==""){const l=new FormData;if(l.append("assigned_group",u.assignedGroup2),l.append("id",u.id.toString()),u.id>0){try{const T=await ae.patch(`/pmc/applicant-detail/${u.id}/`,l,{headers:{"Content-Type":"multipart/form-data"}});S(!1),o("/home")}catch(T){console.error("Error in POST request:",T.response||T.message),S(!1)}Y()}const a=new FormData;a.append("applicant",u.id.toString()),a.append("assigned_group",u.assignedGroup2),a.append("remarks",u.remarks),console.log(u.remarks),await ae.post("/pmc/application-assignment/",a,{headers:{"Content-Type":"multipart/form-data"}})}},{applicantDetail:u,updateApplicantDetail:L,resetApplicantDetail:K,businessDetail:C,updateBusinessDetail:z,resetBusinessDetail:H,businessDetailIndividual:se,updateBusinessDetailIndividual:F,resetBusinessDetailIndividual:O,businessEntity:X,updateBusinessEntity:_,resetBusinessEntity:s,resetAll:p,completedSections:y,getValuesFromStateBusinessEntity:N,getValuesFromLicenseDetail:k,updateLicenseDetail:P,updateLicenseDetailCollector:R,updateLicenseDetailConsumer:B,updateLicenseDetailProducer:W,updateLicenseDetailRecycler:U,resetLicenseDetail:Z,resetLicenseDetailProducer:ee}=pe();N(),k();const i=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],oe=be(u.assignedGroup);console.log("assignedGroup:",u.assignedGroup),console.log("groupList",oe);function be(l){console.log(l);const a=i.indexOf(l);return i.slice(Math.max(0,a-1),a+2).map(E=>({value:E,label:E}))}return e.jsxs(e.Fragment,{children:[e.jsx(Ge,{groupList:oe,children:e.jsx(Ce,{children:e.jsxs("div",{className:"flex items-center justify-between px-8",children:[e.jsx("span",{}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error bg-transparent",icon:e.jsx(De,{}),onClick:c,children:"Discard"}),e.jsx(te,{icon:e.jsx(we,{}),className:"ltr:mr-3 rtl:ml-3",variant:"solid",type:"button",loading:w,disabled:j===0,onClick:re,children:"Back"}),e.jsx(te,{icon:e.jsx(Ne,{}),variant:"solid",type:"button",onClick:ie,loading:w,children:"Save"})]})]})})}),e.jsx(le,{isOpen:D,type:"danger",title:"Discard changes",onClose:t,onRequestClose:t,onCancel:t,onConfirm:I,children:e.jsx("p",{children:"Are you sure you want discard this?"})}),e.jsx(le,{isOpen:d,type:"danger",title:"Go Back",onClose:t,onRequestClose:t,onCancel:t,onConfirm:V,children:e.jsx("p",{children:"There are unsaved changes on this step, Are you sure you want to go back step?"})})]})};export{Ke as default};
