import{r as D,j as e,ap as ye,an as ve,X as je,A as te,a1 as Ce}from"./index-C4JzSw5_.js";import{B as re}from"./StatusIcon-Dqizvq0V.js";import{E as De,G as we,D as Ne,N as Se}from"./toast-BiwsXNgs.js";import{u as pe,a as Be,C as le}from"./index-CP4zh7WO.js";import{u as Pe,a as m,C as g,I as _}from"./index.esm-BEK9hgqS.js";import{T as $,F as de,C as ce}from"./FormControlLabel-xgN_LnSj.js";import{n as me,k as ge,o as _e,u as fe,c as he,j as xe}from"./DefaultPropsProvider-Dcv2prnH.js";import{P as ke,Q as ue,U as Re}from"./TextField-Co0x8mQG.js";import"./proxy-CZqXS5oS.js";import"./index-CMSQnVhG.js";function qe(r){return ge("MuiCard",r)}me("MuiCard",["root"]);const Te=r=>{const{classes:o}=r;return xe({root:["root"]},qe,o)},Me=_e(ke,{name:"MuiCard",slot:"Root",overridesResolver:(r,o)=>o.root})({overflow:"hidden"}),q=D.forwardRef(function(o,v){const n=fe({props:o,name:"MuiCard"}),{className:w,raised:h=!1,...c}=n,x={...n,raised:h},N=Te(x);return e.jsx(Me,{className:he(N.root,w),elevation:h?8:void 0,ref:v,ownerState:x,...c})});function Ae(r){return ge("MuiCardContent",r)}me("MuiCardContent",["root"]);const Ie=r=>{const{classes:o}=r;return xe({root:["root"]},Ae,o)},Ee=_e("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(r,o)=>o.root})({padding:16,"&:last-child":{paddingBottom:24}}),T=D.forwardRef(function(o,v){const n=fe({props:o,name:"MuiCardContent"}),{className:w,component:h="div",...c}=n,x={...n,component:h},N=Ie(x);return e.jsx(Ee,{as:h,className:he(N.root,w),ownerState:x,ref:v,...c})}),Ge=({groupList:r,children:o})=>{var F,Z,W;const[v,n]=D.useState(r!==void 0&&r.length>1?r[1].value:""),[w,h]=D.useState({previousStage:!1,nextStage:!1}),{applicantDetail:c,businessDetailIndividual:x,businessEntity:N,licenseDetail:j,licenseDetailProducer:L,licenseDetailConsumer:K,licenseDetailCollector:Y,licenseDetailRecycler:J,updateApplicantDetail:I,completedSections:M}=pe(),{control:u,handleSubmit:se,formState:{errors:t}}=Pe({defaultValues:{firstName:""}}),[Q]=ye(),p=Q.get("group")!=="DO";D.useEffect(()=>{n(r!==void 0&&r.length>1?r[1].value:"")},[r]);const O=f=>{var B,P,k,R;const{name:l,checked:i}=f.target;if(h({previousStage:l==="previousStage"?i:!1,nextStage:l==="nextStage"?i:!1}),l==="previousStage"&&i){n((B=r[0])==null?void 0:B.value);const S={assignedGroup2:(P=r[0])==null?void 0:P.value};I(S)}else if(l==="nextStage"&&i){const S={assignedGroup2:(k=r[2])==null?void 0:k.value};I(S),n((R=r[2])==null?void 0:R.value)}},V=f=>{const l={remarks:f.target.value};I(l)},H={firstName:"First Name",lastName:"Last Name",applicantDesignation:"Designation",gender:"Gender",cnic:"CNIC",email:"Email",phoneNumber:"Mobile Number",trackingNumber:"Tracking Number",businessEntityType:"Business Entity Type",name:"Business Name",district:"District",tehsil:"Tehsil",city:"City",postalAddress:"Postal Address",registration_required_for:"Categories of Single Use Plastics",registration_required_for_other:"Categories for Other Plastics",registration_required_for_other_other_text:"Other",plain_plastic_Sheets_for_food_wrapping:"Additional Options for Packaging",PackagingItems:"Packging Item Other List",number_of_machines:"Number of machines",total_capacity_value:"Average Production Capacity (Kg per day)",date_of_setting_up:"Date of Business Setting Up",total_waste_generated_value:"Averrage Waste Generated (Kg per day)",has_waste_storage_capacity:"Has Waste Storage Capacity?",waste_disposal_provision:"Waste Disposal Provision",consumption:"Average Sale (Kg per day)",provision_waste_disposal_bins:"Provision of Waste Disposal Bins",no_of_waste_disposible_bins:"No. of Waste Disposibal Bins",segregated_plastics_handed_over_to_registered_recyclers:"Whether Segregated Plastics are being handed over to registered Re-Cyclers or Collectors?",selectedCategoriesCollector:"Source of Disposal",total_capacity_value_collector:"Average Collection (Kg per day)",number_of_vehicles:"Number of vehicles",number_of_persons:"Number of persons",selectedCategories:"Categories of plastic collected for recycling (Waste Disposal and Waste Collection in Kg per day)",plastic_waste_acquired_through:"Plastic waste acquired through",has_adequate_pollution_control_systems:"Has adequate pollution control systems or equipment to meet the standards of emission or effluent?",pollution_control_details:"Polution control details",licenseType:"License Type"},C=(f,l)=>e.jsx(q,{sx:{marginBottom:"20px"},children:e.jsxs(T,{children:[e.jsx($,{variant:"h6",sx:{fontWeight:"bold",marginBottom:"10px"},children:f}),Object.entries(l||{}).map(([i,b])=>b!==""&&i!=="applicationassignment"&&i!=="applicationdocument"&&i in H?e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px"},children:[e.jsxs("div",{style:{flex:"1",marginRight:"10px"},children:[e.jsxs("strong",{children:[H[i]||i,":"]})," ",typeof b=="object"&&b!==null?JSON.stringify(b,null,2):b]}),e.jsxs("div",{style:{marginRight:"10px"},children:[e.jsxs("label",{children:[e.jsx("input",{type:"radio",name:`response-${i}`,value:"Yes",style:{marginRight:"5px"},disabled:p}),"Yes"]}),e.jsxs("label",{style:{marginLeft:"10px"},children:[e.jsx("input",{type:"radio",name:`response-${i}`,value:"No",style:{marginRight:"5px"},disabled:p}),"No"]})]}),e.jsx("div",{children:e.jsx("input",{type:"text",placeholder:"Add comment",style:{width:"200px",padding:"5px",border:"1px solid #ccc",borderRadius:"4px"},readOnly:p})})]},i):null)]})}),X=f=>e.jsx(q,{sx:{marginBottom:"20px"},children:e.jsxs(T,{children:[e.jsx($,{variant:"h6",sx:{fontWeight:"bold",marginBottom:"10px"},children:"Documents"}),e.jsx("ul",{children:f.map(l=>e.jsx("li",{children:e.jsx("a",{href:l.document,target:"_blank",rel:"noopener noreferrer",children:l.document_description})},l.id))})]})}),oe={backgroundColor:"#f0f8ff",border:"1px solid #007bff",padding:"10px",borderRadius:"4px",marginBottom:"15px"},z=()=>{var f,l,i,b,B,P,k,R,S,U,ee,ae,E;return e.jsx(q,{sx:oe,children:e.jsxs(T,{children:[e.jsx($,{variant:"h6",sx:{color:"#007bff",marginBottom:"10px"},children:"Information to be provided by District Incharge"}),e.jsx(m,{label:"Latidue",invalid:!!t.annualProcurement,errorMessage:(f=t.annualProcurement)==null?void 0:f.message,children:e.jsx(g,{name:"annualProcurement",control:u,render:({field:s})=>e.jsx(_,{type:"text",placeholder:"Enter procurement",...s})})}),e.jsx(m,{label:"Longitude",invalid:!!t.annualProcurement,errorMessage:(l=t.annualProcurement)==null?void 0:l.message,children:e.jsx(g,{name:"annualProcurement",control:u,render:({field:s})=>e.jsx(_,{type:"text",placeholder:"Enter procurement",...s})})}),j.licenseType==="Producer"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{label:"Annual Procurement (Kg per day)",invalid:!!t.annualProcurement,errorMessage:(i=t.annualProcurement)==null?void 0:i.message,children:e.jsx(g,{name:"annualProcurement",control:u,render:({field:s})=>e.jsx(_,{type:"text",placeholder:"Enter procurement",...s})})}),e.jsx(m,{label:"Whether there is availability of Segregation at Source",invalid:!!t.firstName,errorMessage:(b=t.firstName)==null?void 0:b.message,children:e.jsx(g,{name:"firstName",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"Whether there is availability of Segregation at Source",...s})})}),e.jsx(m,{label:"Flow Diagram",invalid:!!t.flowDiagram,errorMessage:(B=t.flowDiagram)==null?void 0:B.message,children:e.jsx(g,{name:"flowDiagram",control:u,render:({field:s})=>e.jsx(_,{type:"file",accept:".pdf,.png,.jpg",...s})})}),e.jsx(m,{label:"List of Products",invalid:!!t.flow_diagram,errorMessage:(P=t.flow_diagram)==null?void 0:P.message,children:e.jsx(g,{name:"flow_diagram",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"List of Products",...s})})}),e.jsx(m,{label:"List of By Products",invalid:!!t.flow_diagram,errorMessage:(k=t.flow_diagram)==null?void 0:k.message,children:e.jsx(g,{name:"flow_diagram",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"List of By Products",...s})})}),e.jsx(m,{label:"List and Quanity of Raw Material Imported",invalid:!!t.flow_diagram,errorMessage:(R=t.flow_diagram)==null?void 0:R.message,children:e.jsx(g,{name:"flow_diagram",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"List and Quanity of Raw Material Imported",...s})})}),e.jsx(m,{label:"Name of seller/Importer",invalid:!!t.flow_diagram,errorMessage:(S=t.flow_diagram)==null?void 0:S.message,children:e.jsx(g,{name:"flow_diagram",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"Name of seller/Importer",...s})})})]}),j.licenseType==="Recycler"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{label:"No. of workers (including  contract labour)",invalid:!!t.firstName,errorMessage:(U=t.firstName)==null?void 0:U.message,children:e.jsx(g,{name:"firstName",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"No. of workers (including  contract labour)",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...s})})}),e.jsx(m,{label:"Whether registerd with Labor Dept.? If Yes, provide details",invalid:!!t.firstName,errorMessage:(ee=t.firstName)==null?void 0:ee.message,children:e.jsx(g,{name:"firstName",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"Whether registerd with Labor Dept.? If Yes, provide details",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...s})})}),e.jsx(m,{label:`Occupational safety and health \r
aspects \r
(Please provide details of \r
facilities)`,invalid:!!t.firstName,errorMessage:(ae=t.firstName)==null?void 0:ae.message,children:e.jsx(g,{name:"firstName",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:"Occupational safety and health aspects (Please provide details of facilities)",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...s})})}),e.jsx(m,{label:`Whether conditions exist or are \r
likely to exist of the material \r
being handled or processed \r
 \r
posing adverse immediate or \r
delayed \r
impacts \r
on \r
the \r
environment. `,invalid:!!t.firstName,errorMessage:(E=t.firstName)==null?void 0:E.message,children:e.jsx(g,{name:"firstName",control:u,render:({field:s})=>e.jsx(_,{type:"text",autoComplete:"off",placeholder:`Whether conditions exist or are \r
likely to exist of the material \r
being handled or processed \r
 \r
posing adverse immediate or \r
delayed \r
impacts \r
on \r
the \r
environment. `,style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},...s})})})]})]})})};return e.jsxs("div",{className:"p-4",style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx($,{variant:"h4",sx:{fontWeight:"bold",marginBottom:"20px"},children:"Review Information"}),M.includes("applicantDetail")&&C("Applicant Details",c),M.includes("businessEntity")&&C("Business Entity",N),M.includes("businessDetailIndividual")&&C("Business Details",x),M.includes("licenseDetail")&&C("License Details",j),j.licenseType==="Producer"&&C("Producer Details",L),j.licenseType==="Consumer"&&C("Consumer Details",K),j.licenseType==="Collector"&&C("Collector Details",Y),j.licenseType==="Recycler"&&C("Recycler Details",J),((F=c==null?void 0:c.applicationdocument)==null?void 0:F.length)>0&&X(c.applicationdocument),z(),e.jsx(q,{sx:{marginBottom:"20px"},children:e.jsx(T,{children:e.jsx(ue,{fullWidth:!0,children:e.jsx(Re,{id:"Remarks",label:"Remarks",variant:"outlined",onChange:V})})})}),e.jsx(q,{children:e.jsx(T,{children:e.jsxs(ue,{children:[e.jsx(de,{control:e.jsx(ce,{name:"nextStage",checked:w.nextStage,onChange:O}),label:`Yes - Proceed to next stage (${(Z=r[2])==null?void 0:Z.label})`}),e.jsx(de,{control:e.jsx(ce,{name:"previousStage",checked:w.previousStage,onChange:O}),label:`No - Proceed to previous stage (${(W=r[0])==null?void 0:W.label})`})]})})})]}),e.jsx("div",{children:e.jsx(q,{children:e.jsx(T,{children:e.jsx("div",{children:c!=null&&c.applicationassignment?e.jsx("div",{children:e.jsx("div",{children:c.applicationassignment},"abc123")},"abc123"):null})})})}),e.jsx(q,{children:e.jsx(T,{children:o})}),e.jsx("div",{})]})},Ve=()=>{const{id:r}=ve(),o=je(),[v,n]=D.useState(0),[w,h]=D.useState(!1),[c,x]=D.useState(!1),[N,j]=D.useState(!1),L=d=>{if(d===3){n(6);return}if(d===5){n(2);return}d<0?n(0):d>6?n(6):n(d)},K=()=>L(v+1),Y=()=>L(v-1);D.useEffect(()=>{console.log("its here1"),r?I(r):(V(),X(),F(),f())},[r]);const J=d=>e.jsxs("div",{children:[e.jsx("h5",{children:"Application Assignments"}),d.map(a=>e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Assigned Group:"})," ",a.assigned_group]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Remarks:"})," ",a.remarks||"No remarks"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Updated Date/Time:"})," ",new Date(a.created_at).toLocaleString()]})]},a.id))]}),I=d=>{te.get(`/pmc/applicant-detail/${d}/`,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{var G,ne;console.log("Data:",a.data);const A={trackingNumber:a.data.tracking_number,firstName:a.data.first_name,lastName:a.data.last_name,applicantDesignation:a.data.applicant_designation,gender:a.data.gender,cnic:a.data.cnic,email:a.data.email,phoneNumber:a.data.mobile_no,id:a.data.id,has_identity_document:a.data.has_identity_document,has_fee_challan:a.data.has_fee_challan,applicationStatus:a.data.application_status,assignedGroup:a.data.assigned_group,applicationassignment:J(a.data.applicationassignment),applicationdocument:a.data.applicationdocument};if(O(A),a.data.businessprofile){if(a.data.businessprofile.entity_type==="Company"){const y={applicant:a.data.id,businessName:a.data.businessprofile.business_name,district:a.data.businessprofile.district,tehsil:a.data.businessprofile.tehsil,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};C(y)}{const y={applicant:a.data.id,name:a.data.businessprofile.name,district:a.data.businessprofile.district_name,tehsil:a.data.businessprofile.tehsil_name,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};z(y)}W({businessEntityType:"Individual"})}if(P({licenseType:a.data.registration_for}),a.data.producer&&a.data.registration_for==="Producer"){const y={tracking_number:a.data.producer.tracking_number||"",registration_required_for:a.data.producer.registration_required_for||[],registration_required_for_other:a.data.producer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.producer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.producer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.producer.packaging_items||[],number_of_machines:a.data.producer.number_of_machines||"",total_capacity_value:((G=a.data.producer.total_capacity_value)==null?void 0:G.toString())||"",date_of_setting_up:a.data.producer.date_of_setting_up||"",total_waste_generated_value:((ne=a.data.producer.total_waste_generated_value)==null?void 0:ne.toString())||"",has_waste_storage_capacity:a.data.producer.has_waste_storage_capacity||"",waste_disposal_provision:a.data.producer.waste_disposal_provision||"",applicant:a.data.producer.applicant||""};S(y)}if(a.data.consumer&&a.data.registration_for==="Consumer"){const y={registration_required_for:a.data.consumer.registration_required_for||[],registration_required_for_other:a.data.consumer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.consumer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.consumer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.consumer.packaging_items||[],consumption:a.data.consumer.consumption||"",provision_waste_disposal_bins:a.data.consumer.provision_waste_disposal_bins||"No",no_of_waste_disposible_bins:a.data.consumer.no_of_waste_disposable_bins||"",segregated_plastics_handed_over_to_registered_recyclers:a.data.consumer.segregated_plastics_handed_over_to_registered_recyclers||"No",applicant:a.data.consumer.applicant||""};R(y)}if(a.data.recycler&&a.data.registration_for==="Recycler"){const y={selectedCategories:a.data.recycler.selected_categories||[],plastic_waste_acquired_through:a.data.recycler.plastic_waste_acquired_through||[],has_adequate_pollution_control_systems:a.data.recycler.has_adequate_pollution_control_systems||"No",pollution_control_details:a.data.recycler.pollution_control_details||"",applicant:a.data.recycler.applicant||"",registration_required_for_other_other_text:a.data.recycler.registration_required_for_other_other_text||""};U(y)}if(a.data.collector&&a.data.registration_for==="Collector"){const y={registration_required_for:a.data.collector.registration_required_for||[],registration_required_for_other:a.data.collector.registration_required_for_other||[],registration_required_for_other_other_text:a.data.collector.registration_required_for_other_other_text||"",selectedCategoriesCollector:a.data.collector.selected_categories||[],total_capacity_value_collector:a.data.collector.total_capacity_value||"",number_of_vehicles:a.data.collector.number_of_vehicles||"",number_of_persons:a.data.collector.number_of_persons||"",applicant:a.data.collector.applicant||""};k(y)}a.data.application_status==="Fee Challan"&&n(4)}).catch(a=>{console.error("Error:",a)})},M=()=>{h(!1),Ne.push(e.jsx(Se,{type:"success",children:"Customer discard!"}),{placement:"top-center"}),o("/concepts/customers/customer-list")},u=()=>{h(!0)},se=()=>{x(!0)},t=()=>{h(!1),x(!1)},Q=()=>{x(!1),Y()},ie=async()=>{if(p.assignedGroup2!==""){const d=new FormData;if(d.append("assigned_group",p.assignedGroup2),d.append("id",p.id.toString()),p.id>0){try{const A=await te.patch(`/pmc/applicant-detail/${p.id}/`,d,{headers:{"Content-Type":"multipart/form-data"}});j(!1),o("/home")}catch(A){console.error("Error in POST request:",A.response||A.message),j(!1)}K()}const a=new FormData;a.append("applicant",p.id.toString()),a.append("assigned_group",p.assignedGroup2),a.append("remarks",p.remarks),console.log(p.remarks),await te.post("/pmc/application-assignment/",a,{headers:{"Content-Type":"multipart/form-data"}})}},{applicantDetail:p,updateApplicantDetail:O,resetApplicantDetail:V,businessDetail:H,updateBusinessDetail:C,resetBusinessDetail:X,businessDetailIndividual:oe,updateBusinessDetailIndividual:z,resetBusinessDetailIndividual:F,businessEntity:Z,updateBusinessEntity:W,resetBusinessEntity:f,resetAll:l,completedSections:i,getValuesFromStateBusinessEntity:b,getValuesFromLicenseDetail:B,updateLicenseDetail:P,updateLicenseDetailCollector:k,updateLicenseDetailConsumer:R,updateLicenseDetailProducer:S,updateLicenseDetailRecycler:U,resetLicenseDetail:ee,resetLicenseDetailProducer:ae}=pe();b(),B();const E=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],s=be(p.assignedGroup);console.log("assignedGroup:",p.assignedGroup),console.log("groupList",s);function be(d){console.log(d);const a=E.indexOf(d);return E.slice(Math.max(0,a-1),a+2).map(G=>({value:G,label:G}))}return e.jsxs(e.Fragment,{children:[e.jsx(Ge,{groupList:s,children:e.jsx(Ce,{children:e.jsxs("div",{className:"flex items-center justify-between px-8",children:[e.jsx("span",{}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error bg-transparent",icon:e.jsx(De,{}),onClick:u,children:"Discard"}),e.jsx(re,{icon:e.jsx(we,{}),className:"ltr:mr-3 rtl:ml-3",variant:"solid",type:"button",loading:N,disabled:v===0,onClick:se,children:"Back"}),e.jsx(re,{icon:e.jsx(Be,{}),variant:"solid",type:"button",onClick:ie,loading:N,children:"Save"})]})]})})}),e.jsx(le,{isOpen:w,type:"danger",title:"Discard changes",onClose:t,onRequestClose:t,onCancel:t,onConfirm:M,children:e.jsx("p",{children:"Are you sure you want discard this?"})}),e.jsx(le,{isOpen:c,type:"danger",title:"Go Back",onClose:t,onRequestClose:t,onCancel:t,onConfirm:Q,children:e.jsx("p",{children:"There are unsaved changes on this step, Are you sure you want to go back step?"})})]})};export{Ve as default};
