import{r as l,X as A,j as i,A as f}from"./index-C4JzSw5_.js";import{M as v}from"./index.esm-B7-MfD0A.js";import"./TextField-Co0x8mQG.js";import"./DefaultPropsProvider-Dcv2prnH.js";import"./FormControlLabel-xgN_LnSj.js";import"./Autocomplete-D8G0kBtq.js";import"./Divider-D79cTDtd.js";import"./index-CMSQnVhG.js";const I=(t,m="",r={},c=[])=>{var u;return{id:t.id,tracking_number:t.tracking_number,first_name:t.first_name,last_name:t.last_name,cnic:t.cnic,mobile_no:t.mobile_no,application_status:t.application_status,assigned_group:t.assigned_group,registration_for:t.registration_for,application_Start_Time:t.created_at.substring(0,16),application_Submission_Time:((u=t.submittedapplication)==null?void 0:u.created_at.substring(0,16))||null}},M=t=>t.map(m=>{const r=I(m);return Object.keys(r).forEach(c=>{(r[c]===void 0||r[c]===null)&&(r[c]="N/A")}),r}),G=()=>{const[t,m]=l.useState([]),[r,c]=l.useState([]),[u,S]=l.useState([]),[E,D]=l.useState(0),[g,x]=l.useState(null),[T,O]=l.useState({});console.log(g);const L=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],w={APPLICANT:"Applicant",LSO:"LSO",LSM:"LSM",DO:"DO",LSM2:"LSM",TL:"TL",DEO:"DEO","Download License":"Download License"},R=(e,p,a)=>{const C=["first_name","last_name","cnic","mobile_no","application_status","tracking_number","assigned_group","registration_for","application_Start_Time","application_Submission_Time"],d=M(e),_=d[0];console.log(e);const n=[...Object.keys(_).filter(s=>C.includes(s)).map(s=>({accessorKey:s,header:s.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase()),size:200,Cell:({cell:o,row:y})=>i.jsx("span",{style:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>{const h=y.original.id;console.log(`Clicked ${s}:`,o.getValue()),console.log(`Navigating with ID: ${h}`),window.location.href=p?`/spuid-review/${h}?group=${a}`:`/spuid-signup/${h}`},children:o.getValue()||"-"})}))];return{flattenedData:d,columns:n}},b=A();return l.useEffect(()=>{(async()=>{try{const a=await f.get("/pmc/ping/",{headers:{"Content-Type":"application/json"}})}catch{b("/error")}try{let a=[];try{a=(await f.get("/pmc/user-groups/",{headers:{"Content-Type":"application/json"}})).data||[],S(a.map(s=>s.name))}catch(n){console.error("Error fetching user groups:",n),S([])}console.log("groupsResponse",a);const d=(await f.get("/pmc/applicant-detail/",{headers:{"Content-Type":"multipart/form-data"}})).data;if(Array.isArray(d)&&d.length>0){const n=R(d,a.length>0,a.map(o=>o.name)[0]);m(n.flattenedData),c(n.columns),console.log("Flattened Data:",n.flattenedData);const s=n.flattenedData[n.flattenedData.length-1];if(console.log("Last Row:",s),s&&s.id){x(s.id),console.log("Last Row ID:",s.id);const o=L.indexOf(s.assigned_group);o!==-1&&D(o)}}const _=await f.get("/pmc/fetch-statistics-view-groups/",{headers:{"Content-Type":"multipart/form-data"}});O(_.data)}catch(a){console.error("Error fetching data:",a)}})(),x(25);const p=L.indexOf("LSO");p!==-1&&D(p)},[]),console.log("selectedRowId:",g),console.log(g),i.jsxs("div",{children:[i.jsx("div",{className:"tiles-container",children:Object.entries(T).map(([e,p])=>i.jsxs("div",{className:"tile",children:[i.jsx("h3",{children:w[e]||e})," ",i.jsx("p",{children:p})]},e))}),i.jsx("div",{className:"mb-4",children:i.jsxs("h3",{children:[u.filter(e=>e!=="Download License"&&e!=="Applicant"&&e!=="LSM2").join(" - ")," Dashboard"]})}),i.jsx(v,{columns:[...r],data:t.map(e=>({...e,assigned_group_title:w[e.assigned_group]||e.assigned_group})),getRowId:e=>e.id,initialState:{showColumnFilters:!1},defaultColumn:{maxSize:420,minSize:1,size:100},enableColumnResizing:!0,columnResizeMode:"onChange",enableTopToolbar:u.length>0,enablePagination:!1},g)]})};export{G as default};
