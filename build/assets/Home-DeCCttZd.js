import{r as c,j as i,A as x,b as R}from"./index-C0qVRtci.js";import{M as y}from"./index.esm-CYSBodEh.js";import"./TextField-YTQzAFx2.js";import"./FormControlLabel-B3h1FXhc.js";import"./Autocomplete-L7hM99TR.js";import"./index-hSj0bml_.js";const b=(d,l="",n={},r=[])=>{for(const[f,o]of Object.entries(d||{})){const h=l?`${l}.${f}`:f;r.some(m=>h.startsWith(m))||o&&typeof o=="object"&&!Array.isArray(o)||(n[h]=o??"N/A")}return n},T=d=>d.map(l=>{const n=b(l);return Object.keys(n).forEach(r=>{(n[r]===void 0||n[r]===null)&&(n[r]="N/A")}),n}),N=()=>{const[d,l]=c.useState([]),[n,r]=c.useState([]),[f,o]=c.useState([]),[h,m]=c.useState(0),[p,L]=c.useState(null),[C,w]=c.useState({});console.log(p);const j=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],O={APPLICANT:"Applicant",LSO:"LSO",LSM:"LSM",DO:"DO",LSM2:"LSM",TL:"TL",DEO:"DEO","Download License":"Download License"},A=(e,t)=>{const S=T(e),u=S[0],D=[...Object.keys(u).filter(s=>s!=="applicationassignment").map(s=>({accessorKey:s,header:s.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()),size:200,Cell:({cell:a,row:g})=>s==="id"?i.jsx(R,{to:t?`/spuid-review/${g.original.id}`:`/spuid-signup/${g.original.id}`,children:a.getValue()}):a.getValue()||"-"}))];return{flattenedData:S,columns:D}};return c.useEffect(()=>{(async()=>{try{const t=await x.get("/pmc/user-groups/",{headers:{"Content-Type":"multipart/form-data"}});o(t.data);const u=(await x.get("/pmc/applicant-detail/",{headers:{"Content-Type":"multipart/form-data"}})).data;if(Array.isArray(u)&&u.length>0){const s=A(u,t.data.length>0);l(s.flattenedData),r(s.columns),console.log("Flattened Data:",s.flattenedData);const a=s.flattenedData[s.flattenedData.length-1];if(console.log("Last Row:",a),a&&a.id){L(a.id),console.log("Last Row ID:",a.id);const g=j.indexOf(a.assigned_group);g!==-1&&m(g)}}const D=await x.get("/pmc/fetch-statistics-view-groups/",{headers:{"Content-Type":"multipart/form-data"}});w(D.data)}catch(t){console.error("Error fetching data:",t)}})()},[]),console.log("selectedRowId:",p),console.log(p),i.jsxs("div",{children:[i.jsx("div",{className:"tiles-container",children:Object.entries(C).map(([e,t])=>i.jsxs("div",{className:"tile",children:[i.jsx("h3",{children:O[e]||e})," ",i.jsx("p",{children:t})]},e))}),i.jsx(y,{columns:[{accessorKey:"selected",header:"Select",size:50,Cell:({row:e})=>i.jsx("input",{type:"radio",name:"rowSelect",onChange:()=>{L(e.original.id);const t=j.indexOf(e.original.assigned_group);t!==-1&&m(t)},checked:String(p)===String(e.original.id)})},...n],data:d.map(e=>({...e,assigned_group_title:O[e.assigned_group]||e.assigned_group})),getRowId:e=>e.id,initialState:{showColumnFilters:!0},defaultColumn:{maxSize:420,minSize:1,size:100},enableColumnResizing:!0,columnResizeMode:"onChange"},p)]})};export{N as default};
