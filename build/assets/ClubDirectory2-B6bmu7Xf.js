import{r,j as e,A as j}from"./index-B4Yyn_e3.js";/* empty css           */import{M as P,V as $,T as A,O as R,a as N,b as x,S as B,e as G,F as C,c as v}from"./OSM-xj16LtVI.js";import{G as H}from"./GeoJSON-X8m8cf5v.js";import{M as K}from"./index.esm-DQ5xyWPR.js";import{m as f,q as O,h as I,n as q,o as J,p as W}from"./index-CEaiGlSZ.js";import{M as Z}from"./Modal-AKqUA7L2.js";import"./TextField-CTAYyKbu.js";import"./DefaultPropsProvider-Dxaa7F9g.js";import"./emotion-element-f0de968e.browser.esm-D-FlQB8p.js";import"./setPrototypeOf-C3V6guyq.js";import"./assertThisInitialized-CUNnMRSQ.js";import"./Autocomplete-Ba7F61HC.js";import"./Box-C4R34K36.js";import"./FormControlLabel-BQ4LaRk8.js";import"./Divider-BmRGXkoa.js";import"./index-wc-c60si.js";const xe=()=>{const h=r.useRef(null),[o,k]=r.useState(null),[n,S]=r.useState(null),[Q,_]=r.useState(null),[u,M]=r.useState([]),[i,p]=r.useState(null),[D,b]=r.useState(!1),[g,V]=r.useState([]),[l,c]=r.useState(null),[F,L]=r.useState(!0);r.useEffect(()=>{const t=new P({target:h.current,layers:[new A({source:new R})],view:new $({zoom:7,center:[8127130,3658593]})}),s=new N({source:new x}),a=new N({source:new x});return t.addLayer(s),t.addLayer(a),S(s),_(a),k(t),()=>t.setTarget(null)},[]),r.useEffect(()=>{if(!n||!o)return;(async()=>{b(!0);try{const s=await j.get("/pmc/idm_districts-club-counts/");V(s.data.features);const a=new x({features:new H().readFeatures(s.data,{featureProjection:"EPSG:3857"})});n.setSource(a),o.getView().fit(a.getExtent(),{padding:[50,50,50,50],duration:500})}catch(s){console.error("Error fetching districts:",s)}finally{b(!1)}})()},[n,o]),r.useEffect(()=>{n&&n.setStyle(t=>{const s=t.get("id")===i;if(t.get("club_count")!==0)return new B({stroke:new v({color:s?"red":"blue",width:s?3:2}),fill:new C({color:s?"rgba(255,0,0,0.1)":"rgba(0,0,255,0.1)"}),text:new G({text:`${t.get("name")} (${t.get("club_count")})`,font:"bold 10px sans-serif",fill:new C({color:"#000"}),stroke:new v({color:"#fff",width:3}),overflow:!0})})})},[n,i]),r.useEffect(()=>{(async()=>{const s=await j.get("/pmc/idm_clubs/all/");M(s.data.features)})()},[]),r.useEffect(()=>{if(!o||!n)return;const t=s=>{const a=o.getFeaturesAtPixel(s.pixel);if(a.length>0){const y=a[0].get("id");i===y?(p(null),o.getView().setCenter([8127130,3658593])):p(y)}else p(null),o.getView().setCenter([8127130,3658593])};return o.on("click",t),()=>o.un("click",t)},[o,n,i]);const z=r.useMemo(()=>i?u.filter(t=>t.properties.district_id===i):u,[i,u]),T=r.useMemo(()=>[{accessorKey:"properties.district",header:"District",size:150,Cell:({cell:t})=>e.jsx("a",{href:"#",className:"text-blue-500 hover:underline",onClick:s=>{s.preventDefault(),c(t.row.original.properties)},children:t.getValue()})},{accessorKey:"properties.name",header:"School Name",size:225,Cell:({cell:t})=>e.jsx("a",{href:"#",className:"text-blue-500 hover:underline",onClick:s=>{s.preventDefault(),c(t.row.original.properties)},children:t.getValue()})},{accessorKey:"properties.address",header:"Address",size:225,Cell:({cell:t})=>e.jsx("a",{href:"#",className:"text-blue-500 hover:underline",onClick:s=>{s.preventDefault(),c(t.row.original.properties)},children:t.getValue()})},{accessorKey:"properties.head_name",header:"Head Name",size:200,Cell:({cell:t})=>e.jsx("a",{href:"#",className:"text-blue-500 hover:underline",onClick:s=>{s.preventDefault(),c(t.row.original.properties)},children:t.getValue()})},{header:"Map",size:50,Cell:({row:t})=>{const{name:s,district:a}=t.original.properties,d=m(s,a);return e.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",title:"Open in Google Maps",className:"text-blue-500 hover:text-blue-700",children:e.jsx(f,{size:20})})}}],[]),E=r.useMemo(()=>{const t=[...g].sort((s,a)=>a.properties.club_count-s.properties.club_count).slice(0,3);return[{properties:{name:"Total Clubs",club_count:u.length,id:null}},...t]},[g,u]),w=[{bgColor:"bg-gray-500",icon:e.jsx(I,{className:"text-white text-3xl"})},{bgColor:"bg-orange-500",icon:e.jsx(q,{className:"text-white text-3xl"})},{bgColor:"bg-blue-500",icon:e.jsx(J,{className:"text-white text-3xl"})},{bgColor:"bg-yellow-500",icon:e.jsx(f,{className:"text-white text-3xl"})},{bgColor:"bg-green-500",icon:e.jsx(W,{className:"text-white text-3xl"})}],m=(t,s)=>{const a=d=>(d==null?void 0:d.replace(/\d+/g,"").replace(/\s+/g,"+"))||"";return`https://www.google.com/maps/search/?api=1&query=${a(t)}+${a(s)}`};return e.jsxs("div",{className:"flex flex-col p-4 gap-4",children:[F&&e.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded relative",children:[e.jsx("p",{className:"font-medium",children:"To access Head Contact Number and Club Notification, please click on the School Name."}),e.jsx("button",{className:"absolute top-2 right-2 text-yellow-700 hover:text-yellow-900",onClick:()=>L(!1),children:"Ã—"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:E.map((t,s)=>e.jsx("div",{className:`shadow-md rounded p-6 w-full cursor-pointer transition 
                ${i===null||i===t.properties.id?"opacity-100":"opacity-50"}
                ${w[s].bgColor}
                `,onClick:()=>p(t.properties.id),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[w[s].icon,e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.properties.name}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.properties.club_count})]})},s))}),e.jsxs("div",{className:"flex flex-col p-4 gap-4 md:flex-row",children:[e.jsxs("div",{className:"relative md:w-1/2",children:[D&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-10",children:e.jsx("div",{className:"animate-spin h-10 w-10 border-4 border-blue-500 border-t-transparent rounded-full"})}),e.jsx("div",{ref:h,style:{height:"850px",width:"500px"}})]}),e.jsx("div",{style:{flex:1},children:e.jsx(K,{columns:T,data:z,initialState:{pagination:{pageSize:15}},enableZebraStripes:!0,enableColumnResizing:!0,muiTableBodyRowProps:({row:t})=>({style:{cursor:"pointer"},sx:{"&:nth-of-type(even)":{backgroundColor:"#f9f9f9"},"&:hover":{backgroundColor:"#e0f7fa"}}}),muiTableProps:{sx:{border:"1px solid #ddd"}},muiTableHeadCellProps:{sx:{backgroundColor:"#f5f5f5",fontWeight:"bold",borderBottom:"2px solid #ccc",textAlign:"center"}},muiTableBodyCellProps:{sx:{borderRight:"1px solid #ddd",padding:"10px"}}})})]}),e.jsx(Z,{open:!!l,onClose:()=>c(null),"aria-labelledby":"club-details-modal",children:e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 w-96 max-w-lg",children:l&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:l.name}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"District:"})," ",l.district]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Address:"})," ",l.address]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Head Name:"})," ",l.head_name]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Head Mobile:"})," ",l.head_mobile]}),l.notification_path&&e.jsxs("div",{className:"flex items-center space-x-2 border-t pt-3",children:[e.jsx(O,{size:24,className:"text-blue-500 cursor-pointer transition-transform transform hover:scale-110",onClick:()=>window.open(`/api/pmc/media${l.notification_path}`,"_blank")}),e.jsx("a",{href:`/api/pmc/media${l.notification_path}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 font-semibold hover:underline",children:"View Notification"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 border-t pt-3 mt-3",children:[e.jsx(f,{size:24,className:"text-green-600 cursor-pointer transition-transform transform hover:scale-110",onClick:()=>window.open(m(l.name,l.district),"_blank")}),e.jsx("a",{href:m(l.name,l.district),target:"_blank",rel:"noopener noreferrer",className:"text-green-600 font-semibold hover:underline",children:"View on Google Maps"})]}),e.jsx("div",{className:"mt-5 flex justify-end",children:e.jsx("button",{onClick:()=>c(null),className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200",children:"Close"})})]})})})})]})};export{xe as default};
