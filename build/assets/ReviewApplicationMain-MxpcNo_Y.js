import{r as j,j as e,ao as Fe,A as T,am as Te,U as Oe,a0 as Ae}from"./index-DP0NkcW3.js";import{B as le}from"./StatusIcon-B5MqphbU.js";import{G as Me,H as Re,D as Ie,N as qe}from"./toast-G0fFhDc3.js";import{u as we,a as Ee,C as ye}from"./ConfirmDialog-6lRlo7IP.js";import{u as Le,I as y,a as x}from"./index.esm-BmLangP2.js";import{T as A,F as ve,C as je}from"./FormControlLabel-B5K9WR7z.js";import{n as Ne,k as De,o as Se,u as ke,c as Pe,j as Be,D as Ge}from"./Divider-DWVv-9BK.js";import{P as Ye,Q as Ce,U as We}from"./TextField-LND9HAWl.js";import"./proxy-DmlfWv2F.js";import"./index-B8SbArSK.js";function Ue(c){return De("MuiCard",c)}Ne("MuiCard",["root"]);const ze=c=>{const{classes:h}=c;return Be({root:["root"]},Ue,h)},$e=Se(Ye,{name:"MuiCard",slot:"Root",overridesResolver:(c,h)=>h.root})({overflow:"hidden"}),k=j.forwardRef(function(h,O){const v=ke({props:h,name:"MuiCard"}),{className:M,raised:D=!1,...C}=v,N={...v,raised:D},p=ze(N);return e.jsx($e,{className:Pe(p.root,M),elevation:D?8:void 0,ref:O,ownerState:N,...C})});function He(c){return De("MuiCardContent",c)}Ne("MuiCardContent",["root"]);const Ve=c=>{const{classes:h}=c;return Be({root:["root"]},He,h)},Ke=Se("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(c,h)=>h.root})({padding:16,"&:last-child":{paddingBottom:24}}),P=j.forwardRef(function(h,O){const v=ke({props:h,name:"MuiCardContent"}),{className:M,component:D="div",...C}=v,N={...v,component:D},p=Ve(N);return e.jsx(Ke,{as:D,className:Pe(p.root,M),ownerState:N,ref:O,...C})}),Qe=({groupList:c,children:h})=>{var W,U,z,ne;const[O,v]=j.useState(c!==void 0&&c.length>1?c[1].value:""),[M,D]=j.useState({previousStage:!1,nextStage:!1}),[C,N]=j.useState({}),[p,q]=j.useState({latitude:"",longitude:""}),{applicantDetail:m,businessDetailIndividual:$,businessEntity:H,licenseDetail:B,licenseDetailProducer:V,licenseDetailConsumer:K,licenseDetailCollector:Q,licenseDetailRecycler:R,updateApplicantDetail:I,completedSections:E}=we(),{control:ce,handleSubmit:de,formState:{errors:t}}=Le({defaultValues:{firstName:""}}),[J]=Fe(),L=J.get("group"),l=L!=="DO",X=L!=="LSM"&&L!=="LSM2";j.useEffect(()=>{v(c!==void 0&&c.length>1?c[1].value:"")},[c]),j.useEffect(()=>{console.log("its in effect of review application "),console.log(m),m.id&&Z(m.id)},[m.id]),j.useEffect(()=>{console.log("fieldResponses",C),I({fieldResponses:C,readOnly:l})},[C]),console.log("fieldResponses",C),j.useEffect(()=>{I({manualFields:p,readOnly:l})},[p]);const Z=async _=>{try{const o=m.field_responses.reduce((i,f)=>(i[f.field_key]={response:f.response,comment:f.comment},i),{});N(o),m.manual_fields?q(m.manual_fields):q({})}finally{}},ee=(_,o)=>{N(i=>{var f;return{...i,[_]:{...i[_],response:o,comment:o==="No"?((f=i[_])==null?void 0:f.comment)||"":null}}})},ae=(_,o)=>{N(i=>({...i,[_]:{...i[_],comment:o}}))},te=async(_,o)=>{const i=new FormData;i.append("document",_),i.append("document_description",o),i.append("applicant",m.id.toString());try{const f=await T.post("/pmc/applicant-documents/",i,{headers:{"Content-Type":"multipart/form-data"}});I({applicationdocument:[...m.applicationdocument||[],f.data]}),alert("Payment Verification Letter is uploaded")}catch(f){console.error("Error in POST request:",f.response||f.message),navigate("/error")}},g=(_,o)=>{q(i=>({...i,[_]:o}))};console.log(m);const G=_=>{var s,a,r,d;const{name:o,checked:i}=_.target;if(D({previousStage:o==="previousStage"?i:!1,nextStage:o==="nextStage"?i:!1}),o==="previousStage"&&i){v((s=c[0])==null?void 0:s.value);const S={assignedGroup2:(a=c[0])==null?void 0:a.value};I(S)}else if(o==="nextStage"&&i){const S={assignedGroup2:(r=c[2])==null?void 0:r.value};I(S),v((d=c[2])==null?void 0:d.value)}},se=_=>{const o={remarks:_.target.value};I(o)},ie={firstName:"First Name",lastName:"Last Name",applicantDesignation:"Designation",gender:"Gender",cnic:"CNIC",email:"Email",phoneNumber:"Mobile Number",trackingNumber:"Tracking Number",businessEntityType:"Business Entity Type",name:"Business Name",district:"District",tehsil:"Tehsil",city:"City",postalAddress:"Postal Address",registration_required_for:"Categories of Single Use Plastics",registration_required_for_other:"Categories for Other Plastics",registration_required_for_other_other_text:"Other",plain_plastic_Sheets_for_food_wrapping:"Additional Options for Packaging",PackagingItems:"Packging Item Other List",number_of_machines:"Number of machines",total_capacity_value:"Average Production Capacity (Kg per day)",date_of_setting_up:"Date of Business Setting Up",total_waste_generated_value:"Averrage Waste Generated (Kg per day)",has_waste_storage_capacity:"Has Waste Storage Capacity?",waste_disposal_provision:"Waste Disposal Provision",consumption:"Average Sale (Kg per day)",provision_waste_disposal_bins:"Provision of Waste Disposal Bins",no_of_waste_disposible_bins:"No. of Waste Disposibal Bins",segregated_plastics_handed_over_to_registered_recyclers:"Whether Segregated Plastics are being handed over to registered Re-Cyclers or Collectors?",selectedCategoriesCollector:"Source of Disposal",total_capacity_value_collector:"Average Collection (Kg per day)",number_of_vehicles:"Number of vehicles",number_of_persons:"Number of persons",selectedCategories:"Categories of plastic collected for recycling (Waste Disposal and Waste Collection in Kg per day)",plastic_waste_acquired_through:"Plastic waste acquired through",has_adequate_pollution_control_systems:"Has adequate pollution control systems or equipment to meet the standards of emission or effluent?",pollution_control_details:"Polution control details",licenseType:"License Type",totalFeeAmount:"Total Fee Amount",verifiedFeeAmount:"Verified Fee Amount"},pe=(_,o)=>e.jsx(k,{className:"mb-4",children:e.jsxs(P,{children:[e.jsx(A,{variant:"h6",className:"font-bold mb-4",children:_}),Array.isArray(o)&&o.length>0?o.map((i,f)=>e.jsx("div",{className:"border-b border-gray-300 last:border-none",children:Object.entries(i).map(([s,a])=>a!==""?e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-bold mr-2 capitalize",children:[s.replace(/_/g," "),":"]}),e.jsx("span",{className:"text-normal break-words",children:typeof a=="object"&&a!==null?JSON.stringify(a,null,2):a})]},s):null)},f)):e.jsx(A,{variant:"body2",className:"text-gray-600",children:"No PSID Tracking records available."})]})}),F=(_,o)=>e.jsx(k,{className:"mb-4",children:e.jsxs(P,{children:[e.jsx(A,{variant:"h6",className:"font-bold mb-4",children:_}),Object.entries(o||{}).map(([i,f])=>{var s,a,r,d;return f!==""&&i!=="applicationassignment"&&i!=="applicationdocument"&&i in ie?e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-4",children:[e.jsxs("div",{className:"w-full md:flex-[5] flex flex-col md:flex-row items-start md:items-center mb-2 md:mb-0",children:[e.jsxs("span",{className:"font-bold mr-2",children:[ie[i]||i,":"]}),e.jsx("span",{className:"text-normal break-words",children:typeof f=="object"&&f!==null?JSON.stringify(f,null,2):f})]}),e.jsxs("div",{className:"w-full md:flex-[3] flex items-center justify-center space-x-4 mt-2 md:mt-0",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:`response-${i}`,value:"Yes",checked:((s=C[i])==null?void 0:s.response)==="Yes",onChange:()=>ee(i,"Yes"),disabled:l}),e.jsx("span",{children:"Yes"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:`response-${i}`,value:"No",checked:((a=C[i])==null?void 0:a.response)==="No",onChange:()=>ee(i,"No"),disabled:l}),e.jsx("span",{children:"No"})]})]}),e.jsx("div",{className:"w-full md:flex-[5]",children:((r=C[i])==null?void 0:r.response)==="No"&&e.jsx(y,{type:"textarea",placeholder:"Add comment",value:((d=C[i])==null?void 0:d.comment)||"",onChange:S=>ae(i,S.target.value),className:"w-full border border-gray-300 rounded-lg p-2",readOnly:l})})]},i):null})]})}),re=_=>e.jsx(k,{sx:{marginBottom:"20px"},children:e.jsxs(P,{children:[e.jsx(A,{variant:"h6",sx:{fontWeight:"bold",marginBottom:"10px"},children:"Documents"}),e.jsx("ul",{children:_.map(o=>e.jsx("li",{children:e.jsxs("a",{href:o.document,target:"_blank",rel:"noopener noreferrer",children:[o.document_description," ",o.created_at.substring(0,19)]})},o.id))})]})}),Y={backgroundColor:"#f0f8ff",border:"1px solid #007bff",padding:"10px",borderRadius:"4px",marginBottom:"15px"},oe=()=>{var _,o,i,f,s,a,r,d,S,w,u,b,ue,me,_e,fe,ge,he,xe,be;return e.jsxs(e.Fragment,{children:[e.jsx(k,{sx:Y,children:e.jsxs(P,{children:[e.jsx(A,{variant:"h6",sx:{color:"#007bff",marginBottom:"10px"},children:"Information to be provided by District Incharge"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(x,{label:"Latitude",invalid:!!t.latitude,errorMessage:(_=t.latitude)==null?void 0:_.message,children:e.jsx(y,{type:"number",placeholder:"Enter Latitude",value:p.latitude||"",onChange:n=>g("latitude",n.target.value),readOnly:l})}),e.jsx(x,{label:"Longitude",invalid:!!t.longitude,errorMessage:(o=t.longitude)==null?void 0:o.message,children:e.jsx(y,{type:"number",placeholder:"Enter Longitude",value:p.longitude||"",onChange:n=>g("longitude",n.target.value),readOnly:l})})]}),B.licenseType==="Producer"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(x,{label:"List of Products",invalid:!!t.listOfProducts,errorMessage:(i=t.listOfProducts)==null?void 0:i.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"List of Products",value:p.list_of_products||"",onChange:n=>g("list_of_products",n.target.value),readOnly:l})}),e.jsx(x,{label:"List of By Products",invalid:!!t.listOfByProducts,errorMessage:(f=t.listOfByProducts)==null?void 0:f.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"List of By Products",value:p.list_of_by_products||"",onChange:n=>g("list_of_by_products",n.target.value),readOnly:l})}),e.jsx(x,{label:"List and Quantity of Raw Material Imported",invalid:!!t.rawMaterialImported,errorMessage:(s=t.rawMaterialImported)==null?void 0:s.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"List and Quantity of Raw Material Imported",value:p.raw_material_imported||"",onChange:n=>g("raw_material_imported",n.target.value),readOnly:l})}),e.jsx(x,{label:"If raw material is bought, then Name of Seller",invalid:!!t.sellerNameIfRawMaterialBought,errorMessage:(a=t.sellerNameIfRawMaterialBought)==null?void 0:a.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"If raw material is bought then Name of seller",value:p.seller_name_if_raw_material_bought||"",onChange:n=>g("seller_name_if_raw_material_bought",n.target.value),readOnly:l})}),e.jsx(x,{label:"If self import, provide details",invalid:!!t.selfImportDetails,errorMessage:(r=t.selfImportDetails)==null?void 0:r.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"If self import, provide details",value:p.self_import_details||"",onChange:n=>g("self_import_details",n.target.value),readOnly:l})}),e.jsx(x,{label:"Quantity of Raw Material Utilized",invalid:!!t.rawMaterialUtilized,errorMessage:(d=t.rawMaterialUtilized)==null?void 0:d.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"Quantity of raw material utilized",value:p.raw_material_utilized||"",onChange:n=>g("raw_material_utilized",n.target.value),readOnly:l})})]}),e.jsx("div",{className:"grid md:grid-cols-1 gap-4",children:e.jsx("div",{className:"mb-4",children:e.jsx(Ge,{textAlign:"left"})})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(x,{label:"Status of compliance with â€“ Thickness 75 micron",invalid:!!t.complianceThickness75,errorMessage:(S=t.complianceThickness75)==null?void 0:S.message,children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"complianceThickness75",value:"Yes",checked:p.compliance_thickness_75==="Yes",onChange:()=>g("compliance_thickness_75","Yes"),disabled:l}),e.jsx("span",{children:"Yes"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"complianceThickness75",value:"No",checked:p.compliance_thickness_75==="No",onChange:()=>g("compliance_thickness_75","No"),disabled:l}),e.jsx("span",{children:"No"})]})]})}),e.jsx(x,{label:"Does the unit have a valid consent/permit under the building and construction by-laws?",invalid:!!t.validConsentPermitBuildingBylaws,errorMessage:(w=t.validConsentPermitBuildingBylaws)==null?void 0:w.message,children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"validConsentPermitBuildingBylaws",value:"Yes",checked:p.valid_consent_permit_building_bylaws==="Yes",onChange:()=>g("valid_consent_permit_building_bylaws","Yes"),disabled:l}),e.jsx("span",{children:"Yes, please attach a copy"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"validConsentPermitBuildingBylaws",value:"No",checked:p.valid_consent_permit_building_bylaws==="No",onChange:()=>g("valid_consent_permit_building_bylaws","No"),disabled:l}),e.jsx("span",{children:"No"})]})]})}),e.jsx(x,{label:"Copy of consent/permit under the building and construction by-laws",invalid:!!t.consentPermitFile,errorMessage:(u=t.consentPermitFile)==null?void 0:u.message,children:e.jsx(y,{type:"file",accept:".pdf,.png,.jpg",onChange:n=>g("consent_permit_file",n.target.files[0]),disabled:l})}),e.jsx(x,{label:"Flow Diagram",invalid:!!t.flowDiagramFile,errorMessage:(b=t.flowDiagramFile)==null?void 0:b.message,children:e.jsx(y,{type:"file",accept:".pdf,.png,.jpg",onChange:n=>g("flow_diagram_file",n.target.files[0]),disabled:l})}),e.jsx(x,{label:"Action Plan",invalid:!!t.actionPlanFile,errorMessage:(ue=t.actionPlanFile)==null?void 0:ue.message,children:e.jsx(y,{type:"file",accept:".pdf,.png,.jpg",onChange:n=>g("action_plan_file",n.target.files[0]),disabled:l})}),e.jsx(x,{label:"List of Stockist/Distributor/Supplier to whom the products will be supplied",invalid:!!t.stockistDistributorList,errorMessage:(me=t.stockistDistributorList)==null?void 0:me.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"List of Stockist/Distributor/Supplier",value:p.stockist_distributor_list||"",onChange:n=>g("stockist_distributor_list",n.target.value),readOnly:l})})]})]}),B.licenseType==="Consumer"&&e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:e.jsx(x,{label:"Procurement (Kg per day)",invalid:!!t.procurementPerDay,errorMessage:(_e=t.procurementPerDay)==null?void 0:_e.message,children:e.jsx(y,{type:"text",placeholder:"Enter procurement",value:p.procurement_per_day||"",onChange:n=>g("procurement_per_day",n.target.value),readOnly:l})})}),B.licenseType==="Recycler"&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(x,{label:"No. of workers (including contract labour)",invalid:!!t.noOfWorkers,errorMessage:(fe=t.noOfWorkers)==null?void 0:fe.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"No. of workers (including contract labour)",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},value:p.no_of_workers||"",onChange:n=>g("no_of_workers",n.target.value),readOnly:l})}),e.jsx(x,{label:"Whether registered with Labor Dept.? If Yes, provide details?",invalid:!!t.laborDeptRegistrationStatus,errorMessage:(ge=t.laborDeptRegistrationStatus)==null?void 0:ge.message,children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"labor_dept_registration_status",value:"Yes",checked:p.labor_dept_registration_status==="Yes",onChange:()=>g("labor_dept_registration_status","Yes"),disabled:l}),e.jsx("span",{children:"Yes, please provide details"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"labor_dept_registration_status",value:"No",checked:p.labor_dept_registration_status==="No",onChange:()=>g("labor_dept_registration_status","No"),disabled:l}),e.jsx("span",{children:"No"})]})]})}),e.jsx(x,{label:"Occupational safety and health aspects (Please provide details of facilities)",invalid:!!t.occupationalSafetyAndHealthFacilities,errorMessage:(he=t.occupationalSafetyAndHealthFacilities)==null?void 0:he.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"Occupational safety and health facilities",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},value:p.occupational_safety_and_health_facilities||"",onChange:n=>g("occupational_safety_and_health_facilities",n.target.value),readOnly:l})}),e.jsx(x,{label:"Whether conditions exist or are likely to exist for the material being handled or processed to pose adverse impacts on the environment?",invalid:!!t.adverseEnvironmentalImpacts,errorMessage:(xe=t.adverseEnvironmentalImpacts)==null?void 0:xe.message,children:e.jsx(y,{type:"text",autoComplete:"off",placeholder:"Adverse environmental impacts details",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},value:p.adverse_environmental_impacts||"",onChange:n=>g("adverse_environmental_impacts",n.target.value),readOnly:l})})]})]})}),e.jsx(k,{sx:Y,children:e.jsxs(P,{children:[e.jsx(A,{variant:"h6",sx:{color:"#007bff",marginBottom:"10px"},children:"Information to be provided by License Support Manager"}),e.jsx("div",{className:"grid md:grid-cols-1 gap-4",children:e.jsx(x,{label:"Fee Verification from Treasury/District Accounts Office",invalid:!!t.consentPermitFile,errorMessage:(be=t.consentPermitFile)==null?void 0:be.message,children:e.jsx(y,{type:"file",accept:".pdf,.png,.jpg",onChange:n=>te(n.target.files[0],"Fee Verification from Treasury/District Accounts Office"),disabled:X})})})]})})]})};return e.jsxs("div",{className:"p-4",style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx(A,{variant:"h4",sx:{fontWeight:"bold",marginBottom:"20px"},children:"Review Information"}),!l&&e.jsx(k,{className:"mb-4",children:e.jsx(P,{children:e.jsx(A,{variant:"h7",sx:{fontWeight:"bold",marginBottom:"20px"},children:'If the provided information is correct, please click "Yes". If it is incorrect, then please click "No" and add comments'})})}),l&&e.jsx(k,{className:"mb-4",children:e.jsx(P,{children:e.jsx(A,{variant:"h7",sx:{fontWeight:"bold",marginBottom:"20px"},children:"Please review the information provided by the District Incharge. This information is not editable and for your review only."})})}),E.includes("applicantDetail")&&F("Applicant Details",m),E.includes("businessEntity")&&F("Business Entity",H),E.includes("businessDetailIndividual")&&F("Business Details",$),E.includes("licenseDetail")&&F("License Details",B),B.licenseType==="Producer"&&F("Producer Details",V),B.licenseType==="Consumer"&&F("Consumer Details",K),B.licenseType==="Collector"&&F("Collector Details",Q),B.licenseType==="Recycler"&&F("Recycler Details",R),((W=m==null?void 0:m.applicationdocument)==null?void 0:W.length)>0&&re(m.applicationdocument),((U=m==null?void 0:m.psid_tracking)==null?void 0:U.length)>0&&pe("PSID Tracking",m.psid_tracking),oe(),e.jsx(k,{sx:{marginBottom:"20px"},children:e.jsx(P,{children:e.jsx(Ce,{fullWidth:!0,children:e.jsx(We,{id:"Remarks",label:"Remarks",variant:"outlined",onChange:se})})})}),e.jsx(k,{children:e.jsx(P,{children:e.jsxs(Ce,{children:[e.jsx(ve,{control:e.jsx(je,{name:"nextStage",checked:M.nextStage,onChange:G}),label:`Yes - As per remarks, proceed to next stage (${(z=c[2])==null?void 0:z.label})`}),e.jsx(ve,{control:e.jsx(je,{name:"previousStage",checked:M.previousStage,onChange:G}),label:`No - Proceed to previous stage (${(ne=c[0])==null?void 0:ne.label})`})]})})})]}),e.jsx("div",{children:e.jsx(k,{children:e.jsx(P,{children:e.jsx("div",{children:m!=null&&m.applicationassignment?e.jsx("div",{children:e.jsx("div",{children:m.applicationassignment},"abc123")},"abc123"):null})})})}),e.jsx(k,{children:e.jsx(P,{children:h})}),e.jsx("div",{})]})},na=()=>{const{id:c}=Te(),h=Oe(),[O,v]=j.useState(0),[M,D]=j.useState(!1),[C,N]=j.useState(!1),[p,q]=j.useState(!1),m=s=>{if(s===3){v(6);return}if(s===5){v(2);return}s<0?v(0):s>6?v(6):v(s)},$=()=>m(O-1);j.useEffect(()=>{console.log("its here1"),c?B(c):(L(),Z(),te(),se())},[c]);const H=s=>e.jsxs("div",{children:[e.jsx("h5",{children:"Application Assignments"}),s.map(a=>e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Assigned Group:"})," ",a.assigned_group]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Remarks:"})," ",a.remarks||"No remarks"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Updated Date/Time:"})," ",new Date(a.created_at).toLocaleString()]})]},a.id))]}),B=s=>{T.get(`/pmc/applicant-detail/${s}/`,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{var d,S;console.log("Data:",a.data);const r={trackingNumber:a.data.tracking_number,firstName:a.data.first_name,lastName:a.data.last_name,applicantDesignation:a.data.applicant_designation,gender:a.data.gender,cnic:a.data.cnic,email:a.data.email,phoneNumber:a.data.mobile_no,id:a.data.id,has_identity_document:a.data.has_identity_document,has_fee_challan:a.data.has_fee_challan,applicationStatus:a.data.application_status,assignedGroup:a.data.assigned_group,applicationassignment:H(a.data.applicationassignment),applicationdocument:a.data.applicationdocument,field_responses:a.data.field_responses,manual_fields:a.data.manual_fields,psid_tracking:a.data.psid_tracking};if(J(r),a.data.businessprofile){if(a.data.businessprofile.entity_type==="Company"){const w={applicant:a.data.id,businessName:a.data.businessprofile.business_name,district:a.data.businessprofile.district,tehsil:a.data.businessprofile.tehsil,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};X(w)}{const w={applicant:a.data.id,name:a.data.businessprofile.name,district:a.data.businessprofile.district_name,tehsil:a.data.businessprofile.tehsil_name,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};ae(w)}G({businessEntityType:a.data.businessprofile.entity_type})}if(Y({licenseType:a.data.registration_for}),a.data.producer&&a.data.registration_for==="Producer"){const w={tracking_number:a.data.producer.tracking_number||"",registration_required_for:a.data.producer.registration_required_for||[],registration_required_for_other:a.data.producer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.producer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.producer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.producer.packaging_items||[],number_of_machines:a.data.producer.number_of_machines||"",total_capacity_value:((d=a.data.producer.total_capacity_value)==null?void 0:d.toString())||"",date_of_setting_up:a.data.producer.date_of_setting_up||"",total_waste_generated_value:((S=a.data.producer.total_waste_generated_value)==null?void 0:S.toString())||"",has_waste_storage_capacity:a.data.producer.has_waste_storage_capacity||"",waste_disposal_provision:a.data.producer.waste_disposal_provision||"",applicant:a.data.producer.applicant||"",totalFeeAmount:a.data.applicantfees?a.data.applicantfees.reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0,verifiedFeeAmount:a.data.applicantfees?a.data.applicantfees.filter(u=>u.is_settled).reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0};U(w)}if(a.data.consumer&&a.data.registration_for==="Consumer"){const w={registration_required_for:a.data.consumer.registration_required_for||[],registration_required_for_other:a.data.consumer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.consumer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.consumer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.consumer.packaging_items||[],consumption:a.data.consumer.consumption||"",provision_waste_disposal_bins:a.data.consumer.provision_waste_disposal_bins||"No",no_of_waste_disposible_bins:a.data.consumer.no_of_waste_disposable_bins||"",segregated_plastics_handed_over_to_registered_recyclers:a.data.consumer.segregated_plastics_handed_over_to_registered_recyclers||"No",applicant:a.data.consumer.applicant||"",totalFeeAmount:a.data.applicantfees?a.data.applicantfees.reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0,verifiedFeeAmount:a.data.applicantfees?a.data.applicantfees.filter(u=>u.is_settled).reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0};W(w)}if(a.data.recycler&&a.data.registration_for==="Recycler"){const w={selectedCategories:a.data.recycler.selected_categories||[],plastic_waste_acquired_through:a.data.recycler.plastic_waste_acquired_through||[],has_adequate_pollution_control_systems:a.data.recycler.has_adequate_pollution_control_systems||"No",pollution_control_details:a.data.recycler.pollution_control_details||"",applicant:a.data.recycler.applicant||"",registration_required_for_other_other_text:a.data.recycler.registration_required_for_other_other_text||"",totalFeeAmount:a.data.applicantfees?a.data.applicantfees.reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0,verifiedFeeAmount:a.data.applicantfees?a.data.applicantfees.filter(u=>u.is_settled).reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0};z(w)}if(a.data.collector&&a.data.registration_for==="Collector"){const w={registration_required_for:a.data.collector.registration_required_for||[],registration_required_for_other:a.data.collector.registration_required_for_other||[],registration_required_for_other_other_text:a.data.collector.registration_required_for_other_other_text||"",selectedCategoriesCollector:a.data.collector.selected_categories||[],total_capacity_value_collector:a.data.collector.total_capacity_value||"",number_of_vehicles:a.data.collector.number_of_vehicles||"",number_of_persons:a.data.collector.number_of_persons||"",applicant:a.data.collector.applicant||"",totalFeeAmount:a.data.applicantfees?a.data.applicantfees.reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0,verifiedFeeAmount:a.data.applicantfees?a.data.applicantfees.filter(u=>u.is_settled).reduce((u,b)=>u+parseFloat(b.fee_amount||0),0):0};oe(w)}a.data.application_status==="Fee Challan"&&v(4)}).catch(a=>{console.error("Error:",a)})},V=()=>{D(!1),Ie.push(e.jsx(qe,{type:"success",children:"Customer discard!"}),{placement:"top-center"}),h("/concepts/customers/customer-list")},K=()=>{D(!0)},Q=()=>{N(!0)},R=()=>{D(!1),N(!1)},I=()=>{N(!1),$()},E=async()=>{if(!t.readOnly){console.log("readOnly",t.readOnly);const s=Object.entries(t.fieldResponses).map(([a,r])=>({field_key:a,response:r.response,comment:r.comment,applicant:t.id}));try{const a=await T.post("/pmc/field-responses/",s,{headers:{"Content-Type":"application/json"}});console.log("Responses submitted:",a.data)}catch(a){console.error("Error submitting responses:",a),h("/error")}}},ce=async()=>{const{manualFields:s}=t,a=new FormData;if(a.append("applicant",t.id),a.append("latitude",s.latitude||""),a.append("longitude",s.longitude||""),a.append("list_of_products",s.list_of_products||""),a.append("list_of_by_products",s.list_of_by_products||""),a.append("raw_material_imported",s.raw_material_imported||""),a.append("seller_name_if_raw_material_bought",s.seller_name_if_raw_material_bought||""),a.append("self_import_details",s.self_import_details||""),a.append("raw_material_utilized",s.raw_material_utilized||""),a.append("compliance_thickness_75",s.compliance_thickness_75||""),a.append("valid_consent_permit_building_bylaws",s.valid_consent_permit_building_bylaws||""),a.append("stockist_distributor_list",s.stockist_distributor_list||""),a.append("procurement_per_day",s.procurement_per_day||""),a.append("no_of_workers",s.no_of_workers||""),a.append("labor_dept_registration_status",s.labor_dept_registration_status||""),a.append("occupational_safety_and_health_facilities",s.occupational_safety_and_health_facilities||""),a.append("adverse_environmental_impacts",s.adverse_environmental_impacts||""),s.consent_permit_file){const r=new FormData;r.append("document",s.consent_permit_file),r.append("document_description","Consent Permit"),r.append("applicant",t.id.toString());try{const d=await T.post("/pmc/applicant-documents/",r,{headers:{"Content-Type":"multipart/form-data"}});console.log("Post successful:",d.data)}catch(d){console.error("Error in POST request:",d.response||d.message),h("/error")}}if(s.flow_diagram_file){const r=new FormData;r.append("document",s.flow_diagram_file),r.append("document_description","Flow Diagram"),r.append("applicant",t.id.toString());try{const d=await T.post("/pmc/applicant-documents/",r,{headers:{"Content-Type":"multipart/form-data"}});console.log("Post successful:",d.data)}catch(d){console.error("Error in POST request:",d.response||d.message),h("/error")}}if(s.action_plan_file){const r=new FormData;r.append("document",s.action_plan_file),r.append("document_description","Action Plan"),r.append("applicant",t.id.toString());try{const d=await T.post("/pmc/applicant-documents/",r,{headers:{"Content-Type":"multipart/form-data"}});console.log("Post successful:",d.data)}catch(d){console.error("Error in POST request:",d.response||d.message),h("/error")}}if(s.id)try{const r=await T.patch(`/pmc/manual-fields/${s.id}/`,a,{headers:{"Content-Type":"multipart/form-data"}});alert("Data is saved!"),console.log("PATCH success:",r.data)}catch(r){console.error("Error PATCHing manual fields:",r),h("/error")}else try{const r=await T.post("/pmc/manual-fields/",a,{headers:{"Content-Type":"multipart/form-data"}});console.log("POST success:",r.data),alert("Data is saved!")}catch(r){console.error("Error POSTing manual fields:",r),h("/error")}},de=async()=>{if(q(!0),t.assignedGroup2!==""&&t.assignedGroup2!==void 0){const s=new FormData;if(s.append("assigned_group",t.assignedGroup2),s.append("id",t.id.toString()),t.id>0)try{const r=await T.patch(`/pmc/applicant-detail/${t.id}/`,s,{headers:{"Content-Type":"multipart/form-data"}});h("/home")}catch(r){console.error("Error in POST request:",r.response||r.message)}const a=new FormData;a.append("applicant",t.id.toString()),a.append("assigned_group",t.assignedGroup2),a.append("remarks",t.remarks),console.log(t.remarks),await T.post("/pmc/application-assignment/",a,{headers:{"Content-Type":"multipart/form-data"}})}E(),ce(),q(!1)},{applicantDetail:t,updateApplicantDetail:J,resetApplicantDetail:L,businessDetail:l,updateBusinessDetail:X,resetBusinessDetail:Z,businessDetailIndividual:ee,updateBusinessDetailIndividual:ae,resetBusinessDetailIndividual:te,businessEntity:g,updateBusinessEntity:G,resetBusinessEntity:se,resetAll:ie,completedSections:pe,getValuesFromStateBusinessEntity:F,getValuesFromLicenseDetail:re,updateLicenseDetail:Y,updateLicenseDetailCollector:oe,updateLicenseDetailConsumer:W,updateLicenseDetailProducer:U,updateLicenseDetailRecycler:z,resetLicenseDetail:ne,resetLicenseDetailProducer:_}=we();F(),re();const o=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],i=f(t.assignedGroup);console.log("assignedGroup:",t.assignedGroup),console.log("groupList",i);function f(s){console.log(s);const a=o.indexOf(s);return o.slice(Math.max(0,a-1),a+2).map(d=>({value:d,label:d}))}return e.jsxs(e.Fragment,{children:[e.jsx(Qe,{groupList:i,children:e.jsx(Ae,{children:e.jsxs("div",{className:"flex items-center justify-between px-8",children:[e.jsx("span",{}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error bg-transparent",icon:e.jsx(Me,{}),onClick:K,children:"Discard"}),e.jsx(le,{icon:e.jsx(Re,{}),className:"ltr:mr-3 rtl:ml-3",variant:"solid",type:"button",loading:p,disabled:O===0,onClick:Q,children:"Back"}),e.jsx(le,{icon:e.jsx(Ee,{}),variant:"solid",type:"button",onClick:de,loading:p,children:"Save"})]})]})})}),e.jsx(ye,{isOpen:M,type:"danger",title:"Discard changes",onClose:R,onRequestClose:R,onCancel:R,onConfirm:V,children:e.jsx("p",{children:"Are you sure you want discard this?"})}),e.jsx(ye,{isOpen:C,type:"danger",title:"Go Back",onClose:R,onRequestClose:R,onCancel:R,onConfirm:I,children:e.jsx("p",{children:"There are unsaved changes on this step, Are you sure you want to go back step?"})})]})};export{na as default};
