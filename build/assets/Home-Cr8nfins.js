import{r as c,j as n,A as x}from"./index-C2NIcGrY.js";import{M as R}from"./index.esm-CWGT0Azg.js";import"./TextField-BXfGDpel.js";import"./FormControlLabel-Blwxge0y.js";import"./Autocomplete-xdKjWvvD.js";import"./index-CaSDcvVF.js";const b=(p,d="",a={},i=[])=>{for(const[f,o]of Object.entries(p||{})){const h=d?`${d}.${f}`:f;i.some(m=>h.startsWith(m))||o&&typeof o=="object"&&!Array.isArray(o)||(a[h]=o??"N/A")}return a},I=p=>p.map(d=>{const a=b(d);return Object.keys(a).forEach(i=>{(a[i]===void 0||a[i]===null)&&(a[i]="N/A")}),a}),$=()=>{const[p,d]=c.useState([]),[a,i]=c.useState([]),[f,o]=c.useState([]),[h,m]=c.useState(0),[g,w]=c.useState(null),[O,A]=c.useState({});console.log(g);const L=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],C={APPLICANT:"Applicant",LSO:"LSO",LSM:"LSM",DO:"DO",LSM2:"LSM",TL:"TL",DEO:"DEO","Download License":"Download License"},_=(e,s)=>{const j=["id","first_name","last_name","cnic","mobile_no","application_status","tracking_number","assigned_group","registration_for"],u=I(e),S=u[0],r=[...Object.keys(S).filter(t=>j.includes(t)).map(t=>({accessorKey:t,header:t.replace(/_/g," ").replace(/\b\w/g,l=>l.toUpperCase()),size:200,Cell:({cell:l,row:y})=>n.jsx("span",{style:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>{const D=y.original.id;console.log(`Clicked ${t}:`,l.getValue()),console.log(`Navigating with ID: ${D}`),window.location.href=s?`/spuid-review/${D}`:`/spuid-signup/${D}`},children:l.getValue()||"-"})}))];return{flattenedData:u,columns:r}};return c.useEffect(()=>{(async()=>{try{const s=await x.get("/pmc/user-groups/",{headers:{"Content-Type":"multipart/form-data"}});o(s.data);const u=(await x.get("/pmc/applicant-detail/",{headers:{"Content-Type":"multipart/form-data"}})).data;if(Array.isArray(u)&&u.length>0){const r=_(u,s.data.length>0);d(r.flattenedData),i(r.columns),console.log("Flattened Data:",r.flattenedData);const t=r.flattenedData[r.flattenedData.length-1];if(console.log("Last Row:",t),t&&t.id){w(t.id),console.log("Last Row ID:",t.id);const l=L.indexOf(t.assigned_group);l!==-1&&m(l)}}const S=await x.get("/pmc/fetch-statistics-view-groups/",{headers:{"Content-Type":"multipart/form-data"}});A(S.data)}catch(s){console.error("Error fetching data:",s)}})()},[]),console.log("selectedRowId:",g),console.log(g),n.jsxs("div",{children:[n.jsx("div",{className:"tiles-container",children:Object.entries(O).map(([e,s])=>n.jsxs("div",{className:"tile",children:[n.jsx("h3",{children:C[e]||e})," ",n.jsx("p",{children:s})]},e))}),n.jsx(R,{columns:[{accessorKey:"selected",header:"Select",size:50,Cell:({row:e})=>n.jsx("input",{type:"radio",name:"rowSelect",onChange:()=>{w(e.original.id);const s=L.indexOf(e.original.assigned_group);s!==-1&&m(s)},checked:String(g)===String(e.original.id)})},...a],data:p.map(e=>({...e,assigned_group_title:C[e.assigned_group]||e.assigned_group})),getRowId:e=>e.id,initialState:{showColumnFilters:!1},defaultColumn:{maxSize:420,minSize:1,size:100},enableColumnResizing:!0,columnResizeMode:"onChange"},g)]})};export{$ as default};
