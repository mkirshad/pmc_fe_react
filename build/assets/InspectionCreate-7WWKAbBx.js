import{r as C,j as u,Z as Se,A as $t,l as qe,i as Qt,a3 as Et,W as Zt,a0 as zt}from"./index-oDwQGYEA.js";import{B as ct}from"./Button-CkHimBRY.js";import{t as Jt,N as en}from"./toast-Crnq7uzi.js";import{u as kt,b as ae,a as A,C as L,F as tn}from"./index.esm-BwKut1eI.js";import{B as nn}from"./BottomStickyBar-D8srE-Mm.js";import{C as rn}from"./Card-DyjZqYue.js";import{I as X}from"./Input-Zn4GrLhU.js";import{S as ut}from"./Select-D8ijT30g.js";import{C as We}from"./index-CEUpcpV_.js";/* empty css           */import{g as an,p as sn,h as on,s as cn,i as un,R as ln,a as jt,b as Rt,j as lt,k as dt,l as ft,E as mt,m as te,n as Qe,d as at,P as it,o as Ge,q as ge,r as ne,t as gt,u as J,v as He,w as dn,x as fn,y as mn,z as st,A as gn,B as hn,D as vn,G as pn,H as yn,f as Ze,S as xn,C as bn,c as _n,F as wn,M as Sn,V as Cn,T as Dn,O as Pn,I as Mn}from"./OSM-xj16LtVI.js";import{A as Fn,C as Tn}from"./Autocomplete-Dg-hWFz0.js";import{T as Nn}from"./TextField-r5TNIsmD.js";import{t as En,z as D}from"./index-EAOVwyn9.js";import{C as kn}from"./ConfirmDialog-D-8ZrK2G.js";import{f as jn}from"./index-DJVifhAU.js";import{B as Rn}from"./index-CDrWRDXV.js";import{u as On}from"./useInspectionStore-CxpNYduB.js";import"./classNames-Dv-7hrnu.js";import"./StatusIcon-DcYaimhl.js";import"./isNil-DegOKdHG.js";import"./CloseButton-BrP5HmHa.js";import"./index-DWjkHJka.js";import"./setPrototypeOf-C3V6guyq.js";import"./emotion-element-f0de968e.browser.esm-DX8E_o2N.js";import"./assertThisInitialized-Cle6jci9.js";import"./floating-ui.dom-CrKScG7J.js";import"./_getPrototype-CdXHqSvn.js";import"./DefaultPropsProvider-CGomaEqC.js";import"./Modal-CFzYjZPq.js";import"./index-BMmgzzjV.js";import"./index-CFuoc-5k.js";import"./index-BhxA62Jt.js";const ht=0,Ne=1,vt=[0,0,0,0],Ce=[],ze={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class Je extends vn{constructor(e,n,r){super(e),this.features=n,this.mapBrowserEvent=r}}class In extends an{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:sn,this.defaultDeleteCondition_=function(r){return on(r)&&cn(r)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:un,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new ln,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new jt({source:new Rt({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:An(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let n;if(e.features?n=e.features:e.source&&(this.source_=e.source,n=new lt(this.source_.getFeatures()),this.source_.addEventListener(dt.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(dt.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!n)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=n,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(ft.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(ft.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const n=e.getGeometry();if(n){const a=this.SEGMENT_WRITERS_[n.getType()];a&&a(e,n)}const r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(r.getCoordinateFromPixel(this.lastPixel_)),e.addEventListener(mt.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,n){if(!this.featuresBeingModified_){this.featuresBeingModified_=new lt;const r=this.featuresBeingModified_.getArray();for(let a=0,i=n.length;a<i;++a){const s=n[a].feature;s&&!r.includes(s)&&this.featuresBeingModified_.push(s)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Je(ze.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(mt.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const n=this.rBush_,r=[];n.forEach(function(a){e===a.feature&&r.push(a)});for(let a=r.length-1;a>=0;--a){const i=r[a];for(let s=this.dragSegments_.length-1;s>=0;--s)this.dragSegments_[s][0]===i&&this.dragSegments_.splice(s,1);n.remove(i)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const n=e.target;this.removeFeature_(n),this.addFeature_(n)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,n){const r=n.getCoordinates(),a={feature:e,geometry:n,segment:[r,r]};this.rBush_.insert(n.getExtent(),a)}writeMultiPointGeometry_(e,n){const r=n.getCoordinates();for(let a=0,i=r.length;a<i;++a){const s=r[a],o={feature:e,geometry:n,depth:[a],index:a,segment:[s,s]};this.rBush_.insert(n.getExtent(),o)}}writeLineStringGeometry_(e,n){const r=n.getCoordinates();for(let a=0,i=r.length-1;a<i;++a){const s=r.slice(a,a+2),o={feature:e,geometry:n,index:a,segment:s};this.rBush_.insert(te(s),o)}}writeMultiLineStringGeometry_(e,n){const r=n.getCoordinates();for(let a=0,i=r.length;a<i;++a){const s=r[a];for(let o=0,l=s.length-1;o<l;++o){const f=s.slice(o,o+2),d={feature:e,geometry:n,depth:[a],index:o,segment:f};this.rBush_.insert(te(f),d)}}}writePolygonGeometry_(e,n){const r=n.getCoordinates();for(let a=0,i=r.length;a<i;++a){const s=r[a];for(let o=0,l=s.length-1;o<l;++o){const f=s.slice(o,o+2),d={feature:e,geometry:n,depth:[a],index:o,segment:f};this.rBush_.insert(te(f),d)}}}writeMultiPolygonGeometry_(e,n){const r=n.getCoordinates();for(let a=0,i=r.length;a<i;++a){const s=r[a];for(let o=0,l=s.length;o<l;++o){const f=s[o];for(let d=0,v=f.length-1;d<v;++d){const h=f.slice(d,d+2),m={feature:e,geometry:n,depth:[o,a],index:d,segment:h};this.rBush_.insert(te(h),m)}}}}writeCircleGeometry_(e,n){const r=n.getCenter(),a={feature:e,geometry:n,index:ht,segment:[r,r]},i={feature:e,geometry:n,index:Ne,segment:[r,r]},s=[a,i];a.featureSegments=s,i.featureSegments=s,this.rBush_.insert(Qe(r),a);let o=n;this.rBush_.insert(o.getExtent(),i)}writeGeometryCollectionGeometry_(e,n){const r=n.getGeometriesArray();for(let a=0;a<r.length;++a){const i=r[a],s=this.SEGMENT_WRITERS_[i.getType()];s(e,i)}}createOrUpdateVertexFeature_(e,n,r,a){let i=this.vertexFeature_;return i?i.getGeometry().setCoordinates(e):(i=new at(new it(e)),this.vertexFeature_=i,this.overlay_.getSource().addFeature(i)),i.set("features",n),i.set("geometries",r),i.set("existing",a),i}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let n;return!e.map.getView().getInteracting()&&e.type==Ge.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=Ge.SINGLECLICK||!this.ignoreNextSingleClick_?n=this.removePoint():n=!0),e.type==Ge.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!n}findInsertVerticesAndUpdateDragSegments_(e){this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const n=this.vertexFeature_;if(!n)return;this.getMap().getView().getProjection();const r=[],a=n.getGeometry().getCoordinates(),i=te([a]),s=this.rBush_.getInExtent(i),o={};s.sort(Bn);for(let l=0,f=s.length;l<f;++l){const d=s[l],v=d.segment;let h=ge(d.geometry);const m=d.depth;if(m&&(h+="-"+m.join("-")),o[h]||(o[h]=new Array(2)),d.geometry.getType()==="Circle"&&d.index===Ne){const g=yt(e,d);ne(g,a)&&!o[h][0]&&(this.dragSegments_.push([d,0]),o[h][0]=d);continue}if(ne(v[0],a)&&!o[h][0]){this.dragSegments_.push([d,0]),o[h][0]=d;continue}if(ne(v[1],a)&&!o[h][1]){if(o[h][0]&&o[h][0].index===0){let g=d.geometry.getCoordinates();switch(d.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":g=g[m[1]];case"Polygon":if(d.index!==g[m[0]].length-2)continue;break}}this.dragSegments_.push([d,1]),o[h][1]=d;continue}ge(v)in this.vertexSegments_&&!o[h][0]&&!o[h][1]&&r.push(d)}return r}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([i])=>i));const n=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],a=[];for(let i=0,s=this.dragSegments_.length;i<s;++i){const o=this.dragSegments_[i],l=o[0],f=l.feature;r.includes(f)||r.push(f);const d=l.geometry;a.includes(d)||a.push(d);const v=l.depth;let h;const m=l.segment,g=o[1];for(;n.length<d.getStride();)n.push(m[g][n.length]);switch(d.getType()){case"Point":h=n,m[0]=n,m[1]=n;break;case"MultiPoint":h=d.getCoordinates(),h[l.index]=n,m[0]=n,m[1]=n;break;case"LineString":h=d.getCoordinates(),h[l.index+g]=n,m[g]=n;break;case"MultiLineString":h=d.getCoordinates(),h[v[0]][l.index+g]=n,m[g]=n;break;case"Polygon":h=d.getCoordinates(),h[v[0]][l.index+g]=n,m[g]=n;break;case"MultiPolygon":h=d.getCoordinates(),h[v[1]][v[0]][l.index+g]=n,m[g]=n;break;case"Circle":const x=d;if(m[0]=n,m[1]=n,l.index===ht)this.changingFeature_=!0,x.setCenter(n),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let w=gt(J(x.getCenter()),J(n));x.setRadius(w),this.changingFeature_=!1}break}h&&this.setGeometryCoordinates_(d,h)}this.createOrUpdateVertexFeature_(n,r,a,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const n=e.coordinate,r=this.findInsertVerticesAndUpdateDragSegments_(n);if(r!=null&&r.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,r),this.vertexFeature_)){const a=this.vertexFeature_.getGeometry().getCoordinates();for(let i=r.length-1;i>=0;--i)this.insertVertex_(r[i],a);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let n=this.dragSegments_.length-1;n>=0;--n){const r=this.dragSegments_[n][0],a=r.geometry;if(a.getType()==="Circle"){const i=a,s=i.getCenter(),o=r.featureSegments[0],l=r.featureSegments[1];o.segment[0]=s,o.segment[1]=s,l.segment[0]=s,l.segment[1]=s,this.rBush_.update(Qe(s),o);let f=i;this.rBush_.update(f.getExtent(),l)}else this.rBush_.update(te(r.segment),r)}return this.featuresBeingModified_&&(this.dispatchEvent(new Je(ze.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.coordinate)}handlePointerAtPixel_(e){const n=this.getMap(),r=n.getPixelFromCoordinate(e);n.getView().getProjection();const a=function(o,l){return pt(e,o)-pt(e,l)};let i,s;if(this.hitDetection_){const o=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;n.forEachFeatureAtPixel(r,(l,f,d)=>{d&&d.getType()==="Point"&&(d=new it(He(d.getCoordinates())));const v=d||l.getGeometry();if(v&&v.getType()==="Point"&&l instanceof at&&this.features_.getArray().includes(l)){s=v;const h=l.getGeometry().getFlatCoordinates().slice(0,2);i=[{feature:l,geometry:s,segment:[h,h]}]}return!0},{layerFilter:o})}if(!i){const o=dn(Qe(e,vt)),l=n.getView().getResolution()*this.pixelTolerance_,f=fn(mn(o,l,vt));i=this.rBush_.getInExtent(f)}if(i&&i.length>0){const o=i.sort(a)[0],l=o.segment;let f=yt(e,o);const d=n.getPixelFromCoordinate(f);let v=gt(r,d);if(s||v<=this.pixelTolerance_){const h={};if(h[ge(l)]=!0,this.snapToPointer_||(this.delta_[0]=f[0]-e[0],this.delta_[1]=f[1]-e[1]),o.geometry.getType()==="Circle"&&o.index===Ne)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(f,[o.feature],[o.geometry],this.snappedToVertex_);else{const m=n.getPixelFromCoordinate(l[0]),g=n.getPixelFromCoordinate(l[1]),x=st(d,m),w=st(d,g);if(v=Math.sqrt(Math.min(x,w)),this.snappedToVertex_=v<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(f=x>w?l[1]:l[0]),this.createOrUpdateVertexFeature_(f,[o.feature],[o.geometry],this.snappedToVertex_);const p={};p[ge(o.geometry)]=!0;for(let N=1,k=i.length;N<k;++N){const U=i[N].segment;if(ne(l[0],U[0])&&ne(l[1],U[1])||ne(l[0],U[1])&&ne(l[1],U[0])){const q=ge(i[N].geometry);q in p||(p[q]=!0,h[ge(U)]=!0)}else break}}this.vertexSegments_=h;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,n){const r=e.segment,a=e.feature,i=e.geometry,s=e.depth,o=e.index;let l;for(;n.length<i.getStride();)n.push(0);switch(i.getType()){case"MultiLineString":l=i.getCoordinates(),l[s[0]].splice(o+1,0,n);break;case"Polygon":l=i.getCoordinates(),l[s[0]].splice(o+1,0,n);break;case"MultiPolygon":l=i.getCoordinates(),l[s[1]][s[0]].splice(o+1,0,n);break;case"LineString":l=i.getCoordinates(),l.splice(o+1,0,n);break;default:return!1}this.setGeometryCoordinates_(i,l);const f=this.rBush_;f.remove(e),this.updateSegmentIndices_(i,o,s,1);const d={segment:[r[0],n],feature:a,geometry:i,depth:s,index:o};f.insert(te(d.segment),d),this.dragSegments_.push([d,1]);const v={segment:[n,r[1]],feature:a,geometry:i,depth:s,index:o+1};return f.insert(te(v.segment),v),this.dragSegments_.push([v,0]),!0}updatePointer_(e){var n;return e&&this.findInsertVerticesAndUpdateDragSegments_(e),(n=this.vertexFeature_)==null?void 0:n.getGeometry().getCoordinates()}getPoint(){var n;const e=(n=this.vertexFeature_)==null?void 0:n.getGeometry().getCoordinates();return e?He(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(r=>r.getType()==="Circle"||r.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(te([e])).some(({segment:r})=>ne(r[0],e)||ne(r[1],e))}removePoint(e){if(e&&(e=J(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=Ge.POINTERDRAG){const n=this.lastPointerEvent_;this.willModifyFeatures_(n,this.dragSegments_.map(([a])=>a));const r=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Je(ze.MODIFYEND,this.featuresBeingModified_,n)),this.featuresBeingModified_=null,r}return!1}removeVertex_(){const e=this.dragSegments_,n={};let r=!1,a,i,s,o,l,f,d,v,h,m,g;for(l=e.length-1;l>=0;--l)s=e[l],m=s[0],g=ge(m.feature),m.depth&&(g+="-"+m.depth.join("-")),g in n||(n[g]={}),s[1]===0?(n[g].right=m,n[g].index=m.index):s[1]==1&&(n[g].left=m,n[g].index=m.index+1);for(g in n){switch(h=n[g].right,d=n[g].left,f=n[g].index,v=f-1,d!==void 0?m=d:m=h,v<0&&(v=0),o=m.geometry,i=o.getCoordinates(),a=i,r=!1,o.getType()){case"MultiLineString":i[m.depth[0]].length>2&&(i[m.depth[0]].splice(f,1),r=!0);break;case"LineString":i.length>2&&(i.splice(f,1),r=!0);break;case"MultiPolygon":a=a[m.depth[1]];case"Polygon":a=a[m.depth[0]],a.length>4&&(f==a.length-1&&(f=0),a.splice(f,1),r=!0,f===0&&(a.pop(),a.push(a[0]),v=a.length-1));break}if(r){this.setGeometryCoordinates_(o,i);const x=[];if(d!==void 0&&(this.rBush_.remove(d),x.push(d.segment[0])),h!==void 0&&(this.rBush_.remove(h),x.push(h.segment[1])),d!==void 0&&h!==void 0){const w={depth:m.depth,feature:m.feature,geometry:m.geometry,index:v,segment:x};this.rBush_.insert(te(w.segment),w)}this.updateSegmentIndices_(o,f,m.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return r}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(r=>r.getType()==="Circle"||r.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(te([e])).some(({segment:r})=>!(ne(r[0],e)||ne(r[1],e)))}insertPoint(e){var a;const n=e?J(e,this.getMap().getView().getProjection()):(a=this.vertexFeature_)==null?void 0:a.getGeometry().getCoordinates();return n?this.findInsertVerticesAndUpdateDragSegments_(n).reduce((i,s)=>i||this.insertVertex_(s,n),!1):!1}setGeometryCoordinates_(e,n){this.changingFeature_=!0,e.setCoordinates(n),this.changingFeature_=!1}updateSegmentIndices_(e,n,r,a){this.rBush_.forEachInExtent(e.getExtent(),function(i){i.geometry===e&&(r===void 0||i.depth===void 0||gn(i.depth,r))&&i.index>n&&(i.index+=a)})}}function Bn(t,e){return t.index-e.index}function pt(t,e,n){const r=e.geometry;if(r.getType()==="Circle"){let i=r;if(e.index===Ne){const s=st(i.getCenter(),J(t)),o=Math.sqrt(s)-i.getRadius();return o*o}}const a=J(t);return Ce[0]=J(e.segment[0]),Ce[1]=J(e.segment[1]),yn(a,Ce)}function yt(t,e,n){const r=e.geometry;if(r.getType()==="Circle"&&e.index===Ne)return He(r.getClosestPoint(J(t)));const a=J(t);return Ce[0]=J(e.segment[0]),Ce[1]=J(e.segment[1]),He(pn(a,Ce))}function An(){const t=hn();return function(e,n){return t.Point}}const Ln=({onLocationSelect:t,savedLocation:e,isEditing:n})=>{const r=C.useRef(null),[a,i]=C.useState(null),[s,o]=C.useState(null),[l,f]=C.useState({lat:null,lng:null});C.useEffect(()=>{const v=new Rt,h=e&&n?Ze([e.lng,e.lat]):Ze([74.3436,31.5497]),m=new at({geometry:new it(h)});m.setStyle(new xn({image:new bn({radius:7,fill:new wn({color:"red"}),stroke:new _n({color:"white",width:2})})})),v.addFeature(m),o(m);const g=new jt({source:v}),x=new Sn({target:r.current,layers:[new Dn({source:new Pn}),g],view:new Cn({center:h,zoom:12})});if(i(x),!n){d(x,m);const w=new In({source:v});x.addInteraction(w),w.on("modifyend",p=>{const N=p.features.item(0).getGeometry().getCoordinates(),k=Mn(N);f({lat:k[1],lng:k[0]}),t({lat:k[1],lng:k[0]})})}return()=>x.setTarget(null)},[n,e]);const d=(v,h)=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(m=>{const g=Ze([m.coords.longitude,m.coords.latitude]);h.getGeometry().setCoordinates(g),v.getView().setCenter(g),v.getView().setZoom(15),f({lat:m.coords.latitude,lng:m.coords.longitude}),t({lat:m.coords.latitude,lng:m.coords.longitude})},m=>console.error("Geolocation error:",m),{enableHighAccuracy:!0})};return u.jsxs("div",{children:[u.jsx("div",{ref:r,style:{height:"600px",width:"100%"}}),!n&&s&&a&&u.jsx("button",{type:"button",onClick:()=>d(a,s),style:{marginTop:"10px",padding:"10px",backgroundColor:"#007BFF",color:"#fff",border:"none",cursor:"pointer",borderRadius:"5px"},children:"📍 Go to Current Location"})]})};function Ot(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}var Ee;(function(t){t.event="event",t.props="prop"})(Ee||(Ee={}));function de(){}function Vn(t){var e,n=void 0;return function(){for(var r=[],a=arguments.length;a--;)r[a]=arguments[a];return e&&r.length===e.length&&r.every(function(i,s){return i===e[s]})||(e=r,n=t.apply(void 0,r)),n}}function ke(t){return!!(t||"").match(/\d/)}function De(t){return t==null}function Wn(t){return typeof t=="number"&&isNaN(t)}function It(t){return De(t)||Wn(t)||typeof t=="number"&&!isFinite(t)}function Bt(t){return t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")}function Gn(t){switch(t){case"lakh":return/(\d+?)(?=(\d\d)+(\d)(?!\d))(\.\d+)?/g;case"wan":return/(\d)(?=(\d{4})+(?!\d))/g;case"thousand":default:return/(\d)(?=(\d{3})+(?!\d))/g}}function Yn(t,e,n){var r=Gn(n),a=t.search(/[1-9]/);return a=a===-1?t.length:a,t.substring(0,a)+t.substring(a,t.length).replace(r,"$1"+e)}function Un(t){var e=C.useRef(t);e.current=t;var n=C.useRef(function(){for(var r=[],a=arguments.length;a--;)r[a]=arguments[a];return e.current.apply(e,r)});return n.current}function ot(t,e){e===void 0&&(e=!0);var n=t[0]==="-",r=n&&e;t=t.replace("-","");var a=t.split("."),i=a[0],s=a[1]||"";return{beforeDecimal:i,afterDecimal:s,hasNegation:n,addNegation:r}}function qn(t){if(!t)return t;var e=t[0]==="-";e&&(t=t.substring(1,t.length));var n=t.split("."),r=n[0].replace(/^0+/,"")||"0",a=n[1]||"";return(e?"-":"")+r+(a?"."+a:"")}function At(t,e,n){for(var r="",a=n?"0":"",i=0;i<=e-1;i++)r+=t[i]||a;return r}function xt(t,e){return Array(e+1).join(t)}function Lt(t){var e=t+"",n=e[0]==="-"?"-":"";n&&(e=e.substring(1));var r=e.split(/[eE]/g),a=r[0],i=r[1];if(i=Number(i),!i)return n+a;a=a.replace(".","");var s=1+i,o=a.length;return s<0?a="0."+xt("0",Math.abs(s))+a:s>=o?a=a+xt("0",s-o):a=(a.substring(0,s)||"0")+"."+a.substring(s),n+a}function bt(t,e,n){if(["","-"].indexOf(t)!==-1)return t;var r=(t.indexOf(".")!==-1||n)&&e,a=ot(t),i=a.beforeDecimal,s=a.afterDecimal,o=a.hasNegation,l=parseFloat("0."+(s||"0")),f=s.length<=e?"0."+s:l.toFixed(e),d=f.split("."),v=i;i&&Number(d[0])&&(v=i.split("").reverse().reduce(function(x,w,p){return x.length>p?(Number(x[0])+Number(w)).toString()+x.substring(1,x.length):w+x},d[0]));var h=At(d[1]||"",e,n),m=o?"-":"",g=r?".":"";return""+m+v+g+h}function ve(t,e){if(t.value=t.value,t!==null){if(t.createTextRange){var n=t.createTextRange();return n.move("character",e),n.select(),!0}return t.selectionStart||t.selectionStart===0?(t.focus(),t.setSelectionRange(e,e),!0):(t.focus(),!1)}}var Vt=Vn(function(t,e){for(var n=0,r=0,a=t.length,i=e.length;t[n]===e[n]&&n<a;)n++;for(;t[a-1-r]===e[i-1-r]&&i-r>n&&a-r>n;)r++;return{from:{start:n,end:a-r},to:{start:n,end:i-r}}}),Hn=function(t,e){var n=Math.min(t.selectionStart,e);return{from:{start:n,end:t.selectionEnd},to:{start:n,end:e}}};function Kn(t,e,n){return Math.min(Math.max(t,e),n)}function et(t){return Math.max(t.selectionStart,t.selectionEnd)}function Xn(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function $n(t){return{from:{start:0,end:0},to:{start:0,end:t.length},lastValue:""}}function Qn(t){var e=t.currentValue,n=t.formattedValue,r=t.currentValueIndex,a=t.formattedValueIndex;return e[r]===n[a]}function Zn(t,e,n,r,a,i,s){s===void 0&&(s=Qn);var o=a.findIndex(function(U){return U}),l=t.slice(0,o);!e&&!n.startsWith(l)&&(e=l,n=l+n,r=r+l.length);for(var f=n.length,d=t.length,v={},h=new Array(f),m=0;m<f;m++){h[m]=-1;for(var g=0,x=d;g<x;g++){var w=s({currentValue:n,lastValue:e,formattedValue:t,currentValueIndex:m,formattedValueIndex:g});if(w&&v[g]!==!0){h[m]=g,v[g]=!0;break}}}for(var p=r;p<f&&(h[p]===-1||!i(n[p]));)p++;var N=p===f||h[p]===-1?d:h[p];for(p=r-1;p>0&&h[p]===-1;)p--;var k=p===-1||h[p]===-1?0:h[p]+1;return k>N?N:r-k<N-r?k:N}function _t(t,e,n,r){var a=t.length;if(e=Kn(e,0,a),r==="left"){for(;e>=0&&!n[e];)e--;e===-1&&(e=n.indexOf(!0))}else{for(;e<=a&&!n[e];)e++;e>a&&(e=n.lastIndexOf(!0))}return e===-1&&(e=a),e}function zn(t){for(var e=Array.from({length:t.length+1}).map(function(){return!0}),n=0,r=e.length;n<r;n++)e[n]=!!(ke(t[n])||ke(t[n-1]));return e}function Wt(t,e,n,r,a,i){i===void 0&&(i=de);var s=Un(function(g,x){var w,p;return It(g)?(p="",w=""):typeof g=="number"||x?(p=typeof g=="number"?Lt(g):g,w=r(p)):(p=a(g,void 0),w=r(p)),{formattedValue:w,numAsString:p}}),o=C.useState(function(){return s(De(t)?e:t,n)}),l=o[0],f=o[1],d=function(g,x){g.formattedValue!==l.formattedValue&&f({formattedValue:g.formattedValue,numAsString:g.value}),i(g,x)},v=t,h=n;De(t)&&(v=l.numAsString,h=!0);var m=s(v,h);return C.useMemo(function(){f(m)},[m.formattedValue]),[l,d]}function Jn(t){return t.replace(/[^0-9]/g,"")}function er(t){return t}function tr(t){var e=t.type;e===void 0&&(e="text");var n=t.displayType;n===void 0&&(n="input");var r=t.customInput,a=t.renderText,i=t.getInputRef,s=t.format;s===void 0&&(s=er);var o=t.removeFormatting;o===void 0&&(o=Jn);var l=t.defaultValue,f=t.valueIsNumericString,d=t.onValueChange,v=t.isAllowed,h=t.onChange;h===void 0&&(h=de);var m=t.onKeyDown;m===void 0&&(m=de);var g=t.onMouseUp;g===void 0&&(g=de);var x=t.onFocus;x===void 0&&(x=de);var w=t.onBlur;w===void 0&&(w=de);var p=t.value,N=t.getCaretBoundary;N===void 0&&(N=zn);var k=t.isValidInputCharacter;k===void 0&&(k=ke);var U=t.isCharacterSame,q=Ot(t,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),ie=Wt(p,l,!!f,s,o,d),ee=ie[0],T=ee.formattedValue,K=ee.numAsString,Q=ie[1],Z=C.useRef(),re=C.useRef({formattedValue:T,numAsString:K}),V=function(b,_){re.current={formattedValue:b.formattedValue,numAsString:b.value},Q(b,_)},se=C.useState(!1),fe=se[0],M=se[1],S=C.useRef(null),j=C.useRef({setCaretTimeout:null,focusTimeout:null});C.useEffect(function(){return M(!0),function(){clearTimeout(j.current.setCaretTimeout),clearTimeout(j.current.focusTimeout)}},[]);var W=s,G=function(b,_){var P=parseFloat(_);return{formattedValue:b,value:_,floatValue:isNaN(P)?void 0:P}},I=function(b,_,P){b.selectionStart===0&&b.selectionEnd===b.value.length||(ve(b,_),j.current.setCaretTimeout=setTimeout(function(){b.value===P&&b.selectionStart!==_&&ve(b,_)},0))},Y=function(b,_,P){return _t(b,_,N(b),P)},oe=function(b,_,P){var R=N(_),H=Zn(_,T,b,P,R,k,U);return H=_t(_,H,R),H},pe=function(b){var _=b.formattedValue;_===void 0&&(_="");var P=b.input,R=b.source,H=b.event,O=b.numAsString,c;if(P){var y=b.inputValue||P.value,F=et(P);P.value=_,c=oe(y,_,F),c!==void 0&&I(P,c,_)}_!==T&&V(G(_,O),{event:H,source:R})};C.useEffect(function(){var b=re.current,_=b.formattedValue,P=b.numAsString;(T!==_||K!==P)&&V(G(T,K),{event:void 0,source:Ee.props})},[T,K]);var ue=S.current?et(S.current):void 0,me=typeof window<"u"?C.useLayoutEffect:C.useEffect;me(function(){var b=S.current;if(T!==re.current.formattedValue&&b){var _=oe(re.current.formattedValue,T,ue);b.value=T,I(b,_,T)}},[T]);var ye=function(b,_,P){var R=_.target,H=Z.current?Hn(Z.current,R.selectionEnd):Vt(T,b),O=Object.assign(Object.assign({},H),{lastValue:T}),c=o(b,O),y=W(c);if(c=o(y,void 0),v&&!v(G(y,c))){var F=_.target,B=et(F),$=oe(b,T,B);return F.value=T,I(F,$,T),!1}return pe({formattedValue:y,numAsString:c,inputValue:b,event:_,source:P,input:_.target}),!0},xe=function(b,_){_===void 0&&(_=0);var P=b.selectionStart,R=b.selectionEnd;Z.current={selectionStart:P,selectionEnd:R+_}},Re=function(b){var _=b.target,P=_.value,R=ye(P,b,Ee.event);R&&h(b),Z.current=void 0},Oe=function(b){var _=b.target,P=b.key,R=_.selectionStart,H=_.selectionEnd,O=_.value;O===void 0&&(O="");var c;P==="ArrowLeft"||P==="Backspace"?c=Math.max(R-1,0):P==="ArrowRight"?c=Math.min(R+1,O.length):P==="Delete"&&(c=R);var y=0;P==="Delete"&&R===H&&(y=1);var F=P==="ArrowLeft"||P==="ArrowRight";if(c===void 0||R!==H&&!F){m(b),xe(_,y);return}var B=c;if(F){var $=P==="ArrowLeft"?"left":"right";B=Y(O,c,$),B!==c&&b.preventDefault()}else P==="Delete"&&!k(O[c])?B=Y(O,c,"right"):P==="Backspace"&&!k(O[c])&&(B=Y(O,c,"left"));B!==c&&I(_,B,O),m(b),xe(_,y)},Ie=function(b){var _=b.target,P=function(){var R=_.selectionStart,H=_.selectionEnd,O=_.value;if(O===void 0&&(O=""),R===H){var c=Y(O,R);c!==R&&I(_,c,O)}};P(),requestAnimationFrame(function(){P()}),g(b),xe(_)},Be=function(b){b.persist&&b.persist();var _=b.target,P=b.currentTarget;S.current=_,j.current.focusTimeout=setTimeout(function(){var R=_.selectionStart,H=_.selectionEnd,O=_.value;O===void 0&&(O="");var c=Y(O,R);c!==R&&!(R===0&&H===O.length)&&I(_,c,O),x(Object.assign(Object.assign({},b),{currentTarget:P}))},0)},Ae=function(b){S.current=null,clearTimeout(j.current.focusTimeout),clearTimeout(j.current.setCaretTimeout),w(b)},Le=fe&&Xn()?"numeric":void 0,Pe=Object.assign({inputMode:Le},q,{type:e,value:T,onChange:Re,onKeyDown:Oe,onMouseUp:Ie,onFocus:Be,onBlur:Ae});if(n==="text")return a?Se.createElement(Se.Fragment,null,a(T,q)||null):Se.createElement("span",Object.assign({},q,{ref:i}),T);if(r){var Ve=r;return Se.createElement(Ve,Object.assign({},Pe,{ref:i}))}return Se.createElement("input",Object.assign({},Pe,{ref:i}))}function wt(t,e){var n=e.decimalScale,r=e.fixedDecimalScale,a=e.prefix;a===void 0&&(a="");var i=e.suffix;i===void 0&&(i="");var s=e.allowNegative,o=e.thousandsGroupStyle;if(o===void 0&&(o="thousand"),t===""||t==="-")return t;var l=Xe(e),f=l.thousandSeparator,d=l.decimalSeparator,v=n!==0&&t.indexOf(".")!==-1||n&&r,h=ot(t,s),m=h.beforeDecimal,g=h.afterDecimal,x=h.addNegation;return n!==void 0&&(g=At(g,n,!!r)),f&&(m=Yn(m,f,o)),a&&(m=a+m),i&&(g=g+i),x&&(m="-"+m),t=m+(v&&d||"")+g,t}function Xe(t){var e=t.decimalSeparator;e===void 0&&(e=".");var n=t.thousandSeparator,r=t.allowedDecimalSeparators;return n===!0&&(n=","),r||(r=[e,"."]),{decimalSeparator:e,thousandSeparator:n,allowedDecimalSeparators:r}}function nr(t,e){t===void 0&&(t="");var n=new RegExp("(-)"),r=new RegExp("(-)(.)*(-)"),a=n.test(t),i=r.test(t);return t=t.replace(/-/g,""),a&&!i&&e&&(t="-"+t),t}function rr(t,e){return new RegExp("(^-)|[0-9]|"+Bt(t),"g")}function ar(t,e,n){return t===""?!0:!(e!=null&&e.match(/\d/))&&!(n!=null&&n.match(/\d/))&&typeof t=="string"&&!isNaN(Number(t))}function ir(t,e,n){var r;e===void 0&&(e=$n(t));var a=n.allowNegative,i=n.prefix;i===void 0&&(i="");var s=n.suffix;s===void 0&&(s="");var o=n.decimalScale,l=e.from,f=e.to,d=f.start,v=f.end,h=Xe(n),m=h.allowedDecimalSeparators,g=h.decimalSeparator,x=t[v]===g;if(ke(t)&&(t===i||t===s)&&e.lastValue==="")return t;if(v-d===1&&m.indexOf(t[d])!==-1){var w=o===0?"":g;t=t.substring(0,d)+w+t.substring(d+1,t.length)}var p=function(S,j,W){var G=!1,I=!1;i.startsWith("-")?G=!1:S.startsWith("--")?(G=!1,I=!0):s.startsWith("-")&&S.length===s.length?G=!1:S[0]==="-"&&(G=!0);var Y=G?1:0;return I&&(Y=2),Y&&(S=S.substring(Y),j-=Y,W-=Y),{value:S,start:j,end:W,hasNegation:G}},N=p(t,d,v),k=N.hasNegation;r=N,t=r.value,d=r.start,v=r.end;var U=p(e.lastValue,l.start,l.end),q=U.start,ie=U.end,ee=U.value,T=t.substring(d,v);t.length&&ee.length&&(q>ee.length-s.length||ie<i.length)&&!(T&&s.startsWith(T))&&(t=ee);var K=0;t.startsWith(i)?K+=i.length:d<i.length&&(K=d),t=t.substring(K),v-=K;var Q=t.length,Z=t.length-s.length;t.endsWith(s)?Q=Z:(v>Z||v>t.length-s.length)&&(Q=v),t=t.substring(0,Q),t=nr(k?"-"+t:t,a),t=(t.match(rr(g))||[]).join("");var re=t.indexOf(g);t=t.replace(new RegExp(Bt(g),"g"),function(S,j){return j===re?".":""});var V=ot(t,a),se=V.beforeDecimal,fe=V.afterDecimal,M=V.addNegation;return f.end-f.start<l.end-l.start&&se===""&&x&&!parseFloat(fe)&&(t=M?"-":""),t}function sr(t,e){var n=e.prefix;n===void 0&&(n="");var r=e.suffix;r===void 0&&(r="");var a=Array.from({length:t.length+1}).map(function(){return!0}),i=t[0]==="-";a.fill(!1,0,n.length+(i?1:0));var s=t.length;return a.fill(!1,s-r.length+1,s+1),a}function or(t){var e=Xe(t),n=e.thousandSeparator,r=e.decimalSeparator,a=t.prefix;a===void 0&&(a="");var i=t.allowNegative;if(i===void 0&&(i=!0),n===r)throw new Error(`
        Decimal separator can't be same as thousand separator.
        thousandSeparator: `+n+` (thousandSeparator = {true} is same as thousandSeparator = ",")
        decimalSeparator: `+r+` (default value for decimalSeparator is .)
     `);return a.startsWith("-")&&i&&(console.error(`
      Prefix can't start with '-' when allowNegative is true.
      prefix: `+a+`
      allowNegative: `+i+`
    `),i=!1),Object.assign(Object.assign({},t),{allowNegative:i})}function cr(t){t=or(t),t.decimalSeparator,t.allowedDecimalSeparators,t.thousandsGroupStyle;var e=t.suffix,n=t.allowNegative,r=t.allowLeadingZeros,a=t.onKeyDown;a===void 0&&(a=de);var i=t.onBlur;i===void 0&&(i=de);var s=t.thousandSeparator,o=t.decimalScale,l=t.fixedDecimalScale,f=t.prefix;f===void 0&&(f="");var d=t.defaultValue,v=t.value,h=t.valueIsNumericString,m=t.onValueChange,g=Ot(t,["decimalSeparator","allowedDecimalSeparators","thousandsGroupStyle","suffix","allowNegative","allowLeadingZeros","onKeyDown","onBlur","thousandSeparator","decimalScale","fixedDecimalScale","prefix","defaultValue","value","valueIsNumericString","onValueChange"]),x=Xe(t),w=x.decimalSeparator,p=x.allowedDecimalSeparators,N=function(M){return wt(M,t)},k=function(M,S){return ir(M,S,t)},U=De(v)?d:v,q=h??ar(U,f,e);De(v)?De(d)||(q=q||typeof d=="number"):q=q||typeof v=="number";var ie=function(M){return It(M)?M:(typeof M=="number"&&(M=Lt(M)),q&&typeof o=="number"?bt(M,o,!!l):M)},ee=Wt(ie(v),ie(d),!!q,N,k,m),T=ee[0],K=T.numAsString,Q=T.formattedValue,Z=ee[1],re=function(M){var S=M.target,j=M.key,W=S.selectionStart,G=S.selectionEnd,I=S.value;if(I===void 0&&(I=""),(j==="Backspace"||j==="Delete")&&G<f.length){M.preventDefault();return}if(W!==G){a(M);return}j==="Backspace"&&I[0]==="-"&&W===f.length+1&&n&&ve(S,1),o&&l&&(j==="Backspace"&&I[W-1]===w?(ve(S,W-1),M.preventDefault()):j==="Delete"&&I[W]===w&&M.preventDefault()),p!=null&&p.includes(j)&&I[W]===w&&ve(S,W+1);var Y=s===!0?",":s;j==="Backspace"&&I[W-1]===Y&&ve(S,W-1),j==="Delete"&&I[W]===Y&&ve(S,W+1),a(M)},V=function(M){var S=K;if(S.match(/\d/g)||(S=""),r||(S=qn(S)),l&&o&&(S=bt(S,o,l)),S!==K){var j=wt(S,t);Z({formattedValue:j,value:S,floatValue:parseFloat(S)},{event:M,source:Ee.event})}i(M)},se=function(M){return M===w?!0:ke(M)},fe=function(M){var S=M.currentValue,j=M.lastValue,W=M.formattedValue,G=M.currentValueIndex,I=M.formattedValueIndex,Y=S[G],oe=W[I],pe=Vt(j,S),ue=pe.to,me=function(ye){return k(ye).indexOf(".")+f.length};return v===0&&l&&o&&S[ue.start]===w&&me(S)<G&&me(W)>I?!1:G>=ue.start&&G<ue.end&&p&&p.includes(Y)&&oe===w?!0:Y===oe};return Object.assign(Object.assign({},g),{value:Q,valueIsNumericString:!1,isValidInputCharacter:se,isCharacterSame:fe,onValueChange:Z,format:N,removeFormatting:k,getCaretBoundary:function(M){return sr(M,t)},onKeyDown:re,onBlur:V})}function ur(t){var e=cr(t);return Se.createElement(tr,Object.assign({},e))}const lr=({inputSuffix:t,inputPrefix:e,...n})=>u.jsx(X,{...n,value:n.value,suffix:t,prefix:e}),dr=({onValueChange:t,...e})=>u.jsx(ur,{customInput:lr,onValueChange:t,...e}),Ye=({inputSuffix:t,inputPrefix:e,onValueChange:n,...r})=>u.jsx(dr,{inputPrefix:e,inputSuffix:t,onValueChange:n,...r}),Gt=6048e5,fr=864e5,Yt=6e4,Ut=36e5,St=Symbol.for("constructDateFrom");function ce(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&St in t?t[St](e):t instanceof Date?new t.constructor(e):new Date(e)}function z(t,e){return ce(e||t,t)}let mr={};function $e(){return mr}function je(t,e){var o,l,f,d;const n=$e(),r=(e==null?void 0:e.weekStartsOn)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((d=(f=n.locale)==null?void 0:f.options)==null?void 0:d.weekStartsOn)??0,a=z(t,e==null?void 0:e.in),i=a.getDay(),s=(i<r?7:0)+i-r;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function Ke(t,e){return je(t,{...e,weekStartsOn:1})}function qt(t,e){const n=z(t,e==null?void 0:e.in),r=n.getFullYear(),a=ce(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const i=Ke(a),s=ce(n,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const o=Ke(s);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function Ct(t){const e=z(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function gr(t,...e){const n=ce.bind(null,e.find(r=>typeof r=="object"));return e.map(n)}function Dt(t,e){const n=z(t,e==null?void 0:e.in);return n.setHours(0,0,0,0),n}function hr(t,e,n){const[r,a]=gr(n==null?void 0:n.in,t,e),i=Dt(r),s=Dt(a),o=+i-Ct(i),l=+s-Ct(s);return Math.round((o-l)/fr)}function vr(t,e){const n=qt(t,e),r=ce(t,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Ke(r)}function pr(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function yr(t){return!(!pr(t)&&typeof t!="number"||isNaN(+z(t)))}function xr(t,e){const n=z(t,e==null?void 0:e.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const br={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_r=(t,e,n)=>{let r;const a=br[t];return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function tt(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const wr={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Sr={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Cr={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Dr={date:tt({formats:wr,defaultWidth:"full"}),time:tt({formats:Sr,defaultWidth:"full"}),dateTime:tt({formats:Cr,defaultWidth:"full"})},Pr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Mr=(t,e,n,r)=>Pr[t];function Me(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&t.formattingValues){const s=t.defaultFormattingWidth||t.defaultWidth,o=n!=null&&n.width?String(n.width):s;a=t.formattingValues[o]||t.formattingValues[s]}else{const s=t.defaultWidth,o=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[o]||t.values[s]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const Fr={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Tr={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Nr={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Er={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},kr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},jr={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Rr=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Or={ordinalNumber:Rr,era:Me({values:Fr,defaultWidth:"wide"}),quarter:Me({values:Tr,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Me({values:Nr,defaultWidth:"wide"}),day:Me({values:Er,defaultWidth:"wide"}),dayPeriod:Me({values:kr,defaultWidth:"wide",formattingValues:jr,defaultFormattingWidth:"wide"})};function Fe(t){return(e,n={})=>{const r=n.width,a=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const s=i[0],o=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(o)?Br(o,v=>v.test(s)):Ir(o,v=>v.test(s));let f;f=t.valueCallback?t.valueCallback(l):l,f=n.valueCallback?n.valueCallback(f):f;const d=e.slice(s.length);return{value:f,rest:d}}}function Ir(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function Br(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function Ar(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const a=r[0],i=e.match(t.parsePattern);if(!i)return null;let s=t.valueCallback?t.valueCallback(i[0]):i[0];s=n.valueCallback?n.valueCallback(s):s;const o=e.slice(a.length);return{value:s,rest:o}}}const Lr=/^(\d+)(th|st|nd|rd)?/i,Vr=/\d+/i,Wr={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Gr={any:[/^b/i,/^(a|c)/i]},Yr={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ur={any:[/1/i,/2/i,/3/i,/4/i]},qr={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Hr={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Kr={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Xr={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},$r={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Qr={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Zr={ordinalNumber:Ar({matchPattern:Lr,parsePattern:Vr,valueCallback:t=>parseInt(t,10)}),era:Fe({matchPatterns:Wr,defaultMatchWidth:"wide",parsePatterns:Gr,defaultParseWidth:"any"}),quarter:Fe({matchPatterns:Yr,defaultMatchWidth:"wide",parsePatterns:Ur,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Fe({matchPatterns:qr,defaultMatchWidth:"wide",parsePatterns:Hr,defaultParseWidth:"any"}),day:Fe({matchPatterns:Kr,defaultMatchWidth:"wide",parsePatterns:Xr,defaultParseWidth:"any"}),dayPeriod:Fe({matchPatterns:$r,defaultMatchWidth:"any",parsePatterns:Qr,defaultParseWidth:"any"})},zr={code:"en-US",formatDistance:_r,formatLong:Dr,formatRelative:Mr,localize:Or,match:Zr,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Jr(t,e){const n=z(t,e==null?void 0:e.in);return hr(n,xr(n))+1}function ea(t,e){const n=z(t,e==null?void 0:e.in),r=+Ke(n)-+vr(n);return Math.round(r/Gt)+1}function Ht(t,e){var d,v,h,m;const n=z(t,e==null?void 0:e.in),r=n.getFullYear(),a=$e(),i=(e==null?void 0:e.firstWeekContainsDate)??((v=(d=e==null?void 0:e.locale)==null?void 0:d.options)==null?void 0:v.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(h=a.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,s=ce((e==null?void 0:e.in)||t,0);s.setFullYear(r+1,0,i),s.setHours(0,0,0,0);const o=je(s,e),l=ce((e==null?void 0:e.in)||t,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const f=je(l,e);return+n>=+o?r+1:+n>=+f?r:r-1}function ta(t,e){var o,l,f,d;const n=$e(),r=(e==null?void 0:e.firstWeekContainsDate)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(f=n.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??1,a=Ht(t,e),i=ce((e==null?void 0:e.in)||t,0);return i.setFullYear(a,0,r),i.setHours(0,0,0,0),je(i,e)}function na(t,e){const n=z(t,e==null?void 0:e.in),r=+je(n,e)-+ta(n,e);return Math.round(r/Gt)+1}function E(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const le={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return E(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):E(n+1,2)},d(t,e){return E(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return E(t.getHours()%12||12,e.length)},H(t,e){return E(t.getHours(),e.length)},m(t,e){return E(t.getMinutes(),e.length)},s(t,e){return E(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return E(a,e.length)}},we={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Pt={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return le.y(t,e)},Y:function(t,e,n,r){const a=Ht(t,r),i=a>0?a:1-a;if(e==="YY"){const s=i%100;return E(s,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):E(i,e.length)},R:function(t,e){const n=qt(t);return E(n,e.length)},u:function(t,e){const n=t.getFullYear();return E(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return E(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return E(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return le.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return E(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const a=na(t,r);return e==="wo"?n.ordinalNumber(a,{unit:"week"}):E(a,e.length)},I:function(t,e,n){const r=ea(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):E(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):le.d(t,e)},D:function(t,e,n){const r=Jr(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):E(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return E(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return E(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),a=r===0?7:r;switch(e){case"i":return String(a);case"ii":return E(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let a;switch(r===12?a=we.noon:r===0?a=we.midnight:a=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let a;switch(r>=17?a=we.evening:r>=12?a=we.afternoon:r>=4?a=we.morning:a=we.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return le.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):le.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):E(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):E(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):le.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):le.s(t,e)},S:function(t,e){return le.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return Ft(r);case"XXXX":case"XX":return he(r);case"XXXXX":case"XXX":default:return he(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return Ft(r);case"xxxx":case"xx":return he(r);case"xxxxx":case"xxx":default:return he(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Mt(r,":");case"OOOO":default:return"GMT"+he(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Mt(r,":");case"zzzz":default:return"GMT"+he(r,":")}},t:function(t,e,n){const r=Math.trunc(+t/1e3);return E(r,e.length)},T:function(t,e,n){return E(+t,e.length)}};function Mt(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=Math.trunc(r/60),i=r%60;return i===0?n+String(a):n+String(a)+e+E(i,2)}function Ft(t,e){return t%60===0?(t>0?"-":"+")+E(Math.abs(t)/60,2):he(t,e)}function he(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=E(Math.trunc(r/60),2),i=E(r%60,2);return n+a+e+i}const Tt=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Kt=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},ra=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return Tt(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Tt(r,e)).replace("{{time}}",Kt(a,e))},aa={p:Kt,P:ra},ia=/^D+$/,sa=/^Y+$/,oa=["D","DD","YY","YYYY"];function ca(t){return ia.test(t)}function ua(t){return sa.test(t)}function la(t,e,n){const r=da(t,e,n);if(console.warn(r),oa.includes(t))throw new RangeError(r)}function da(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const fa=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ma=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ga=/^'([^]*?)'?$/,ha=/''/g,va=/[a-zA-Z]/;function nt(t,e,n){var d,v,h,m;const r=$e(),a=r.locale??zr,i=r.firstWeekContainsDate??((v=(d=r.locale)==null?void 0:d.options)==null?void 0:v.firstWeekContainsDate)??1,s=r.weekStartsOn??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??0,o=z(t,n==null?void 0:n.in);if(!yr(o))throw new RangeError("Invalid time value");let l=e.match(ma).map(g=>{const x=g[0];if(x==="p"||x==="P"){const w=aa[x];return w(g,a.formatLong)}return g}).join("").match(fa).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const x=g[0];if(x==="'")return{isToken:!1,value:pa(g)};if(Pt[x])return{isToken:!0,value:g};if(x.match(va))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:g}});a.localize.preprocessor&&(l=a.localize.preprocessor(o,l));const f={firstWeekContainsDate:i,weekStartsOn:s,locale:a};return l.map(g=>{if(!g.isToken)return g.value;const x=g.value;(ua(x)||ca(x))&&la(x,e,String(t));const w=Pt[x[0]];return w(o,x,a.localize,f)}).join("")}function pa(t){const e=t.match(ga);return e?e[1].replace(ha,"'"):t}function ya(t,e){const n=()=>ce(e==null?void 0:e.in,NaN),a=wa(t);let i;if(a.date){const f=Sa(a.date,2);i=Ca(f.restDateString,f.year)}if(!i||isNaN(+i))return n();const s=+i;let o=0,l;if(a.time&&(o=Da(a.time),isNaN(o)))return n();if(a.timezone){if(l=Pa(a.timezone),isNaN(l))return n()}else{const f=new Date(s+o),d=z(0,e==null?void 0:e.in);return d.setFullYear(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()),d.setHours(f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds(),f.getUTCMilliseconds()),d}return z(s+o+l,e==null?void 0:e.in)}const Ue={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},xa=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ba=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,_a=/^([+-])(\d{2})(?::?(\d{2}))?$/;function wa(t){const e={},n=t.split(Ue.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],Ue.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Ue.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const a=Ue.timezone.exec(r);a?(e.time=r.replace(a[1],""),e.timezone=a[1]):e.time=r}return e}function Sa(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function Ca(t,e){if(e===null)return new Date(NaN);const n=t.match(xa);if(!n)return new Date(NaN);const r=!!n[4],a=Te(n[1]),i=Te(n[2])-1,s=Te(n[3]),o=Te(n[4]),l=Te(n[5])-1;if(r)return Ea(e,o,l)?Ma(e,o,l):new Date(NaN);{const f=new Date(0);return!Ta(e,i,s)||!Na(e,a)?new Date(NaN):(f.setUTCFullYear(e,i,Math.max(a,s)),f)}}function Te(t){return t?parseInt(t):1}function Da(t){const e=t.match(ba);if(!e)return NaN;const n=rt(e[1]),r=rt(e[2]),a=rt(e[3]);return ka(n,r,a)?n*Ut+r*Yt+a*1e3:NaN}function rt(t){return t&&parseFloat(t.replace(",","."))||0}function Pa(t){if(t==="Z")return 0;const e=t.match(_a);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return ja(r,a)?n*(r*Ut+a*Yt):NaN}function Ma(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const a=r.getUTCDay()||7,i=(e-1)*7+n+1-a;return r.setUTCDate(r.getUTCDate()+i),r}const Fa=[31,null,31,30,31,30,31,31,30,31,30,31];function Xt(t){return t%400===0||t%4===0&&t%100!==0}function Ta(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(Fa[e]||(Xt(t)?29:28))}function Na(t,e){return e>=1&&e<=(Xt(t)?366:365)}function Ea(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function ka(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function ja(t,e){return e>=0&&e<=59}const Nt=[{label:"Producer",value:"Producer"},{label:"Distributor",value:"Distributor"},{label:"Recycler",value:"Recycler"},{label:"Collector",value:"Collector"},{label:"Retailer",value:"Retailer"}],Ra=[{label:"Plastic shopping/carry bags (having thickness less than 75 micron or less than 12 x 16 inch in size)",value:"Plastic shopping/carry bags (having thickness less than 75 micron)"},{label:"Other Single Use Plastics",value:"Other Single Use Plastics"},{label:"Unregistered Single Use Plastic Business",value:"Unregistered Single Use Plastic Business"}],Oa=[{label:"Notice issued",value:"Notice issued"},{label:"Confiscation",value:"Confiscation"},{label:"Sealing",value:"Sealing"},{label:"FIR",value:"FIR"},{label:"Complaint before Environmental Magistrate",value:"Complaint before Environmental Magistrate"},{label:"Fine Imposed",value:"Fine Imposed"},{label:"De Sealed",value:"De Sealed"}],Ia=({control:t,errors:e,readOnly:n=!1,defaultValues:r})=>{var Y,oe,pe,ue,me,ye,xe,Re,Oe,Ie,Be,Ae,Le,Pe,Ve,b,_,P,R,H,O;const[a,i]=C.useState([]),[s,o]=C.useState([]),{setValue:l,getValues:f,trigger:d}=kt(),[v,h]=C.useState(""),m=ae({control:t,name:"violationFound",defaultValue:[]}),g=ae({control:t,name:"violationType",defaultValue:[]}),x=ae({control:t,name:"actionTaken",defaultValue:[]}),w=ae({control:t,name:"fineRecoveryStatus",defaultValue:[]}),p=ae({control:t,name:"fineAmount",defaultValue:0}),N=(c,y)=>{o(y);const F=y.filter(B=>!a.includes(B));F.length>0&&i(B=>[...B,...F])},k=ae({control:t,name:"plasticBagsConfiscation",defaultValue:0}),U=ae({control:t,name:"confiscation_otherPlastics",defaultValue:{}}),[q,ie]=C.useState(0);C.useEffect(()=>{if(w==="Recovered"){const c=nt(new Date,"yyyy-MM-dd"),y=parseInt(p)||0;K([{date:c,amount:y,isNew:!0}]),Z(y)}},[w,p]),C.useEffect(()=>{if(x.includes("Confiscation")){let c=0;g.includes("Plastic shopping/carry bags (having thickness less than 75 micron)")&&(c+=parseFloat(k)||0),s.forEach(y=>{U[y]&&(c+=parseFloat(U[y])||0)}),ie(c),l("totalConfiscation",c)}},[k,U,x,l,s,g]),C.useEffect(()=>{$t.get("/pmc/inspection-report-cached/all_other_single_use_plastics/").then(c=>{i(c.data.single_use_plastic_items||[])}).catch(c=>{console.error("Error fetching available options:",c)})},[]),C.useEffect(()=>{if(r!=null&&r.fineRecoveryBreakup){const c=r.fineRecoveryBreakup.map(y=>({...y,isNew:!1}));K(c)}},[r==null?void 0:r.fineRecoveryBreakup]),ae({control:t,name:"fineAmount",defaultValue:0}),ae({control:t,name:"recoveryAmount",defaultValue:0});const ee=ae({control:t,name:"fineRecoveryBreakup",defaultValue:[]}),[T,K]=C.useState(ee||[]),[Q,Z]=C.useState(0);C.useEffect(()=>{console.log("Updating total recovery"),console.log("recoveryEntries",T);const c=T.reduce((y,F)=>y+(F.amount||0),0);Z(c),console.log("fineReoceryBreakup is setup")},[T,l]);const re=(c,y,F)=>{console.log("recovery amount updated:"),console.log(c,y,F),K(B=>{const $=B.map((be,_e)=>_e===c?{...be,[y]:parseFloat(F)||0}:be);return console.log("🔹 Updated Recovery Entries:",$),$})};C.useEffect(()=>{console.log("Updated recovery entries:",T),console.log("Calculated Total Recovery:",Q)},[T,Q]),C.useEffect(()=>{r!=null&&r.OtherSingleUseItems&&o(r.OtherSingleUseItems)},[r==null?void 0:r.OtherSingleUseItems]);const[V,se]=C.useState({lat:r.latitude,lng:r.longitude,district:""}),fe=c=>{console.log("Selected Location:",c),(!c.lat||!c.lng)&&console.warn("Latitude or Longitude is missing, retrying..."),se({lat:c.lat||V.lat,lng:c.lng||V.lng,district:c.district||V.district})},M=c=>{c.key==="Backspace"&&h(S(v,!0))},S=(c,y)=>{let F=c.replace(/[^a-zA-Z0-9]/g,""),B=F.slice(0,3).toUpperCase().replace(/[^A-Z]/g,""),$=F.slice(3,6).toUpperCase().replace(/[^A-Z]/g,""),be=F.slice(6).replace(/[^0-9]/g,"");if(y)return[B,$,be].filter(Boolean).join("-");let _e="";return B&&(_e+=B+(B.length===3?"-":"")),$&&(_e+=$+($.length===3?"-":"")),be&&(_e+=be),_e};console.log("fineRecoveryBreakup:",r==null?void 0:r.fineRecoveryBreakup),console.log("readOnly",n),qe(c=>c.user.district_id);const j=qe(c=>c.user.district_name)||"";console.log("district_name:",j),console.log("location:",r==null?void 0:r.location),console.log("defaultValues:",r);const{latitude:W,longitude:G}=r,I=W&&G?{lat:W,lng:G}:null;return C.useEffect(()=>{const y=setInterval(()=>{(!V.lat||!V.lng)&&(console.log("Retrying location fetch..."),I?se(I):console.warn("No valid location found, please select again."))},2e3);return()=>clearInterval(y)},[V.lat,V.lng,I]),u.jsxs(rn,{children:[u.jsxs("h4",{className:"mb-6",children:["Inspection Report - ",j]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsx(A,{label:"Inspection Date*",invalid:!!e.inspectionDate,errorMessage:(Y=e.inspectionDate)==null?void 0:Y.message,children:u.jsx(L,{name:"inspectionDate",control:t,render:({field:c})=>{const y=c.value?nt(new Date(c.value),"dd/MM/yyyy"):"";return u.jsx(X,{type:"text",...c,value:y,readOnly:!0})}})}),u.jsx(A,{label:"Name of Business*",invalid:!!e.businessName,errorMessage:(oe=e.businessName)==null?void 0:oe.message,children:u.jsx(L,{name:"businessName",control:t,render:({field:c})=>u.jsx(X,{type:"text",placeholder:"Business Name",readOnly:n,...c})})}),u.jsx(A,{label:"Type of Business*",invalid:!!e.businessType,errorMessage:(pe=e.businessType)==null?void 0:pe.message,children:u.jsx(L,{name:"businessType",control:t,render:({field:c})=>u.jsx(ut,{options:Nt,value:Nt.find(y=>y.value===c.value),isDisabled:n,onChange:y=>c.onChange(y==null?void 0:y.value)})})}),u.jsx(A,{label:"Plastic Application / License Number",invalid:!!e.licenseNumber,errorMessage:(ue=e.licenseNumber)==null?void 0:ue.message,children:u.jsx(L,{name:"licenseNumber",control:t,render:({field:c})=>u.jsx(X,{value:v,onChange:y=>h(S(y.target.value,!1)),onKeyDown:M,placeholder:"e.g., LHR-PRO-001",title:"Tracking Number (e.g., LHR-PRO-001)",readOnly:n})})})]}),u.jsx(A,{label:"Violation Found*",invalid:!!e.violationFound,errorMessage:(me=e.violationFound)==null?void 0:me.message,children:u.jsx(L,{name:"violationFound",control:t,rules:{required:"Please select Yes or No"},render:({field:c})=>u.jsxs("div",{className:"flex gap-4 ml-2",children:[u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",value:"Yes",checked:c.value==="Yes",onChange:()=>c.onChange("Yes"),disabled:n,required:!0}),"Yes"]}),u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",value:"No",checked:c.value==="No",onChange:()=>c.onChange("No"),disabled:n,required:!0}),"No"]})]})})}),m==="Yes"&&u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs(A,{label:"Type of Violation Found*",invalid:!!e.violationType,errorMessage:(ye=e.violationType)==null?void 0:ye.message,children:[Ra.map(c=>u.jsx(L,{name:"violationType",control:t,render:({field:y})=>u.jsx(We.Group,{value:y.value||[],onChange:F=>y.onChange(F),className:"flex flex-col gap-2 mb-2 ml-2",children:u.jsx(We,{...y,value:c.value,disabled:n,children:c.label})})},c.value)),g.includes("Other Single Use Plastics")&&u.jsx(A,{label:"Add List + (If desired item is not in the list, then type and press enter to add)",invalid:!!e.PackagingItems,errorMessage:(xe=e.PackagingItems)==null?void 0:xe.message,className:"ml-2 mt-4",children:u.jsx(L,{name:"OtherSingleUseItems",control:t,render:({field:c})=>u.jsx(Fn,{multiple:!0,freeSolo:!0,options:a,value:s,readOnly:n,onChange:(y,F)=>{c.onChange(F),N(y,F)},renderTags:(y,F)=>y.map((B,$)=>u.jsx(Tn,{variant:"outlined",label:B,...F({index:$})})),renderInput:y=>u.jsx(Nn,{...y,variant:"outlined",label:"Other Single Use Plastics",placeholder:"Add or select Single Use Plastics"})})})})]}),u.jsx(A,{label:"Action Taken*",invalid:!!e.actionTaken,errorMessage:(Re=e.actionTaken)==null?void 0:Re.message,children:Oa.map(c=>u.jsx(L,{name:"actionTaken",control:t,render:({field:y})=>u.jsx(We.Group,{value:y.value||[],onChange:F=>y.onChange(F),className:"flex flex-col gap-2 mb-2 ml-2",children:u.jsx(We,{...y,value:c.value,disabled:n&&c.value!=="De Sealed",children:c.label})})},c.value))}),x.includes("Confiscation")&&g.includes("Plastic shopping/carry bags (having thickness less than 75 micron)")&&u.jsx(A,{label:"Plastic shopping/carry bags (having thickness less than 75 micron) (KG)",invalid:!!e.plasticBagsConfiscation,errorMessage:(Oe=e.plasticBagsConfiscation)==null?void 0:Oe.message,children:u.jsx(L,{name:"plasticBagsConfiscation",control:t,render:({field:c})=>u.jsx(Ye,{placeholder:"Enter KG",...c,readOnly:n})})}),x.includes("Confiscation")&&g.includes("Other Single Use Plastics")&&s.map((c,y)=>u.jsx(A,{label:`${c} Confiscation (KG)`,children:u.jsx(L,{name:`confiscation_otherPlastics.${c}`,control:t,render:({field:F})=>u.jsx(X,{type:"number",placeholder:"Enter KG",...F,readOnly:n})})},y)),x.includes("Confiscation")&&u.jsx(A,{label:"Total Confiscation (KG)*",invalid:!!e.totalConfiscation,errorMessage:(Ie=e.totalConfiscation)==null?void 0:Ie.message,children:u.jsx(L,{name:"totalConfiscation",control:t,render:({field:c})=>(C.useEffect(()=>{c.onChange(q)},[q]),u.jsx(X,{type:"number",placeholder:"Auto-calculated",readOnly:!0,...c}))})}),x.includes("Confiscation")&&u.jsxs(u.Fragment,{children:[u.jsx(A,{label:"Confiscation Receipt Upload*",invalid:!!e.confiscationReceipt,errorMessage:(Be=e.confiscationReceipt)==null?void 0:Be.message,children:u.jsx(L,{name:"confiscationReceipt",control:t,render:({field:c})=>u.jsx(X,{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:y=>c.onChange(y.target.files[0]||null),disabled:n})})}),u.jsx(A,{label:"Receipt Book Number*",invalid:!!e.receiptBookNumber,errorMessage:(Ae=e.receiptBookNumber)==null?void 0:Ae.message,children:u.jsx(L,{name:"receiptBookNumber",control:t,render:({field:c})=>u.jsx(X,{type:"number",placeholder:"Enter Receipt Book Number",...c,readOnly:n})})}),u.jsx(A,{label:"Receipt Number*",invalid:!!e.receiptNumber,errorMessage:(Le=e.receiptNumber)==null?void 0:Le.message,children:u.jsx(L,{name:"receiptNumber",control:t,render:({field:c})=>u.jsx(X,{type:"number",placeholder:"Enter Receipt Number",...c,readOnly:n})})})]}),x.includes("Fine Imposed")&&u.jsxs(u.Fragment,{children:[u.jsx(A,{label:"Fine Amount (PKR)",invalid:!!e.fineAmount,errorMessage:(Pe=e.fineAmount)==null?void 0:Pe.message,children:u.jsx(L,{name:"fineAmount",control:t,render:({field:c})=>u.jsx(Ye,{placeholder:"Enter Fine Amount",...c,readOnly:n})})}),u.jsx(A,{label:"Fine Recovery Status",invalid:!!e.fineRecoveryStatus,errorMessage:(Ve=e.fineRecoveryStatus)==null?void 0:Ve.message,children:u.jsx(L,{name:"fineRecoveryStatus",control:t,render:({field:c})=>u.jsx(ut,{options:[{label:"Pending",value:"Pending"},{label:"Recovered",value:"Recovered"}],value:{label:c.value||"Pending",value:c.value||"Pending"},onChange:y=>c.onChange(y==null?void 0:y.value),isDisabled:n&&c.value==="Recovered"})})}),w!=="Pending"&&u.jsxs(u.Fragment,{children:[u.jsx(A,{label:"Total Recovery Amount (PKR)",invalid:!!e.recoveryAmount,errorMessage:(b=e.recoveryAmount)==null?void 0:b.message,children:u.jsx(L,{name:"recoveryAmount",control:t,render:({field:c})=>(C.useEffect(()=>{c.onChange(Q)},[Q]),u.jsx(Ye,{placeholder:"Auto-calculated",readOnly:!0,...c}))})}),T.map((c,y)=>{var F,B;return u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsx(A,{label:"Recovery Date",invalid:!!e.fineRecoveryBreakup,errorMessage:(F=e.fineAmount)==null?void 0:F.fineRecoveryBreakup,children:u.jsx(X,{type:"text",value:c.date?nt(ya(c.date),"dd/MM/yyyy"):"",readOnly:!0})}),u.jsx(A,{label:"Recovery Amount (PKR)",invalid:!!e.fineRecoveryBreakup,errorMessage:(B=e.fineAmount)==null?void 0:B.fineRecoveryBreakup,children:u.jsx(Ye,{value:c.amount,onChange:$=>re(y,"amount",$.target.value),readOnly:!0})})]},y)}),u.jsx(A,{label:"Payment Challan Upload*",invalid:!!e.paymentChallan,errorMessage:(_=e.paymentChallan)==null?void 0:_.message,children:u.jsx(L,{name:"paymentChallan",control:t,render:({field:c})=>u.jsx(X,{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:y=>c.onChange(y.target.files[0]||null),disabled:n})})})]})]}),x.includes("De Sealed")&&u.jsxs(u.Fragment,{children:[u.jsx(A,{label:"De Sealed Date",invalid:!!e.deSealedDate,errorMessage:(P=e.deSealedDate)==null?void 0:P.message,children:u.jsx(L,{name:"deSealedDate",control:t,render:({field:c})=>u.jsx(X,{type:"date",...c,readOnly:n&&c.value!==null&&c.value!==""})})}),u.jsx(A,{label:"De Seal - Affidavit",invalid:!!e.affidavit,errorMessage:(R=e.affidavit)==null?void 0:R.message,children:u.jsx(L,{name:"affidavit",control:t,render:({field:c})=>u.jsx(X,{type:"file",accept:".pdf,.png,.jpg,.jpeg",onChange:y=>c.onChange(y.target.files[0]||null)})})})]})]}),u.jsxs("div",{style:{padding:"20px"},children:[u.jsx("h1",{children:"Select Location"}),u.jsx(Ln,{onLocationSelect:fe,savedLocation:I,isEditing:!!(r!=null&&r.id)}),u.jsxs("div",{style:{marginTop:"20px",padding:"10px",border:"1px solid #ccc"},children:[u.jsx("h3",{children:"Selected Location Details:"}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsx(A,{label:"Latitude",invalid:!!e.latitude,errorMessage:(H=e.latitude)==null?void 0:H.message,children:u.jsx(L,{name:"latitude",control:t,render:({field:c})=>(C.useEffect(()=>{V.lat||console.warn("Latitude is missing, setting default..."),c.onChange(V.lat||0)},[V.lat]),u.jsx(X,{type:"number",placeholder:"Auto-calculated",readOnly:!0,...c}))})}),u.jsx(A,{label:"Longitude",invalid:!!e.longitude,errorMessage:(O=e.longitude)==null?void 0:O.message,children:u.jsx(L,{name:"longitude",control:t,render:({field:c})=>(C.useEffect(()=>{V.lng||console.warn("Longitude is missing, setting default..."),c.onChange(V.lng||0)},[V.lng]),u.jsx(X,{type:"number",placeholder:"Auto-calculated",readOnly:!0,...c}))})}),u.jsx(L,{name:"fineRecoveryBreakup",control:t,render:({field:c})=>(C.useEffect(()=>{c.onChange(T)},[T]),u.jsx(X,{type:"hidden",placeholder:"Auto-calculated",readOnly:!0,...c}))})]})]})]})]})},Ba=D.object({businessName:D.string().min(1,{message:"Business name required"}),businessType:D.string().min(1,{message:"Business type required"}),licenseNumber:D.string().optional(),violationFound:D.string().nonempty({message:"Please select at least one option for Violation Found"}),violationType:D.array(D.string()).optional(),actionTaken:D.array(D.string()).optional(),plasticBagsConfiscation:D.coerce.number().optional(),confiscation_otherPlastics:D.record(D.string(),D.coerce.number()).optional(),totalConfiscation:D.coerce.number().optional(),OtherSingleUseItems:D.array(D.string()).optional(),latitude:D.coerce.number().min(-90,{message:"Latitude is required and must be valid (-90 to 90)"}),longitude:D.coerce.number().min(-180,{message:"Longitude is required and must be valid (-180 to 180)"}),district:D.string().optional(),inspectionDate:D.string().min(1,{message:"Inspection date is required"}),fineAmount:D.coerce.number().optional(),fineRecoveryStatus:D.enum(["Pending","Recovered"]).optional(),fineRecoveryDate:D.string().optional(),recoveryAmount:D.coerce.number().optional(),deSealedDate:D.string().optional(),fineRecoveryBreakup:D.array(D.object({date:D.string().min(1,{message:"Date is required"}),amount:D.coerce.number().min(0,{message:"Amount must be a number and at least 0"}),isNew:D.boolean().optional()})).default([]),affidavit:D.instanceof(File,{message:"Must be a valid file"}).optional(),confiscationReceipt:D.instanceof(File,{message:"Must be a valid file"}).optional(),receiptBookNumber:D.string().optional(),receiptNumber:D.string().optional(),paymentChallan:D.instanceof(File,{message:"Must be a valid file"}).optional()}).superRefine((t,e)=>{var r;t.fineRecoveryStatus==="Recovered"&&(t.paymentChallan?t.paymentChallan.size>10*1024*1024&&e.addIssue({path:["paymentChallan"],message:"Payment challan must be smaller than 10MB",code:D.ZodIssueCode.custom}):e.addIssue({path:["paymentChallan"],message:"Payment challan is required when fine is recovered",code:D.ZodIssueCode.custom})),((r=t.actionTaken)==null?void 0:r.includes("Confiscation"))&&(t.confiscationReceipt?t.confiscationReceipt.size>10*1024*1024&&e.addIssue({path:["confiscationReceipt"],message:"Confiscation receipt must be smaller than 10MB",code:D.ZodIssueCode.custom}):e.addIssue({path:["confiscationReceipt"],message:"Confiscation receipt is required",code:D.ZodIssueCode.custom}),(!t.receiptBookNumber||t.receiptBookNumber.trim()==="")&&e.addIssue({path:["receiptBookNumber"],message:"Receipt book number is required",code:D.ZodIssueCode.custom}),(!t.receiptNumber||t.receiptNumber.trim()==="")&&e.addIssue({path:["receiptNumber"],message:"Receipt number is required",code:D.ZodIssueCode.custom}),(!t.totalConfiscation||t.totalConfiscation<=0)&&e.addIssue({path:["totalConfiscation"],message:"Total confiscation must be greater than 0 KG",code:D.ZodIssueCode.custom}))}),Aa=({onFormSubmit:t,defaultValues:e={},readOnly:n,children:r})=>{const{handleSubmit:a,reset:i,formState:{errors:s},control:o}=kt({defaultValues:{fineRecoveryBreakup:(e==null?void 0:e.fineRecoveryBreakup)??[]},resolver:En(Ba)});return C.useEffect(()=>{Qt(e)||i(e)},[JSON.stringify(e)]),u.jsxs(tn,{className:"flex w-full h-full",containerClassName:"flex flex-col w-full justify-between",onSubmit:a(t),children:[u.jsx(Et,{children:u.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:u.jsx("div",{className:"gap-4 flex flex-col flex-auto",children:u.jsx(Ia,{control:o,errors:s,defaultValues:e,readOnly:n})})})}),u.jsx(nn,{children:r})]})},La=t=>t?{id:t.id,businessName:t.business_name,businessType:t.business_type,licenseNumber:t.license_number||"",violationFound:t.violation_found||[],violationType:t.violation_type||[],actionTaken:t.action_taken||[],plasticBagsConfiscation:t.plastic_bags_confiscation??0,confiscationOtherPlastics:t.confiscation_other_plastics||{},totalConfiscation:t.total_confiscation||0,OtherSingleUseItems:t.other_single_use_items||[],latitude:t.latitude??null,longitude:t.longitude??null,district:t.district||"",inspectionDate:t.inspection_date||null,fineAmount:t.fine_amount??0,fineRecoveryStatus:t.fine_recovery_status||void 0,fineRecoveryDate:t.fine_recovery_date||"",recoveryAmount:t.recovery_amount??0,deSealedDate:t.de_sealed_date||"",fineRecoveryBreakup:t.fine_recovery_breakup||null,syncStatus:t.syncStatus||void 0,receiptBookNumber:t.receipt_book_number||null,receiptNumber:t.receipt_number||null}:null,xi=()=>{const t=Zt(),e=zt(),{reports:n,fetchReports:r,updateReport:a,addNewReport:i,syncReports:s}=On(),[o,l]=C.useState(!1),[f,d]=C.useState(!1),h=new URLSearchParams(e.search).get("id");console.log(n);let m=C.useMemo(()=>{const p=n.find(N=>N.id==h);return p?La(p):null},[n,h]);m={...m,inspectionDate:(m==null?void 0:m.inspectionDate)||new Date().toISOString().split("T")[0]},C.useEffect(()=>{h&&!m&&r()},[m,r]),qe(p=>p.user.district_id),qe(p=>p.user.district_name);const g=async p=>{console.log("Submitting Data:",p),d(!0);const N={business_name:p.businessName,business_type:p.businessType,license_number:p.licenseNumber||"",violation_found:p.violationFound||[],violation_type:p.violationType||[],action_taken:p.actionTaken||[],plastic_bags_confiscation:p.plasticBagsConfiscation??0,confiscation_other_plastics:p.confiscationOtherPlastics||{},total_confiscation:p.totalConfiscation||0,other_single_use_items:p.OtherSingleUseItems||[],latitude:p.latitude??null,longitude:p.longitude??null,district:p.district||"",inspection_date:p.inspectionDate||null,fine_amount:p.fineAmount??0,fine_recovery_status:p.fineRecoveryStatus||void 0,fine_recovery_date:p.fineRecoveryDate||null,recovery_amount:p.recoveryAmount??0,de_sealed_date:p.deSealedDate||null,fine_recovery_breakup:p.fineRecoveryBreakup||null,affidavit:p.affidavit||null,confiscation_receipt:p.confiscationReceipt||null,receipt_book_number:p.receiptBookNumber||null,receipt_number:p.receiptNumber||null,payment_challan:p.paymentChallan||null,syncStatus:h?"patch":"post"};try{h?a(h,N):i(N),console.log("✅ Report Updated in Store"),d(!1),t("/auth/EPAOperations/AllInspections")}catch(k){console.error("❌ Error in Submission:",k),d(!1)}},x=()=>l(!0),w=()=>{l(!1),Jt.push(u.jsx(en,{type:"success",children:"Customer discard!"}),{placement:"top-center"}),t("/auth/EPAOperations/AllInspections")};return u.jsx(u.Fragment,{children:u.jsxs(u.Fragment,{children:[u.jsx(Aa,{newCustomer:!0,defaultValues:m,onFormSubmit:g,readOnly:h!==null,children:u.jsx(Et,{children:u.jsxs("div",{className:"flex items-center justify-between px-8",children:[u.jsx("span",{}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(ct,{className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error bg-transparent",icon:u.jsx(jn,{}),onClick:x,children:"Discard"}),u.jsx(ct,{icon:u.jsx(Rn,{}),variant:"solid",type:"submit",loading:f,children:"Save"})]})]})})}),u.jsx(kn,{isOpen:o,type:"danger",title:"Discard changes",onClose:()=>l(!1),onCancel:()=>l(!1),onConfirm:w,children:u.jsx("p",{children:"Are you sure you want to discard this?"})})]})})};export{xi as default};
