import{r as y,j as e,ao as Ne,am as Se,U as ke,A as T,a0 as Be}from"./index-wxNYYnG2.js";import{B as te}from"./StatusIcon-Bxhrjglf.js";import{G as Pe,H as Oe,D as Te,N as Re}from"./toast-B7g-nBsw.js";import{u as be,a as Me,C as ge}from"./index-CO_1zimJ.js";import{u as qe,I as x,a as f}from"./index.esm-DbEtFfbu.js";import{T as L,F as fe,C as he}from"./FormControlLabel-BUhIlJgL.js";import{n as ye,k as ve,o as Ce,u as je,c as we,j as De,D as Fe}from"./Divider-DftoNhsF.js";import{P as Ie,Q as xe,U as Ae}from"./TextField-BFJCirlH.js";import"./proxy-ATggp4gJ.js";import"./index-Cv1QrVk1.js";function Ee(l){return ve("MuiCard",l)}ye("MuiCard",["root"]);const Le=l=>{const{classes:m}=l;return De({root:["root"]},Ee,m)},Ge=Ce(Ie,{name:"MuiCard",slot:"Root",overridesResolver:(l,m)=>m.root})({overflow:"hidden"}),R=y.forwardRef(function(m,P){const b=je({props:m,name:"MuiCard"}),{className:q,raised:w=!1,...v}=b,j={...b,raised:w},d=Le(j);return e.jsx(Ge,{className:we(d.root,q),elevation:w?8:void 0,ref:P,ownerState:j,...v})});function Ye(l){return ve("MuiCardContent",l)}ye("MuiCardContent",["root"]);const We=l=>{const{classes:m}=l;return De({root:["root"]},Ye,m)},Ue=Ce("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(l,m)=>m.root})({padding:16,"&:last-child":{paddingBottom:24}}),M=y.forwardRef(function(m,P){const b=je({props:m,name:"MuiCardContent"}),{className:q,component:w="div",...v}=b,j={...b,component:w},d=We(j);return e.jsx(Ue,{as:w,className:we(d.root,q),ownerState:j,ref:P,...v})}),ze=({groupList:l,children:m})=>{var z,$,H;const[P,b]=y.useState(l!==void 0&&l.length>1?l[1].value:""),[q,w]=y.useState({previousStage:!1,nextStage:!1}),[v,j]=y.useState({}),[d,A]=y.useState({latitude:"",longitude:""}),{applicantDetail:g,businessDetailIndividual:K,businessEntity:Q,licenseDetail:S,licenseDetailProducer:J,licenseDetailConsumer:V,licenseDetailCollector:X,licenseDetailRecycler:F,updateApplicantDetail:I,completedSections:E}=be(),{control:se,handleSubmit:ie,formState:{errors:t}}=qe({defaultValues:{firstName:""}}),[Z]=Ne(),n=Z.get("group")!=="DO";y.useEffect(()=>{b(l!==void 0&&l.length>1?l[1].value:"")},[l]),y.useEffect(()=>{console.log("its in effect of review application "),console.log(g),g.id&&ee(g.id)},[g.id]),y.useEffect(()=>{console.log("fieldResponses",v),I({fieldResponses:v,readOnly:n})},[v]),console.log("fieldResponses",v),y.useEffect(()=>{I({manualFields:d,readOnly:n})},[d]);const ee=async _=>{try{const c=g.field_responses.reduce((i,h)=>(i[h.field_key]={response:h.response,comment:h.comment},i),{});j(c),g.manual_fields?A(g.manual_fields):A({})}finally{}},Y=(_,c)=>{j(i=>{var h;return{...i,[_]:{...i[_],response:c,comment:c==="No"?((h=i[_])==null?void 0:h.comment)||"":null}}})},oe=(_,c)=>{j(i=>({...i,[_]:{...i[_],comment:c}}))},p=(_,c)=>{A(i=>({...i,[_]:c}))};console.log(g);const W=_=>{var O,D,N,B;const{name:c,checked:i}=_.target;if(w({previousStage:c==="previousStage"?i:!1,nextStage:c==="nextStage"?i:!1}),c==="previousStage"&&i){b((O=l[0])==null?void 0:O.value);const s={assignedGroup2:(D=l[0])==null?void 0:D.value};I(s)}else if(c==="nextStage"&&i){const s={assignedGroup2:(N=l[2])==null?void 0:N.value};I(s),b((B=l[2])==null?void 0:B.value)}},ne=_=>{const c={remarks:_.target.value};I(c)},U={firstName:"First Name",lastName:"Last Name",applicantDesignation:"Designation",gender:"Gender",cnic:"CNIC",email:"Email",phoneNumber:"Mobile Number",trackingNumber:"Tracking Number",businessEntityType:"Business Entity Type",name:"Business Name",district:"District",tehsil:"Tehsil",city:"City",postalAddress:"Postal Address",registration_required_for:"Categories of Single Use Plastics",registration_required_for_other:"Categories for Other Plastics",registration_required_for_other_other_text:"Other",plain_plastic_Sheets_for_food_wrapping:"Additional Options for Packaging",PackagingItems:"Packging Item Other List",number_of_machines:"Number of machines",total_capacity_value:"Average Production Capacity (Kg per day)",date_of_setting_up:"Date of Business Setting Up",total_waste_generated_value:"Averrage Waste Generated (Kg per day)",has_waste_storage_capacity:"Has Waste Storage Capacity?",waste_disposal_provision:"Waste Disposal Provision",consumption:"Average Sale (Kg per day)",provision_waste_disposal_bins:"Provision of Waste Disposal Bins",no_of_waste_disposible_bins:"No. of Waste Disposibal Bins",segregated_plastics_handed_over_to_registered_recyclers:"Whether Segregated Plastics are being handed over to registered Re-Cyclers or Collectors?",selectedCategoriesCollector:"Source of Disposal",total_capacity_value_collector:"Average Collection (Kg per day)",number_of_vehicles:"Number of vehicles",number_of_persons:"Number of persons",selectedCategories:"Categories of plastic collected for recycling (Waste Disposal and Waste Collection in Kg per day)",plastic_waste_acquired_through:"Plastic waste acquired through",has_adequate_pollution_control_systems:"Has adequate pollution control systems or equipment to meet the standards of emission or effluent?",pollution_control_details:"Polution control details",licenseType:"License Type"},k=(_,c)=>e.jsx(R,{className:"mb-4",children:e.jsxs(M,{children:[e.jsx(L,{variant:"h6",className:"font-bold mb-4",children:_}),Object.entries(c||{}).map(([i,h])=>{var O,D,N,B;return h!==""&&i!=="applicationassignment"&&i!=="applicationdocument"&&i in U?e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-4",children:[e.jsxs("div",{className:"w-full md:flex-[5] flex flex-col md:flex-row items-start md:items-center mb-2 md:mb-0",children:[e.jsxs("span",{className:"font-bold mr-2",children:[U[i]||i,":"]}),e.jsx("span",{className:"text-normal break-words",children:typeof h=="object"&&h!==null?JSON.stringify(h,null,2):h})]}),e.jsxs("div",{className:"w-full md:flex-[3] flex items-center justify-center space-x-4 mt-2 md:mt-0",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:`response-${i}`,value:"Yes",checked:((O=v[i])==null?void 0:O.response)==="Yes",onChange:()=>Y(i,"Yes"),disabled:n}),e.jsx("span",{children:"Yes"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:`response-${i}`,value:"No",checked:((D=v[i])==null?void 0:D.response)==="No",onChange:()=>Y(i,"No"),disabled:n}),e.jsx("span",{children:"No"})]})]}),e.jsx("div",{className:"w-full md:flex-[5]",children:((N=v[i])==null?void 0:N.response)==="No"&&e.jsx(x,{type:"textarea",placeholder:"Add comment",value:((B=v[i])==null?void 0:B.comment)||"",onChange:s=>oe(i,s.target.value),className:"w-full border border-gray-300 rounded-lg p-2",readOnly:n})})]},i):null})]})}),le=_=>e.jsx(R,{sx:{marginBottom:"20px"},children:e.jsxs(M,{children:[e.jsx(L,{variant:"h6",sx:{fontWeight:"bold",marginBottom:"10px"},children:"Documents"}),e.jsx("ul",{children:_.map(c=>e.jsx("li",{children:e.jsxs("a",{href:c.document,target:"_blank",rel:"noopener noreferrer",children:[c.document_description," ",c.created_at.substring(0,19)]})},c.id))})]})}),de={backgroundColor:"#f0f8ff",border:"1px solid #007bff",padding:"10px",borderRadius:"4px",marginBottom:"15px"},ae=()=>{var _,c,i,h,O,D,N,B,s,a,r,u,G,C,ce,pe,ue,me,_e;return e.jsx(R,{sx:de,children:e.jsxs(M,{children:[e.jsx(L,{variant:"h6",sx:{color:"#007bff",marginBottom:"10px"},children:"Information to be provided by District Incharge"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(f,{label:"Latitude",invalid:!!t.latitude,errorMessage:(_=t.latitude)==null?void 0:_.message,children:e.jsx(x,{type:"number",placeholder:"Enter Latitude",value:d.latitude||"",onChange:o=>p("latitude",o.target.value),readOnly:n})}),e.jsx(f,{label:"Longitude",invalid:!!t.longitude,errorMessage:(c=t.longitude)==null?void 0:c.message,children:e.jsx(x,{type:"number",placeholder:"Enter Longitude",value:d.longitude||"",onChange:o=>p("longitude",o.target.value),readOnly:n})})]}),S.licenseType==="Producer"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(f,{label:"List of Products",invalid:!!t.listOfProducts,errorMessage:(i=t.listOfProducts)==null?void 0:i.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"List of Products",value:d.list_of_products||"",onChange:o=>p("list_of_products",o.target.value),readOnly:n})}),e.jsx(f,{label:"List of By Products",invalid:!!t.listOfByProducts,errorMessage:(h=t.listOfByProducts)==null?void 0:h.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"List of By Products",value:d.list_of_by_products||"",onChange:o=>p("list_of_by_products",o.target.value),readOnly:n})}),e.jsx(f,{label:"List and Quantity of Raw Material Imported",invalid:!!t.rawMaterialImported,errorMessage:(O=t.rawMaterialImported)==null?void 0:O.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"List and Quantity of Raw Material Imported",value:d.raw_material_imported||"",onChange:o=>p("raw_material_imported",o.target.value),readOnly:n})}),e.jsx(f,{label:"If raw material is bought, then Name of Seller",invalid:!!t.sellerNameIfRawMaterialBought,errorMessage:(D=t.sellerNameIfRawMaterialBought)==null?void 0:D.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"If raw material is bought then Name of seller",value:d.seller_name_if_raw_material_bought||"",onChange:o=>p("seller_name_if_raw_material_bought",o.target.value),readOnly:n})}),e.jsx(f,{label:"If self import, provide details",invalid:!!t.selfImportDetails,errorMessage:(N=t.selfImportDetails)==null?void 0:N.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"If self import, provide details",value:d.self_import_details||"",onChange:o=>p("self_import_details",o.target.value),readOnly:n})}),e.jsx(f,{label:"Quantity of Raw Material Utilized",invalid:!!t.rawMaterialUtilized,errorMessage:(B=t.rawMaterialUtilized)==null?void 0:B.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"Quantity of raw material utilized",value:d.raw_material_utilized||"",onChange:o=>p("raw_material_utilized",o.target.value),readOnly:n})})]}),e.jsx("div",{className:"grid md:grid-cols-1 gap-4",children:e.jsx("div",{className:"mb-4",children:e.jsx(Fe,{textAlign:"left"})})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(f,{label:"Status of compliance with – Thickness 75 micron",invalid:!!t.complianceThickness75,errorMessage:(s=t.complianceThickness75)==null?void 0:s.message,children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"complianceThickness75",value:"Yes",checked:d.compliance_thickness_75==="Yes",onChange:()=>p("compliance_thickness_75","Yes"),disabled:n}),e.jsx("span",{children:"Yes"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"complianceThickness75",value:"No",checked:d.compliance_thickness_75==="No",onChange:()=>p("compliance_thickness_75","No"),disabled:n}),e.jsx("span",{children:"No"})]})]})}),e.jsx(f,{label:"Does the unit have a valid consent/permit under the building and construction by-laws?",invalid:!!t.validConsentPermitBuildingBylaws,errorMessage:(a=t.validConsentPermitBuildingBylaws)==null?void 0:a.message,children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"validConsentPermitBuildingBylaws",value:"Yes",checked:d.valid_consent_permit_building_bylaws==="Yes",onChange:()=>p("valid_consent_permit_building_bylaws","Yes"),disabled:n}),e.jsx("span",{children:"Yes, please attach a copy"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"validConsentPermitBuildingBylaws",value:"No",checked:d.valid_consent_permit_building_bylaws==="No",onChange:()=>p("valid_consent_permit_building_bylaws","No"),disabled:n}),e.jsx("span",{children:"No"})]})]})}),e.jsx(f,{label:"Copy of consent/permit under the building and construction by-laws",invalid:!!t.consentPermitFile,errorMessage:(r=t.consentPermitFile)==null?void 0:r.message,children:e.jsx(x,{type:"file",accept:".pdf,.png,.jpg",onChange:o=>p("consent_permit_file",o.target.files[0]),disabled:n})}),e.jsx(f,{label:"Flow Diagram",invalid:!!t.flowDiagramFile,errorMessage:(u=t.flowDiagramFile)==null?void 0:u.message,children:e.jsx(x,{type:"file",accept:".pdf,.png,.jpg",onChange:o=>p("flow_diagram_file",o.target.files[0]),disabled:n})}),e.jsx(f,{label:"Action Plan",invalid:!!t.actionPlanFile,errorMessage:(G=t.actionPlanFile)==null?void 0:G.message,children:e.jsx(x,{type:"file",accept:".pdf,.png,.jpg",onChange:o=>p("action_plan_file",o.target.files[0]),disabled:n})}),e.jsx(f,{label:"List of Stockist/Distributor/Supplier to whom the products will be supplied",invalid:!!t.stockistDistributorList,errorMessage:(C=t.stockistDistributorList)==null?void 0:C.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"List of Stockist/Distributor/Supplier",value:d.stockist_distributor_list||"",onChange:o=>p("stockist_distributor_list",o.target.value),readOnly:n})})]})]}),S.licenseType==="Consumer"&&e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:e.jsx(f,{label:"Procurement (Kg per day)",invalid:!!t.procurementPerDay,errorMessage:(ce=t.procurementPerDay)==null?void 0:ce.message,children:e.jsx(x,{type:"text",placeholder:"Enter procurement",value:d.procurement_per_day||"",onChange:o=>p("procurement_per_day",o.target.value),readOnly:n})})}),S.licenseType==="Recycler"&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsx(f,{label:"No. of workers (including contract labour)",invalid:!!t.noOfWorkers,errorMessage:(pe=t.noOfWorkers)==null?void 0:pe.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"No. of workers (including contract labour)",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},value:d.no_of_workers||"",onChange:o=>p("no_of_workers",o.target.value),readOnly:n})}),e.jsx(f,{label:"Whether registered with Labor Dept.? If Yes, provide details?",invalid:!!t.laborDeptRegistrationStatus,errorMessage:(ue=t.laborDeptRegistrationStatus)==null?void 0:ue.message,children:e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"labor_dept_registration_status",value:"Yes",checked:d.labor_dept_registration_status==="Yes",onChange:()=>p("labor_dept_registration_status","Yes"),disabled:n}),e.jsx("span",{children:"Yes, please provide details"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"labor_dept_registration_status",value:"No",checked:d.labor_dept_registration_status==="No",onChange:()=>p("labor_dept_registration_status","No"),disabled:n}),e.jsx("span",{children:"No"})]})]})}),e.jsx(f,{label:"Occupational safety and health aspects (Please provide details of facilities)",invalid:!!t.occupationalSafetyAndHealthFacilities,errorMessage:(me=t.occupationalSafetyAndHealthFacilities)==null?void 0:me.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"Occupational safety and health facilities",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},value:d.occupational_safety_and_health_facilities||"",onChange:o=>p("occupational_safety_and_health_facilities",o.target.value),readOnly:n})}),e.jsx(f,{label:"Whether conditions exist or are likely to exist for the material being handled or processed to pose adverse impacts on the environment?",invalid:!!t.adverseEnvironmentalImpacts,errorMessage:(_e=t.adverseEnvironmentalImpacts)==null?void 0:_e.message,children:e.jsx(x,{type:"text",autoComplete:"off",placeholder:"Adverse environmental impacts details",style:{padding:"5px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#f9f9f9"},value:d.adverse_environmental_impacts||"",onChange:o=>p("adverse_environmental_impacts",o.target.value),readOnly:n})})]})]})})};return e.jsxs("div",{className:"p-4",style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"20px"},children:[e.jsxs("div",{children:[e.jsx(L,{variant:"h4",sx:{fontWeight:"bold",marginBottom:"20px"},children:"Review Information"}),!n&&e.jsx(R,{className:"mb-4",children:e.jsx(M,{children:e.jsx(L,{variant:"h7",sx:{fontWeight:"bold",marginBottom:"20px"},children:'If the provided information is correct, please click "Yes". If it is incorrect, then please click "No" and add comments'})})}),n&&e.jsx(R,{className:"mb-4",children:e.jsx(M,{children:e.jsx(L,{variant:"h7",sx:{fontWeight:"bold",marginBottom:"20px"},children:"Please review the information provided by the District Incharge. This information is not editable and for your review only."})})}),E.includes("applicantDetail")&&k("Applicant Details",g),E.includes("businessEntity")&&k("Business Entity",Q),E.includes("businessDetailIndividual")&&k("Business Details",K),E.includes("licenseDetail")&&k("License Details",S),S.licenseType==="Producer"&&k("Producer Details",J),S.licenseType==="Consumer"&&k("Consumer Details",V),S.licenseType==="Collector"&&k("Collector Details",X),S.licenseType==="Recycler"&&k("Recycler Details",F),((z=g==null?void 0:g.applicationdocument)==null?void 0:z.length)>0&&le(g.applicationdocument),ae(),e.jsx(R,{sx:{marginBottom:"20px"},children:e.jsx(M,{children:e.jsx(xe,{fullWidth:!0,children:e.jsx(Ae,{id:"Remarks",label:"Remarks",variant:"outlined",onChange:ne})})})}),e.jsx(R,{children:e.jsx(M,{children:e.jsxs(xe,{children:[e.jsx(fe,{control:e.jsx(he,{name:"nextStage",checked:q.nextStage,onChange:W}),label:`Yes - As per remarks, proceed to next stage (${($=l[2])==null?void 0:$.label})`}),e.jsx(fe,{control:e.jsx(he,{name:"previousStage",checked:q.previousStage,onChange:W}),label:`No - Proceed to previous stage (${(H=l[0])==null?void 0:H.label})`})]})})})]}),e.jsx("div",{children:e.jsx(R,{children:e.jsx(M,{children:e.jsx("div",{children:g!=null&&g.applicationassignment?e.jsx("div",{children:e.jsx("div",{children:g.applicationassignment},"abc123")},"abc123"):null})})})}),e.jsx(R,{children:e.jsx(M,{children:m})}),e.jsx("div",{})]})},ta=()=>{const{id:l}=Se(),m=ke(),[P,b]=y.useState(0),[q,w]=y.useState(!1),[v,j]=y.useState(!1),[d,A]=y.useState(!1),g=s=>{if(s===3){b(6);return}if(s===5){b(2);return}s<0?b(0):s>6?b(6):b(s)},K=()=>g(P-1);y.useEffect(()=>{console.log("its here1"),l?S(l):(re(),Y(),W(),k())},[l]);const Q=s=>e.jsxs("div",{children:[e.jsx("h5",{children:"Application Assignments"}),s.map(a=>e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Assigned Group:"})," ",a.assigned_group]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Remarks:"})," ",a.remarks||"No remarks"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Updated Date/Time:"})," ",new Date(a.created_at).toLocaleString()]})]},a.id))]}),S=s=>{T.get(`/pmc/applicant-detail/${s}/`,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{var u,G;console.log("Data:",a.data);const r={trackingNumber:a.data.tracking_number,firstName:a.data.first_name,lastName:a.data.last_name,applicantDesignation:a.data.applicant_designation,gender:a.data.gender,cnic:a.data.cnic,email:a.data.email,phoneNumber:a.data.mobile_no,id:a.data.id,has_identity_document:a.data.has_identity_document,has_fee_challan:a.data.has_fee_challan,applicationStatus:a.data.application_status,assignedGroup:a.data.assigned_group,applicationassignment:Q(a.data.applicationassignment),applicationdocument:a.data.applicationdocument,field_responses:a.data.field_responses,manual_fields:a.data.manual_fields};if(Z(r),a.data.businessprofile){if(a.data.businessprofile.entity_type==="Company"){const C={applicant:a.data.id,businessName:a.data.businessprofile.business_name,district:a.data.businessprofile.district,tehsil:a.data.businessprofile.tehsil,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};ee(C)}{const C={applicant:a.data.id,name:a.data.businessprofile.name,district:a.data.businessprofile.district_name,tehsil:a.data.businessprofile.tehsil_name,city:a.data.businessprofile.city_town_village,postalAddress:a.data.businessprofile.postal_address,mobileNumber:a.data.businessprofile.mobile_no,id:a.data.businessprofile.id};p(C)}U({businessEntityType:"Individual"})}if($({licenseType:a.data.registration_for}),a.data.producer&&a.data.registration_for==="Producer"){const C={tracking_number:a.data.producer.tracking_number||"",registration_required_for:a.data.producer.registration_required_for||[],registration_required_for_other:a.data.producer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.producer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.producer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.producer.packaging_items||[],number_of_machines:a.data.producer.number_of_machines||"",total_capacity_value:((u=a.data.producer.total_capacity_value)==null?void 0:u.toString())||"",date_of_setting_up:a.data.producer.date_of_setting_up||"",total_waste_generated_value:((G=a.data.producer.total_waste_generated_value)==null?void 0:G.toString())||"",has_waste_storage_capacity:a.data.producer.has_waste_storage_capacity||"",waste_disposal_provision:a.data.producer.waste_disposal_provision||"",applicant:a.data.producer.applicant||""};c(C)}if(a.data.consumer&&a.data.registration_for==="Consumer"){const C={registration_required_for:a.data.consumer.registration_required_for||[],registration_required_for_other:a.data.consumer.registration_required_for_other||[],registration_required_for_other_other_text:a.data.consumer.registration_required_for_other_other_text||"",plain_plastic_Sheets_for_food_wrapping:a.data.consumer.plain_plastic_sheets_for_food_wrapping||[],PackagingItems:a.data.consumer.packaging_items||[],consumption:a.data.consumer.consumption||"",provision_waste_disposal_bins:a.data.consumer.provision_waste_disposal_bins||"No",no_of_waste_disposible_bins:a.data.consumer.no_of_waste_disposable_bins||"",segregated_plastics_handed_over_to_registered_recyclers:a.data.consumer.segregated_plastics_handed_over_to_registered_recyclers||"No",applicant:a.data.consumer.applicant||""};_(C)}if(a.data.recycler&&a.data.registration_for==="Recycler"){const C={selectedCategories:a.data.recycler.selected_categories||[],plastic_waste_acquired_through:a.data.recycler.plastic_waste_acquired_through||[],has_adequate_pollution_control_systems:a.data.recycler.has_adequate_pollution_control_systems||"No",pollution_control_details:a.data.recycler.pollution_control_details||"",applicant:a.data.recycler.applicant||"",registration_required_for_other_other_text:a.data.recycler.registration_required_for_other_other_text||""};i(C)}if(a.data.collector&&a.data.registration_for==="Collector"){const C={registration_required_for:a.data.collector.registration_required_for||[],registration_required_for_other:a.data.collector.registration_required_for_other||[],registration_required_for_other_other_text:a.data.collector.registration_required_for_other_other_text||"",selectedCategoriesCollector:a.data.collector.selected_categories||[],total_capacity_value_collector:a.data.collector.total_capacity_value||"",number_of_vehicles:a.data.collector.number_of_vehicles||"",number_of_persons:a.data.collector.number_of_persons||"",applicant:a.data.collector.applicant||""};H(C)}a.data.application_status==="Fee Challan"&&b(4)}).catch(a=>{console.error("Error:",a)})},J=()=>{w(!1),Te.push(e.jsx(Re,{type:"success",children:"Customer discard!"}),{placement:"top-center"}),m("/concepts/customers/customer-list")},V=()=>{w(!0)},X=()=>{j(!0)},F=()=>{w(!1),j(!1)},I=()=>{j(!1),K()},E=async()=>{if(!t.readOnly){console.log("readOnly",t.readOnly);const s=Object.entries(t.fieldResponses).map(([a,r])=>({field_key:a,response:r.response,comment:r.comment,applicant:t.id}));try{const a=await T.post("/pmc/field-responses/",s,{headers:{"Content-Type":"application/json"}});console.log("Responses submitted:",a.data)}catch(a){console.error("Error submitting responses:",a),m("/error")}}},se=async()=>{const{manualFields:s}=t,a=new FormData;if(a.append("applicant",t.id),a.append("latitude",s.latitude||""),a.append("longitude",s.longitude||""),a.append("list_of_products",s.list_of_products||""),a.append("list_of_by_products",s.list_of_by_products||""),a.append("raw_material_imported",s.raw_material_imported||""),a.append("seller_name_if_raw_material_bought",s.seller_name_if_raw_material_bought||""),a.append("self_import_details",s.self_import_details||""),a.append("raw_material_utilized",s.raw_material_utilized||""),a.append("compliance_thickness_75",s.compliance_thickness_75||""),a.append("valid_consent_permit_building_bylaws",s.valid_consent_permit_building_bylaws||""),a.append("stockist_distributor_list",s.stockist_distributor_list||""),a.append("procurement_per_day",s.procurement_per_day||""),a.append("no_of_workers",s.no_of_workers||""),a.append("labor_dept_registration_status",s.labor_dept_registration_status||""),a.append("occupational_safety_and_health_facilities",s.occupational_safety_and_health_facilities||""),a.append("adverse_environmental_impacts",s.adverse_environmental_impacts||""),s.consent_permit_file){const r=new FormData;r.append("document",s.consent_permit_file),r.append("document_description","Consent Permit"),r.append("applicant",t.id.toString());try{const u=await T.post("/pmc/applicant-documents/",r,{headers:{"Content-Type":"multipart/form-data"}});console.log("Post successful:",u.data)}catch(u){console.error("Error in POST request:",u.response||u.message),m("/error")}}if(s.flow_diagram_file){const r=new FormData;r.append("document",s.flow_diagram_file),r.append("document_description","Flow Diagram"),r.append("applicant",t.id.toString());try{const u=await T.post("/pmc/applicant-documents/",r,{headers:{"Content-Type":"multipart/form-data"}});console.log("Post successful:",u.data)}catch(u){console.error("Error in POST request:",u.response||u.message),m("/error")}}if(s.action_plan_file){const r=new FormData;r.append("document",s.action_plan_file),r.append("document_description","Action Plan"),r.append("applicant",t.id.toString());try{const u=await T.post("/pmc/applicant-documents/",r,{headers:{"Content-Type":"multipart/form-data"}});console.log("Post successful:",u.data)}catch(u){console.error("Error in POST request:",u.response||u.message),m("/error")}}if(s.id)try{const r=await T.patch(`/pmc/manual-fields/${s.id}/`,a,{headers:{"Content-Type":"multipart/form-data"}});alert("Data is saved!"),console.log("PATCH success:",r.data)}catch(r){console.error("Error PATCHing manual fields:",r),m("/error")}else try{const r=await T.post("/pmc/manual-fields/",a,{headers:{"Content-Type":"multipart/form-data"}});console.log("POST success:",r.data),alert("Data is saved!")}catch(r){console.error("Error POSTing manual fields:",r),m("/error")}},ie=async()=>{if(A(!0),t.assignedGroup2!==""&&t.assignedGroup2!==void 0){const s=new FormData;if(s.append("assigned_group",t.assignedGroup2),s.append("id",t.id.toString()),t.id>0)try{const r=await T.patch(`/pmc/applicant-detail/${t.id}/`,s,{headers:{"Content-Type":"multipart/form-data"}});m("/home")}catch(r){console.error("Error in POST request:",r.response||r.message)}const a=new FormData;a.append("applicant",t.id.toString()),a.append("assigned_group",t.assignedGroup2),a.append("remarks",t.remarks),console.log(t.remarks),await T.post("/pmc/application-assignment/",a,{headers:{"Content-Type":"multipart/form-data"}})}E(),se(),A(!1)},{applicantDetail:t,updateApplicantDetail:Z,resetApplicantDetail:re,businessDetail:n,updateBusinessDetail:ee,resetBusinessDetail:Y,businessDetailIndividual:oe,updateBusinessDetailIndividual:p,resetBusinessDetailIndividual:W,businessEntity:ne,updateBusinessEntity:U,resetBusinessEntity:k,resetAll:le,completedSections:de,getValuesFromStateBusinessEntity:ae,getValuesFromLicenseDetail:z,updateLicenseDetail:$,updateLicenseDetailCollector:H,updateLicenseDetailConsumer:_,updateLicenseDetailProducer:c,updateLicenseDetailRecycler:i,resetLicenseDetail:h,resetLicenseDetailProducer:O}=be();ae(),z();const D=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],N=B(t.assignedGroup);console.log("assignedGroup:",t.assignedGroup),console.log("groupList",N);function B(s){console.log(s);const a=D.indexOf(s);return D.slice(Math.max(0,a-1),a+2).map(u=>({value:u,label:u}))}return e.jsxs(e.Fragment,{children:[e.jsx(ze,{groupList:N,children:e.jsx(Be,{children:e.jsxs("div",{className:"flex items-center justify-between px-8",children:[e.jsx("span",{}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"ltr:mr-3 rtl:ml-3",type:"button",customColorClass:()=>"border-error ring-1 ring-error text-error hover:border-error hover:ring-error hover:text-error bg-transparent",icon:e.jsx(Pe,{}),onClick:V,children:"Discard"}),e.jsx(te,{icon:e.jsx(Oe,{}),className:"ltr:mr-3 rtl:ml-3",variant:"solid",type:"button",loading:d,disabled:P===0,onClick:X,children:"Back"}),e.jsx(te,{icon:e.jsx(Me,{}),variant:"solid",type:"button",onClick:ie,loading:d,children:"Save"})]})]})})}),e.jsx(ge,{isOpen:q,type:"danger",title:"Discard changes",onClose:F,onRequestClose:F,onCancel:F,onConfirm:J,children:e.jsx("p",{children:"Are you sure you want discard this?"})}),e.jsx(ge,{isOpen:v,type:"danger",title:"Go Back",onClose:F,onRequestClose:F,onCancel:F,onConfirm:I,children:e.jsx("p",{children:"There are unsaved changes on this step, Are you sure you want to go back step?"})})]})};export{ta as default};
