import{j as e,Z as m,d as b,r,A as w}from"./index-ZKRKcjDq.js";import{M as T,V as _,T as V,O as A,a as j,b as p,S as z,e as R,F as y,c as N}from"./OSM-Bx5l-N5p.js";import{D as I}from"./Divider-BfdvPHfp.js";import{G as B}from"./GeoJSON-BAwyf57_.js";import{M as G}from"./index.esm-CQ44RPeO.js";import{h as O,m as H,n as K,o as $,p as Z}from"./index-BF4KCu_n.js";import"./DefaultPropsProvider-D03C37m8.js";import"./TextField-BEIgdnQo.js";import"./Autocomplete-Dps3z5mo.js";import"./FormControlLabel-BOPUSnAI.js";import"./index-C2g4LWyr.js";const J=({headerText:i=e.jsx(e.Fragment,{}),children:a})=>e.jsxs("div",{className:"banner-container22 grid",children:[e.jsxs("header",{className:"banner-header",children:[e.jsx(b,{to:"/pub",className:"transition-all duration-300 ease-in-out transform hover:scale-105",children:e.jsxs("div",{className:"logo-section",children:[e.jsx("img",{src:"/img/logo/epa_logo-removebg-preview.png",alt:"GOP Logo",className:"header-logo"}),e.jsx("img",{src:"/img/logo/epccd.png",alt:"EPCCD Logo",className:"header-logo"}),e.jsx("img",{src:"/img/logo/gop.png",alt:"GOP Logo",className:"header-logo"}),e.jsx("span",{className:"header-text",children:"PMIS"})]})}),i,e.jsx("nav",{className:"banner-nav",children:e.jsx(b,{to:"/sign-in",className:"nav-link transition-all duration-300 ease-in-out transform hover:scale-105",style:{paddingLeft:300},children:"Login"})})]}),m.Children.map(a,c=>m.isValidElement(c)?m.cloneElement(c):c),e.jsx(I,{textAlign:"left"}),e.jsx("footer",{className:"footer-container",children:e.jsxs("span",{className:"footer-text",children:["Copyright © ",new Date().getFullYear()," ",e.jsx("span",{className:"font-semibold",children:"PMIS"})," All rights reserved.",e.jsx("br",{}),"Plastic Management Cell, Strategic Planning & Implementation Unit, Environmental Protection Agency, and Environment Protection & Climate Change Department, Government of the Punjab."]})})]}),U=()=>{const i=r.useRef(null),[a,c]=r.useState(null),[n,C]=r.useState(null),[W,v]=r.useState(null),[d,S]=r.useState([]),[l,u]=r.useState(null),[D,g]=r.useState(!1),[x,L]=r.useState([]),[P,k]=r.useState(!0);r.useEffect(()=>{const t=new T({target:i.current,layers:[new V({source:new A})],view:new _({zoom:7,center:[8127130,3658593]})}),s=new j({source:new p}),o=new j({source:new p});return t.addLayer(s),t.addLayer(o),C(s),v(o),c(t),()=>t.setTarget(null)},[]),r.useEffect(()=>{if(!n||!a)return;(async()=>{g(!0);try{const s=await w.get("/pmc/idm_districts-club-counts/");L(s.data.features);const o=new p({features:new B().readFeatures(s.data,{featureProjection:"EPSG:3857"})});n.setSource(o),a.getView().fit(o.getExtent(),{padding:[50,50,50,50],duration:500})}catch(s){console.error("Error fetching districts:",s)}finally{g(!1)}})()},[n,a]),r.useEffect(()=>{n&&n.setStyle(t=>{const s=t.get("id")===l;if(t.get("club_count")!==0)return new z({stroke:new N({color:s?"red":"blue",width:s?3:2}),fill:new y({color:s?"rgba(255,0,0,0.1)":"rgba(0,0,255,0.1)"}),text:new R({text:`${t.get("name")} (${t.get("club_count")})`,font:"bold 10px sans-serif",fill:new y({color:"#000"}),stroke:new N({color:"#fff",width:3}),overflow:!0})})})},[n,l]),r.useEffect(()=>{(async()=>{const s=await w.get("/pmc/idm_clubs_geojson_all/");S(s.data.features)})()},[]),r.useEffect(()=>{if(!a||!n)return;const t=s=>{const o=a.getFeaturesAtPixel(s.pixel);if(o.length>0){const h=o[0].get("id");l===h?(u(null),a.getView().setCenter([8127130,3658593])):u(h)}else u(null),a.getView().setCenter([8127130,3658593])};return a.on("click",t),()=>a.un("click",t)},[a,n,l]);const E=r.useMemo(()=>l?d.filter(t=>t.properties.district_id===l):d,[l,d]),M=r.useMemo(()=>[{accessorKey:"properties.district",header:"District",size:150},{accessorKey:"properties.name",header:"School Name",size:225},{accessorKey:"properties.address",header:"Address",size:225},{accessorKey:"properties.head_name",header:"Head Name",size:200}],[]),F=r.useMemo(()=>{const t=[...x].sort((s,o)=>o.properties.club_count-s.properties.club_count).slice(0,4);return[{properties:{name:"Total Clubs",club_count:d.length,id:null}},...t]},[x,d]),f=[{bgColor:"bg-gray-500",icon:e.jsx(O,{className:"text-white text-3xl"})},{bgColor:"bg-orange-500",icon:e.jsx(H,{className:"text-white text-3xl"})},{bgColor:"bg-blue-500",icon:e.jsx(K,{className:"text-white text-3xl"})},{bgColor:"bg-yellow-500",icon:e.jsx($,{className:"text-white text-3xl"})},{bgColor:"bg-green-500",icon:e.jsx(Z,{className:"text-white text-3xl"})}];return e.jsxs("div",{className:"flex flex-col p-4 gap-4",children:[P&&e.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded relative",children:[e.jsx("p",{className:"font-medium",children:"To access Head Contact Number and Club Notification, please sign in with an authenticated account."}),e.jsx("button",{className:"absolute top-2 right-2 text-yellow-700 hover:text-yellow-900",onClick:()=>k(!1),children:"×"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4",children:F.map((t,s)=>e.jsx("div",{className:`shadow-md rounded p-6 w-full cursor-pointer transition 
                ${l===null||l===t.properties.id?"opacity-100":"opacity-50"}
                ${f[s].bgColor}
                `,onClick:()=>u(t.properties.id),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[f[s].icon,e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.properties.name}),e.jsx("p",{className:"text-2xl font-bold text-white",children:t.properties.club_count})]})},s))}),e.jsxs("div",{className:"flex flex-row p-4 gap-4",children:[e.jsxs("div",{className:"relative w-1/2",children:[D&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 z-10",children:e.jsx("div",{className:"animate-spin h-10 w-10 border-4 border-blue-500 border-t-transparent rounded-full"})}),e.jsx("div",{ref:i,style:{height:"850px"}})]}),e.jsx("div",{style:{flex:1},children:e.jsx(G,{columns:M,data:E,initialState:{pagination:{pageSize:15}},enableZebraStripes:!0,enableColumnResizing:!0,muiTableBodyRowProps:({row:t})=>({onClick:()=>handleRowClick(t),style:{cursor:"pointer"},sx:{"&:nth-of-type(even)":{backgroundColor:"#f9f9f9"},"&:hover":{backgroundColor:"#e0f7fa"}}}),muiTableProps:{sx:{border:"1px solid #ddd"}},muiTableHeadCellProps:{sx:{backgroundColor:"#f5f5f5",fontWeight:"bold",borderBottom:"2px solid #ccc",textAlign:"center"}},muiTableBodyCellProps:{sx:{borderRight:"1px solid #ddd",padding:"10px"}}})})]})]})},ie=()=>{const i=e.jsxs("h6",{className:"header-text",children:[e.jsx("span",{className:"font-bold",children:"Management Information System"}),e.jsx("span",{className:"text-sm ml-2",children:"Educational Environmental Club Directory"})]});return e.jsx(J,{headerText:i,children:e.jsx(U,{})})};export{ie as default};
