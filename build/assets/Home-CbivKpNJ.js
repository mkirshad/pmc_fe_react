import{r as l,W as _,j as i,A as D}from"./index-DR9ZUpVB.js";import{M as v}from"./index.esm-njXsPTey.js";import"./TextField-BKM20GYp.js";import"./DefaultPropsProvider-CAgRmbKs.js";import"./FormControlLabel-DCb-qpT5.js";import"./Autocomplete-DDkGW2iM.js";import"./Divider-CXbwgkE4.js";import"./index-NfHDDStc.js";const I=(g,d="",a={},c=[])=>{for(const[m,n]of Object.entries(g||{})){const S=d?`${d}.${m}`:m;c.some(f=>S.startsWith(f))||n&&typeof n=="object"&&!Array.isArray(n)||(a[S]=n??"N/A")}return a},M=g=>g.map(d=>{const a=I(d);return Object.keys(a).forEach(c=>{(a[c]===void 0||a[c]===null)&&(a[c]="N/A")}),a}),U=()=>{const[g,d]=l.useState([]),[a,c]=l.useState([]),[m,n]=l.useState([]),[S,f]=l.useState(0),[h,L]=l.useState(null),[O,A]=l.useState({});console.log(h);const j=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],b={APPLICANT:"Applicant",LSO:"LSO",LSM:"LSM",DO:"DO",LSM2:"LSM",TL:"TL",DEO:"DEO","Download License":"Download License"},R=(e,p,s)=>{const C=["first_name","last_name","cnic","mobile_no","application_status","tracking_number","assigned_group","registration_for"],u=M(e),w=u[0],o=[...Object.keys(w).filter(t=>C.includes(t)).map(t=>({accessorKey:t,header:t.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()),size:200,Cell:({cell:r,row:T})=>i.jsx("span",{style:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>{const x=T.original.id;console.log(`Clicked ${t}:`,r.getValue()),console.log(`Navigating with ID: ${x}`),window.location.href=p?`/spuid-review/${x}?group=${s}`:`/spuid-signup/${x}`},children:r.getValue()||"-"})}))];return{flattenedData:u,columns:o}},y=_();return l.useEffect(()=>{(async()=>{try{const s=await D.get("/pmc/ping/",{headers:{"Content-Type":"application/json"}})}catch{y("/error")}try{let s=[];try{s=(await D.get("/pmc/user-groups/",{headers:{"Content-Type":"application/json"}})).data||[],n(s.map(t=>t.name))}catch(o){console.error("Error fetching user groups:",o),n([])}console.log("groupsResponse",s);const u=(await D.get("/pmc/applicant-detail/",{headers:{"Content-Type":"multipart/form-data"}})).data;if(Array.isArray(u)&&u.length>0){const o=R(u,s.length>0,s.map(r=>r.name)[0]);d(o.flattenedData),c(o.columns),console.log("Flattened Data:",o.flattenedData);const t=o.flattenedData[o.flattenedData.length-1];if(console.log("Last Row:",t),t&&t.id){L(t.id),console.log("Last Row ID:",t.id);const r=j.indexOf(t.assigned_group);r!==-1&&f(r)}}const w=await D.get("/pmc/fetch-statistics-view-groups/",{headers:{"Content-Type":"multipart/form-data"}});A(w.data)}catch(s){console.error("Error fetching data:",s)}})(),L(25);const p=j.indexOf("LSO");p!==-1&&f(p)},[]),console.log("selectedRowId:",h),console.log(h),i.jsxs("div",{children:[i.jsx("div",{className:"tiles-container",children:Object.entries(O).map(([e,p])=>i.jsxs("div",{className:"tile",children:[i.jsx("h3",{children:b[e]||e})," ",i.jsx("p",{children:p})]},e))}),i.jsx("div",{className:"mb-4",children:i.jsxs("h3",{children:[m.filter(e=>e!=="Download License"&&e!=="Applicant"&&e!=="LSM2").join(" - ")," Dashboard"]})}),i.jsx(v,{columns:[...a],data:g.map(e=>({...e,assigned_group_title:b[e.assigned_group]||e.assigned_group})),getRowId:e=>e.id,initialState:{showColumnFilters:!1},defaultColumn:{maxSize:420,minSize:1,size:100},enableColumnResizing:!0,columnResizeMode:"onChange",enableTopToolbar:!1,enablePagination:!1},h)]})};export{U as default};
