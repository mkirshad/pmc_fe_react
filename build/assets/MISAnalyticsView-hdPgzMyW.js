import{r as l,V as K,j as e,d as w,A as V}from"./index-BsYDAXCC.js";import{_ as T}from"./KPIDashboard-Cut_VuX1.js";import{M as R}from"./index.esm-O3pBcoHS.js";import{b as U,c as O,d as B,e as G,f as z}from"./index-aLQRHTX_.js";import{m as Y}from"./proxy-BxEzEj2u.js";import{D as q}from"./Divider-DN0QPZAZ.js";import"./index-CnKXuH36.js";import"./TextField-BV38zarO.js";import"./FormControlLabel-CavGxzr0.js";import"./Autocomplete-CDdIRmOW.js";const H=({loginUrl:b="/sign-in"})=>{const[m,p]=l.useState([]),[h,c]=l.useState([]),[o,D]=l.useState(null),[j,A]=l.useState(""),[P,k]=l.useState(""),S=K();l.useEffect(()=>{(async()=>{var a,i;try{const r=await V.get("/pmc/mis-applicant-statistics/",{headers:{"Content-Type":"multipart/form-data"}});console.log(r.data);const{district_data:n,registration_statistics:v,grid_data:_}=r.data;if(!n||!Array.isArray(n))throw new Error("Invalid district_data format");if(!v||!Array.isArray(v))throw new Error("Invalid registration_statistics format");if(!_||!Array.isArray(_))throw new Error("Invalid grid_data format");const F={Total:e.jsx(U,{className:"text-white text-3xl"}),Producer:e.jsx(O,{className:"text-white text-3xl"}),Consumer:e.jsx(B,{className:"text-white text-3xl"}),Recycler:e.jsx(G,{className:"text-white text-3xl"}),Collector:e.jsx(z,{className:"text-white text-3xl"})},M={Producer:"bg-orange-500",Consumer:"bg-blue-500",Recycler:"bg-green-500",Collector:"bg-yellow-500"},$=r.data.registration_statistics.map(s=>({title:s.registration_for,data:[{value:s.Applications,label:"Applications",title:"Applications"},{value:s.DO,label:"DO",title:"District Officer (Environment)/Assistant/Deputy Director/District In-Charge"},{value:s.PMC,label:"PMC",title:"Plastic Management Cell"},{value:s.APPLICANT,label:"Applicant",title:"Applicant"},{value:s.Licenses,label:"Licenses",title:"Licenses"}],color:M[s.registration_for]||"bg-gray-500",icon:F[s.registration_for]||null})),x=Array.from(new Set(n.map(s=>{var d;return((d=s.businessprofile__district__district_name)==null?void 0:d.trim())||"Unknown"}).filter(s=>s!=="Unknown"))),y=Array.from(new Set(n.map(s=>s.registration_for||"Unknown").filter(s=>s!=="Unknown"))).map(s=>{const d=x.map(f=>{const u=r.data.district_data.find(g=>g.registration_for===s&&g.businessprofile__district__district_name===f);return u?u.count:0});return{name:s,data:d}});D({series:y,options:{chart:{type:"bar",height:550,stacked:!0,events:{dataPointSelection:(s,d,f)=>{const{seriesIndex:u,dataPointIndex:g}=f,N=y[u].name,C=x[g];E(N,C),console.log(`Series: ${N}, Category: ${C}`)}}},title:{text:"Applications by Category and District"},xaxis:{categories:x},legend:{position:"right"},plotOptions:{bar:{horizontal:!1,borderRadius:5}},colors:["#F97316","#3B82F6","#22C55E","#EAB308"]}}),p($),c(r.data.grid_data)}catch(r){const n={status:(a=r.response)==null?void 0:a.status,data:(i=r.response)==null?void 0:i.data,message:r.message};S("/error",{state:{error:n}})}})()},[]);const I=[{accessorKey:"tracking_number",header:"Tracking Number",size:150,Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}},{accessorKey:"first_name",header:"First Name",Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}},{accessorKey:"last_name",header:"Last Name",Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}},{accessorKey:"cnic",header:"CNIC",Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}},{accessorKey:"mobile_no",header:"Mobile No",Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}},{accessorKey:"application_status",header:"Status",Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}},{accessorKey:"assigned_group",header:"Assigned Group",Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}},{accessorKey:"registration_for",header:"Category",Cell:({cell:t,row:a})=>{const r=`/spuid-review/${a.original.id}`;return e.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:t.getValue()||"-"})}}];function E(t,a){A(a),k(t),console.log("District calculated: ",a),console.log("seriesName calculated: ",t)}const L={hidden:{opacity:0},visible:{opacity:1,transition:{duration:1}}};return console.log("chartData",o),e.jsxs(Y.div,{className:"banner-container2",variants:L,initial:"hidden",animate:"visible",children:[e.jsxs("header",{className:"banner-header",children:[e.jsx(w,{to:"/pub",className:"transition-all duration-300 ease-in-out transform hover:scale-105",children:e.jsxs("div",{className:"logo-section",children:[e.jsx("img",{src:"/img/logo/epa_logo-removebg-preview.png",alt:"GOP Logo",className:"header-logo"}),e.jsx("img",{src:"/img/logo/epccd.png",alt:"EPCCD Logo",className:"header-logo"}),e.jsx("img",{src:"/img/logo/gop.png",alt:"GOP Logo",className:"header-logo"}),e.jsx("span",{className:"header-text",children:"PLMIS"})]})}),e.jsx("nav",{className:"banner-nav",children:e.jsx(w,{to:"/sign-in",className:"nav-link transition-all duration-300 ease-in-out transform hover:scale-105",children:"Staff Login"})})]}),e.jsxs("div",{className:"dashboard-container flex flex-col flex-auto",children:[e.jsx("header",{className:"dashboard-header",children:e.jsx("h1",{children:"Admin - Data Analytics"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:m.map((t,a)=>e.jsx(J,{title:t.title,data:t.data,color:t.color,icon:t.icon},a))}),e.jsx("div",{id:"chart",className:"mt-5",children:o&&o.series&&o.options&&e.jsx(T,{options:o.options,series:o.series,type:"bar",height:350})}),j!==""&&e.jsx("div",{className:"mt-2",children:e.jsx(R,{columns:I,data:h.filter(t=>t.businessprofile__district__district_name===j&&t.registration_for===P),initialState:{},enableColumnResizing:!0})})]}),e.jsx("div",{className:"mb-0",children:e.jsx(q,{textAlign:"left"})}),e.jsx("footer",{className:"footer-container ",children:e.jsxs("span",{className:"footer-text",children:["Copyright Â© ",new Date().getFullYear()," ",e.jsx("span",{className:"font-semibold",children:"PLMIS"})," All rights reserved. ",e.jsx("br",{}),"Plastic Management Cell, Strategic Planning & Implementation Unit, Environmental Protection Agency, and Environment Protection & Climate Change Department, Government of the Punjab."]})})]})},ne=()=>e.jsx(H,{}),J=({title:b,data:m,color:p,icon:h})=>e.jsxs("div",{className:`shadow-md rounded p-6 w-full ${p}`,children:[e.jsxs("div",{className:"flex items-center mb-4",children:[h,e.jsx("h2",{className:"text-2xl font-bold text-white ml-2",children:b})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:m.map((c,o)=>e.jsxs("div",{className:"text-center",title:c.title,children:[" ",e.jsx("p",{className:"text-3xl font-bold text-white",children:c.value}),e.jsx("p",{className:"text-sm text-white",children:c.label})]},o))})]});export{H as KPIDashboardBase,ne as default};
