import{W as k,l as c,r as v,j as s,A as d}from"./index-oDwQGYEA.js";import{S as w,B as p,M as R,E as m}from"./index.esm-C6T0MJvz.js";import{u as _}from"./useInspectionStore-CxpNYduB.js";import{F as u}from"./FileDownload-Brut9iRO.js";import{I as x}from"./Autocomplete-Dg-hWFz0.js";import"./TextField-r5TNIsmD.js";import"./DefaultPropsProvider-CGomaEqC.js";import"./emotion-element-f0de968e.browser.esm-DX8E_o2N.js";import"./setPrototypeOf-C3V6guyq.js";import"./assertThisInitialized-Cle6jci9.js";import"./Modal-CFzYjZPq.js";import"./Box-CNakWzJu.js";import"./FormControlLabel-BQoHBKRj.js";import"./Divider-B6CetmYu.js";import"./index-CFuoc-5k.js";const a=i=>i?Array.isArray(i)?i.join(", "):typeof i=="object"?JSON.stringify(i,null,2):i:"N/A",J=()=>{const i=k(),{reports:h,fetchReports:b,loading:f,syncReports:y}=_();c(e=>e.user.district_id);const l=c(e=>e.user.district_name)||"";v.useEffect(()=>{y().then(()=>b())},[]);const g=[{accessorKey:"id",header:"ID",size:50,Cell:({row:e})=>s.jsx("span",{onClick:()=>t(e.original),className:"text-blue-500 underline cursor-pointer",children:e.original.id})},{accessorKey:"business_name",header:"Business Name",size:200,Cell:({row:e})=>s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{onClick:()=>t(e.original),className:"text-blue-500 underline cursor-pointer mr-2",children:e.original.business_name}),s.jsx(x,{size:"small",onClick:()=>t(e.original),children:s.jsx(m,{fontSize:"small"})})]})},{accessorKey:"inspection_date",header:"Inspection Date",size:200,Cell:({row:e})=>s.jsx("span",{onClick:()=>t(e.original),className:"text-blue-500 underline cursor-pointer",children:e.original.inspection_date})},{accessorKey:"business_type",header:"Business Type",size:150,Cell:({row:e})=>s.jsx("span",{onClick:()=>t(e.original),className:"text-blue-500 underline cursor-pointer",children:e.original.business_type})},{accessorKey:"license_number",header:"License Number",size:150,Cell:({row:e})=>s.jsx("span",{onClick:()=>t(e.original),className:"text-blue-500 underline cursor-pointer",children:e.original.license_number})},{accessorKey:"violation_found",header:"Violation Found",size:80,Cell:({cell:e})=>s.jsx("pre",{children:a(e.getValue())})},{accessorKey:"violation_type",header:"Violation Type",size:400,Cell:({cell:e})=>s.jsx("pre",{children:a(e.getValue())})},{accessorKey:"action_taken",header:"Action Taken",size:400,Cell:({cell:e})=>s.jsx("pre",{children:a(e.getValue())})},{accessorKey:"total_confiscation",header:"Total Confiscation (KG)",size:200},{accessorKey:"district",header:"District",size:150},{accessorKey:"created_at",header:"Created At",size:200},{accessorKey:"edit",header:"Actions",size:100,Cell:({row:e})=>s.jsx(x,{onClick:()=>t(e.original),children:s.jsx(m,{})})}],C=async()=>{try{const e=await d.get("/pmc/inspection-report/export-all-inspections-excel/",{responseType:"blob"}),n=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download="district_summary.xlsx",document.body.appendChild(o),o.click(),o.remove(),window.URL.revokeObjectURL(r)}catch(e){console.error("Failed to download Excel file:",e)}},j=async()=>{try{const e=await d.get("/pmc/inspection-report/export-all-inspections-pdf/",{responseType:"blob"}),n=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download="district_summary.pdf",document.body.appendChild(o),o.click(),o.remove(),window.URL.revokeObjectURL(r)}catch(e){console.error("Failed to download Excel file:",e)}},t=e=>{i(`/auth/EPAOperations/ReportViolation?id=${e.id}`)};return s.jsxs("div",{children:[s.jsxs("h2",{className:"text-lg font-bold mb-4",children:["Inspection Reports ",l!==""?" - ":""," ",l]}),f?s.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-50",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-blue-400 border-t-transparent border-solid rounded-full animate-spin"}),s.jsx("p",{className:"mt-4 text-lg font-medium text-gray-600",children:"Loading data, please wait..."})]}):s.jsxs("div",{children:[s.jsxs(w,{direction:"row",spacing:2,className:"mb-4",children:[s.jsx(p,{variant:"contained",color:"success",startIcon:s.jsx(u,{}),onClick:C,children:"Export to Excel"}),s.jsx(p,{variant:"contained",color:"success",startIcon:s.jsx(u,{}),onClick:j,children:"Export to PDF"})]}),s.jsx(R,{columns:g,data:h,enableColumnResizing:!0,enablePagination:!0,initialState:{showColumnFilters:!1},muiTableHeadCellProps:{sx:{backgroundColor:"#f5f5f5",fontWeight:"bold",borderBottom:"2px solid #ccc",textAlign:"center"}},muiTableBodyCellProps:{sx:{borderRight:"1px solid #ddd",padding:"10px"}},muiTableBodyRowProps:{sx:{"&:nth-of-type(even)":{backgroundColor:"#f9f9f9"},"&:hover":{backgroundColor:"#e0f7fa"}}},enableZebraStripes:!0})]})]})};export{J as default};
