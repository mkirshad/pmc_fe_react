import{r as l,j as c,A as w}from"./index-CNJck4wd.js";import{M as b}from"./index.esm-Ca0bjXHG.js";import"./TextField-emsHFidh.js";import"./FormControlLabel-CML7w9fc.js";import"./Autocomplete-D-ec-gwf.js";import"./index-DHAG-gX9.js";const y=(p,d="",s={},n=[])=>{for(const[g,a]of Object.entries(p||{})){const f=d?`${d}.${g}`:g;n.some(h=>f.startsWith(h))||a&&typeof a=="object"&&!Array.isArray(a)||(s[f]=a??"N/A")}return s},T=p=>p.map(d=>{const s=y(d);return Object.keys(s).forEach(n=>{(s[n]===void 0||s[n]===null)&&(s[n]="N/A")}),s}),$=()=>{const[p,d]=l.useState([]),[s,n]=l.useState([]),[g,a]=l.useState([]),[f,h]=l.useState(0),[m,C]=l.useState(null),[j,O]=l.useState({});console.log(m);const A=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],L={APPLICANT:"Applicant",LSO:"LSO",LSM:"LSM",DO:"DO",LSM2:"LSM",TL:"TL",DEO:"DEO","Download License":"Download License"},R=(t,o)=>{const x=["first_name","last_name","cnic","mobile_no","application_status","tracking_number","assigned_group","registration_for"],u=T(t),D=u[0],i=[...Object.keys(D).filter(e=>x.includes(e)).map(e=>({accessorKey:e,header:e.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase()),size:200,Cell:({cell:r,row:_})=>c.jsx("span",{style:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>{const S=_.original.id;console.log(`Clicked ${e}:`,r.getValue()),console.log(`Navigating with ID: ${S}`),window.location.href=o?`/spuid-review/${S}`:`/spuid-signup/${S}`},children:r.getValue()||"-"})}))];return{flattenedData:u,columns:i}};return l.useEffect(()=>{(async()=>{try{const o=await w.get("/pmc/user-groups/",{headers:{"Content-Type":"multipart/form-data"}});a(o.data);const u=(await w.get("/pmc/applicant-detail/",{headers:{"Content-Type":"multipart/form-data"}})).data;if(Array.isArray(u)&&u.length>0){const i=R(u,o.data.length>0);d(i.flattenedData),n(i.columns),console.log("Flattened Data:",i.flattenedData);const e=i.flattenedData[i.flattenedData.length-1];if(console.log("Last Row:",e),e&&e.id){C(e.id),console.log("Last Row ID:",e.id);const r=A.indexOf(e.assigned_group);r!==-1&&h(r)}}const D=await w.get("/pmc/fetch-statistics-view-groups/",{headers:{"Content-Type":"multipart/form-data"}});O(D.data)}catch(o){console.error("Error fetching data:",o)}})()},[]),console.log("selectedRowId:",m),console.log(m),c.jsxs("div",{children:[c.jsx("div",{className:"tiles-container",children:Object.entries(j).map(([t,o])=>c.jsxs("div",{className:"tile",children:[c.jsx("h3",{children:L[t]||t})," ",c.jsx("p",{children:o})]},t))}),c.jsx(b,{columns:[...s],data:p.map(t=>({...t,assigned_group_title:L[t.assigned_group]||t.assigned_group})),getRowId:t=>t.id,initialState:{showColumnFilters:!1},defaultColumn:{maxSize:420,minSize:1,size:100},enableColumnResizing:!0,columnResizeMode:"onChange"},m)]})};export{$ as default};
