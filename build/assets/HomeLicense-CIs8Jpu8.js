import{r as i,U as w,j as u,A as _}from"./index-4RLLXVPi.js";import{M as A}from"./index.esm-Cjidw_FN.js";import"./TextField-CplAdzQS.js";import"./DefaultPropsProvider-DBrdpgGe.js";import"./FormControlLabel-0kfgVLKv.js";import"./Autocomplete-C-KpBT6P.js";import"./Divider-CM2zM9r0.js";import"./index-BxCdGLaZ.js";const O=a=>a,j=a=>a.map(p=>{const r=O(p);return Object.keys(r).forEach(c=>{(r[c]===void 0||r[c]===null)&&(r[c]="N/A")}),r}),U=()=>{const[a,p]=i.useState([]),[r,c]=i.useState([]),[S,z]=i.useState([]),[L,g]=i.useState(0),[b,x]=i.useState(null),y=["APPLICANT","LSO","LSM","DO","LSM2","TL","DEO","Download License"],C=(n,o,e)=>{const d=["id","license_number","date_of_issue","license_for","license_duration","owner_name","business_name","district_name","tehsil_name","city_name","address","types_of_plastics","particulars","fee_amount","is_active"],s=j(n),t=s[0];console.log(n);const l=[...Object.keys(t).filter(m=>d.includes(m)).map(m=>({accessorKey:m,header:m.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase()),Cell:({cell:f,row:h})=>u.jsx("span",{style:{cursor:"pointer",color:"blue",textDecoration:"underline"},onClick:()=>{const K=h.original.license_number,T=h.original.date_of_issue;window.location.href=`/generate-license-pdf?license_number=${K}&date_of_issue=${T}`},children:f.getValue()||"-"})}))];return{flattenedData:s,columns:l}},D=w();return i.useEffect(()=>{(async()=>{try{const e=await _.get("/pmc/ping/",{headers:{"Content-Type":"application/json"}})}catch{D("/error")}try{let e=[];try{e=(await _.get("/pmc/user-groups/",{headers:{"Content-Type":"application/json"}})).data||[],z(e.map(l=>l.name))}catch(t){console.error("Error fetching user groups:",t),z([])}console.log("groupsResponse",e);const s=(await _.get("/pmc/license-by-user/",{headers:{"Content-Type":"multipart/form-data"}})).data;if(console.log(s),Array.isArray(s)&&s.length>0){const t=C(s,e.length>0,e.map(l=>l.name)[0]);p(t.flattenedData),c(t.columns)}}catch(e){console.error("Error fetching data:",e)}})(),x(25);const o=y.indexOf("LSO");o!==-1&&g(o)},[]),console.log("flattenedData",a),u.jsx("div",{children:u.jsx(A,{columns:[{accessorKey:"license_number",header:"License Number",minSize:50,maxSize:500,size:150,Cell:({row:n})=>{const o=n.original.license_number,e=n.original.date_of_issue,d=`/api/pmc/license-pdf?license_number=${o}&date_of_issue=${e}`;return u.jsx("a",{style:{cursor:"pointer",color:"blue",textDecoration:"underline"},href:d,target:"_blank",rel:"noopener noreferrer",children:o})}},{accessorKey:"date_of_issue",header:"Date Of Issue",minSize:50,maxSize:500,size:150},{accessorKey:"license_for",header:"License For",minSize:50,maxSize:500,size:150},{accessorKey:"license_duration",header:"License Duration",minSize:50,maxSize:500,size:150},{accessorKey:"owner_name",header:"Owner Name",minSize:50,maxSize:500,size:200},{accessorKey:"business_name",header:"Business Name",minSize:50,maxSize:500,size:150},{accessorKey:"district_name",header:"District Name",minSize:50,maxSize:500,size:150},{accessorKey:"tehsil_name",header:"Tehsil Name",minSize:50,maxSize:500,size:150},{accessorKey:"city_name",header:"City Name",minSize:50,maxSize:500,size:150},{accessorKey:"address",header:"Address",minSize:50,maxSize:500,size:150},{accessorKey:"types_of_plastics",header:"Types Of Plastics",minSize:100,maxSize:500,size:500},{accessorKey:"particulars",header:"Particulars",minSize:100,maxSize:100,size:150},{accessorKey:"fee_amount",header:"Fee Amount",minSize:50,maxSize:500,size:150},{accessorKey:"is_active",header:"Is Active",minSize:50,maxSize:500,size:150}],data:a,enableColumnFilters:!0,enableSorting:!0,enableStickyHeader:!0,muiTableProps:{sx:{border:"1px solid #ddd"}},muiTableHeadCellProps:{sx:{backgroundColor:"#f5f5f5",fontWeight:"bold",borderBottom:"2px solid #ccc",textAlign:"center"}},muiTableBodyCellProps:{sx:{borderRight:"1px solid #ddd",padding:"10px"}},muiTableBodyRowProps:{sx:{"&:nth-of-type(even)":{backgroundColor:"#f9f9f9"},"&:hover":{backgroundColor:"#e0f7fa"}}},enableZebraStripes:!0,enableColumnResizing:!0,enableTopToolbar:S.length>0,enablePagination:!0},b)})};export{U as default};
